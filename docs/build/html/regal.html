
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Einleitung &#8212; to.science  documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Preface" href="api.html" />
    <link rel="prev" title="Welcome to to.science’s documentation!" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <p>Über dieses Dokument</p>
<p>Dieses Dokument kommt zusammen mit einem
<a class="reference external" href="https://github.com/hbz/to.science/tree/master/vagrant/ubuntu-14.04">Vagrantfile</a>
und beschreibt eine beispielhafte Installation von Regal. Unter
<a class="reference external" href="#_vagrant">Vagrant</a> findet sich eine Anleitung zur Installation in
einer Virtualbox.</p>
<p>Eine Kurzaufstellung der wichtigsten API-Calls findet sich unter
<a class="reference external" href="./api.html">Regal-Api</a></p>
<p>Dieses Dokument ist im Format asciidoc geschrieben und kann mit dem
Werkzeug asciidoctor in HTML übersetzt werden. Mehr dazu im Abschnitt
<a class="reference external" href="#_dokumentation">Dokumentation</a></p>
<div class="section" id="einleitung">
<h1>Einleitung<a class="headerlink" href="#einleitung" title="Permalink to this headline">¶</a></h1>
<p>to.science (ehemals “Regal”) ist eine Content Repository zur Verwaltung
und Veröffentlichung elektronischer Publikationen. Es wird seit 2013 am
<a class="reference external" href="https://hbz-nrw.de">Hochschulbibliothekszentrum NRW (hbz)</a>
entwickelt.</p>
<p>to.science basiert auf den folgenden Kerntechnologien:</p>
<ul class="simple">
<li><p>Fedora Commons 3</p></li>
<li><p>Elasticsearch 1.1</p></li>
<li><p>Drupal 7</p></li>
<li><p>Playframework 2.4</p></li>
<li><p>MySQL 5</p></li>
<li><p>Java 8</p></li>
<li><p>PHP 5</p></li>
</ul>
<p>Für die Webarchivierung kommen außerdem Openwayback, Heritrix und WPull
zum Einsatz.</p>
<ul class="simple">
<li><p>openwayback hbz-2.3.2</p></li>
<li><p>pywb</p></li>
<li><p>heritrix 3.2.0</p></li>
<li><p>wpull</p></li>
</ul>
<p>Regal ist ein mehrkomponentiges System. Einzelne Komponenten sind als
Webservices realisiert und kommunizieren über HTTP-APIs miteinander.
Derzeit sind folgende Komponenten im Einsatz</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/hbz/to.science.api">to.science.api</a></p></li>
<li><p><a class="reference external" href="https://github.com/hbz/to.science.labels">to.science.labels</a></p></li>
<li><p><a class="reference external" href="https://github.com/hbz/to.science.forms">to.science.forms</a></p></li>
<li><p><a class="reference external" href="https://github.com/hbz/skos-lookup">skos-lookup</a></p></li>
<li><p><a class="reference external" href="https://github.com/hbz/thumby">thumby</a></p></li>
<li><p><a class="reference external" href="https://github.com/hbz/DeepZoomService">deepzoomer</a></p></li>
<li><p><a class="reference external" href="https://github.com/hbz/to.science.drupal">to.science.drupal</a></p></li>
</ul>
<p>Drupal Themes</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/edoweb/zbmed-drupal-theme">zbmed-drupal-theme</a></p></li>
<li><p><a class="reference external" href="https://github.com/edoweb/edoweb-drupal-theme">edoweb-drupal-theme</a></p></li>
</ul>
<p>Über die Systemschnittstellen können eine ganze Reihe von Drittsystemen
angesprochen werden. Die folgende Abbildung verschafft einen groben
Überblick über eine typische Regal-Installation und die angebundenen
Drittsysteme.</p>
</div>
<div class="section" id="konzepte">
<h1>Konzepte<a class="headerlink" href="#konzepte" title="Permalink to this headline">¶</a></h1>
<div class="section" id="objektmodell">
<h2>Objektmodell<a class="headerlink" href="#objektmodell" title="Permalink to this headline">¶</a></h2>
<p>Regal realisiert ein einheitliches Objektmodell in dem sich eine
Vielzahl von Publikationstypen speichern lassen. Die Speicherschicht
wird über <a class="reference external" href="#_fedora_commons_3">Fedora Commons 3</a> realisiert.</p>
<p>Eine einzelne Publikation besteht i.d.R. aus mehreren <a class="reference external" href="#_fedora_commons_3">Fedora Commons
3</a>-Objekten, die in einer hierarchischen
Beziehung zueinander stehen.</p>
<table class="docutils align-default" id="id14">
<caption><span class="caption-text">Fedora Object</span><a class="headerlink" href="#id14" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Datenstrom</p></th>
<th class="head"><p>Pflicht</p></th>
<th class="head"><p>Beschreibung</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>DC</p></td>
<td><p>Ja</p></td>
<td><p>Von Fedora
vorgeschrieben. Wird
für die fedorainterne
Suche verwendet</p></td>
</tr>
<tr class="row-odd"><td><p>RELS-EXT</p></td>
<td><p>Ja</p></td>
<td><p>Von Fedora
vorgeschrieben. Wird
für viele Sachen
verwendet - (1)
Hierarchien - (2)
Steuerung der
Sichtbarkeiten - (2)
OAI-Providing</p></td>
</tr>
<tr class="row-even"><td><p>data</p></td>
<td><p>Nein</p></td>
<td><p>Die eigentlichen
Daten der
Publikation. Oft ein
PDF.</p></td>
</tr>
<tr class="row-odd"><td><p>metadata oder
metadata2</p></td>
<td><p>Nein</p></td>
<td><p>Bibliografische
Metadaten. Metadata2
wurde mit dem Umstieg
auf die Lobid-API v2
eingeführt.</p></td>
</tr>
<tr class="row-even"><td><p>objectTimestamp</p></td>
<td><p>Nein</p></td>
<td><p>Eine Datei mit einem
Zeitstempel. Der
Zeitstempel wird bei
bestimmten Aktionen
gesetzt.</p></td>
</tr>
<tr class="row-odd"><td><p>seq</p></td>
<td><p>Nein</p></td>
<td><p>Eine Hilfsdatei mit
einem JSON-Array. Das
Array zeigt an, in
welcher Reihenfolge
Kindobjekte
anzuzeigen sind.
Dieses Hilfskonstrukt
existiert, da in der
RELS-EXT keine
RDF-Listen abgelegt
werden können.</p></td>
</tr>
<tr class="row-even"><td><p>conf</p></td>
<td><p>Nein</p></td>
<td><p>Websites und
Webschnitte speichern
in einem
conf-Datenstrom alle
Parameter mit denen
die zugehörige
Webseite geharvested
wurde.</p></td>
</tr>
</tbody>
</table>
<p>Die Metadaten werden als ASCII-Kodierte N-Triple abgelegt. Da alle
Fedora-Daten als Dateien im Dateisystem abgelegt werden, ist diese
Veriante besonders robust gegen Speicherfehler. N-Triple ist ein Format,
dass sich Zeilenweise lesen lässt. ASCII ist die einfachste Form der
Textkodierung.</p>
<p>Die Daten werden als “managed”-Datastream in den Objektspeicher der
Fedora abgelegt. Eine Ausnahme bilden Webseiten. Die als WARC
gespeicherten Inhalte werden “unmanaged” lediglich verlinkt. Im Fedora
Objektspeicher wird nur eine Datei mit der ensprechenden Referenz
abgelegt.</p>
</div>
<div class="section" id="namespaces-und-identifier">
<h2>Namespaces und Identifier<a class="headerlink" href="#namespaces-und-identifier" title="Permalink to this headline">¶</a></h2>
<p>Jede Regal-Installation arbeitet auf einem festgelegten Namespace. Wenn
über die <a class="reference external" href="#_regal_api_2">regal-api</a> Objekte angelegt werden, finden
sich diese immer in dem entsprechenden Namespace wieder. Hinter dem
Namespace findet sich, abgetrennt mit einem Dopplepunkt eine
hochlaufende Zahl, die i.d.R. über <a class="reference external" href="#_fedora_commons_3">Fedora Commons
3</a> bezogen wird.</p>
<p>Der so zusammengesetzte Identifier kommt in allen Systemkomponenten zum
Einsatz.</p>
<table class="docutils align-default" id="id15">
<caption><span class="caption-text">Beispiel Regal Identifier</span><a class="headerlink" href="#id15" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>ID</p></th>
<th class="head"><p>Komponente</p></th>
<th class="head"><p>URL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>regal:1</p></td>
<td><p>drupal</p></td>
<td><p><a class="reference external" href="http://local">http://local</a>
host/resource/regal:1</p></td>
</tr>
<tr class="row-odd"><td><p>regal:1</p></td>
<td><p>regal-api</p></td>
<td><p><a class="reference external" href="http://api.local">http://api.local</a>
host/resource/regal:1</p></td>
</tr>
<tr class="row-even"><td><p>regal:1</p></td>
<td><p>fedora</p></td>
<td><p>ht
tp://localhost:8080/f
edora/objects/regal:1</p></td>
</tr>
<tr class="row-odd"><td><p>regal:1</p></td>
<td><p>elasticsearch</p></td>
<td><p><a class="reference external" href="http://localhost:92">http://localhost:92</a>
00/regal/_all/regal:1</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="deskriptive-metadaten">
<h2>Deskriptive Metadaten<a class="headerlink" href="#deskriptive-metadaten" title="Permalink to this headline">¶</a></h2>
<p>Regal unterstützt eine große Anzahl von Metadatenfeldern zur
Beschreibung von bibliografischen Ressourcen. Jedes in Regal
verspeicherte Objekt kann mit Hilfe von RDF-Metadaten beschrieben
werden. Das System verspeichert grundsätzlich alle Metadaten, solange
Sie im richtigen Format an die Schnittstelle gespielt werden.</p>
<p>Darüber hinaus können über bestimmte Angaben, bestimmte weitergehende
Funktionen angesteuert werden. Dies betrifft u.A.:</p>
<ul class="simple">
<li><p>Anzeige und Darstellung</p></li>
<li><p>Metadatenkonvertierungen</p></li>
<li><p>OAI-Providing</p></li>
<li><p>Suche</p></li>
</ul>
<p>Alle bekannten Metadateneinträge werden in der Komponente
<a class="reference external" href="#_etikett">Etikett</a> verwaltet. In <a class="reference external" href="#_etikett">Etikett</a> kann
konfiguriert werden, welche URIs aus den RDF-Daten in das JSON-LD-Format
von <a class="reference external" href="#_regal_api_2">regal-api</a> überführt werden. Außerdem kann die
Reihenfolge der Darstellung, und das Label zur Anzeige gesetzt werden.</p>
<table class="docutils align-default" id="id16">
<caption><span class="caption-text">Etikett-Eintrag für dc:title</span><a class="headerlink" href="#id16" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 14%" />
<col style="width: 14%" />
<col style="width: 14%" />
<col style="width: 14%" />
<col style="width: 14%" />
<col style="width: 14%" />
<col style="width: 14%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Label</p></th>
<th class="head"><p>Pi
ctogram</p></th>
<th class="head"><p>Name
(json)</p></th>
<th class="head"><p>URI</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Co
ntainer</p></th>
<th class="head"><p>Comment</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Titel</p></td>
<td><p>keine
Angabe</p></td>
<td><p>title</p></td>
<td><p>ht
tp://pu
rl.org/
dc/term
s/title</p></td>
<td><p>String</p></td>
<td><p>keine
Angabe</p></td>
<td><p>keine
Angabe</p></td>
</tr>
</tbody>
</table>
<p><strong>Etikett-Eintrag als Json.</strong></p>
<p>“title”:{ “&#64;id”=”<a class="reference external" href="http://purl.org/dc/terms/title">http://purl.org/dc/terms/title</a>”, “label”=”Titel” }</p>
<p>Die etikett Datenbank wird beim Neustart jeder
<a class="reference external" href="#_regal_api_2">regal-api</a>-Instanz eingelesen. Außerdem wird die
HTTP-Schnittstelle von Etikett immer wieder angesprochen um zur Anzeige
geeignete Labels in das System zu holen und anstatt der rohen URIs
einzublenden. Das <a class="reference external" href="#_regal_api_2">regal-api</a>-Modul läuft dabei auch
ohne den Etikett-Services, allerdings nur mit eingeschränkter
Funktionalität; beispielsweise fallen Anzeigen von verlinkten Ressourcen
(und das ist in Regal fast alles) weniger schön aus.</p>
<div class="section" id="wie-kommen-bibliografische-metadaten-ins-system">
<h3>Wie kommen bibliografische Metadaten ins System?<a class="headerlink" href="#wie-kommen-bibliografische-metadaten-ins-system" title="Permalink to this headline">¶</a></h3>
<p>In Regal können bibliografische Metadaten aus dem hbz-Verbundkatalog an
Ressourcen “angelinkt” werden. Dies erfolgt über Angabe der ID des
entsprechenden Titelsatzes (z.b. HT017766754). Mit Hilfe dieser ID kann
Regal einen Titelimport durchführen. Dabei wird auf die Schnittstellen
der <a class="reference external" href="https://lobid.org">Lobid-API</a> zugegriffen.</p>
<p>Regal bietet außerdem die Möglichkeit, Metadaten über Erfassungsmasken
zu erzeugen und zu speichern. Dies erfolgt mit Hilfe des Moduls
<a class="reference external" href="#_zettel">Zettel</a>. <a class="reference external" href="#_zettel">Zettel</a> ist ein Webservice, der
verschiedene HTML-Formulare bereitstellt. Die Formulare können
RDF-Metadaten einlesen und ausgeben. Zettel-Formulare werden über
Javascript mit Hilfe eines IFrame in die eigentliche Anwendung
angebunden. Über Zettel werden Konzepte aus dem Bereich Linked Data
umgesetzt. So können Feldinhalte über entsprechende Eingabeelemente in
Drittsystemen recherchiert und verlinkt werden. Die Darstellung von
Links erfolgt in Zettel mit Hilfe von <a class="reference external" href="#_etikett">Etikett</a>.
Umfangreichere Notationssysteme wie Agrovoc oder DDC werden über einen
eigenen Index aus dem Modul <a class="reference external" href="#_skos_lookup">skos-lookup</a> eingebunden.
Zettel unterstützt zur Zeit folgende Linked-Data-Quellen:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://lobid.org/gnd">Lobid (GND)</a></p></li>
<li><p><a class="reference external" href="https://lobid.org/resources">Lobid (Ressource)</a></p></li>
<li><p><a class="reference external" href="http://aims.fao.org/vest-registry/vocabularies/agrovoc">Agrovoc</a></p></li>
<li><p><a class="reference external" href="https://www.oclc.org/en/dewey.html">DDC</a></p></li>
<li><p><a class="reference external" href="https://www.crossref.org/services/funder-registry/">CrossRef (Funder
Registry)</a></p></li>
<li><p><a class="reference external" href="https://orcid.org/">Orcid</a></p></li>
<li><p><a class="reference external" href="https://www.geonames.org/">Geonames</a></p></li>
<li><p><a class="reference external" href="https://www.openstreetmap.org">Open Street Maps Koordinaten</a></p></li>
</ul>
</div>
</div>
<div class="section" id="anzeige-und-darstellung">
<h2>Anzeige und Darstellung<a class="headerlink" href="#anzeige-und-darstellung" title="Permalink to this headline">¶</a></h2>
<p>Über die Schnittstellen der <a class="reference external" href="#_regal_api_2">regal-api</a> können
unterschiedliche Darstellungen einer Publikation bezogen werden. Über
<a class="reference external" href="https://de.wikipedia.org/wiki/Content_Negotiation">Content
Negotiation</a>
können Darstellungen per HTTP-Header angefragt werden. Um
unterschiedliche Darstellungen im Browser anzeigen zu lassen, kann
außerden, über das Setzen von entsprechenden Endungen, auf
unterschiedliche Representationen eine Resource zugegriffen werden.</p>
<p><strong>Auswahl von Pfaden zu unterschiedlichen Representationen einer
Ressource.</strong></p>
<p>/resource/regal:1 /resource/regal:1.json /resource/regal:1.rdf
/resource/regal:1.epicur /resource/regal:1.mets</p>
<p>In der HTML-Darstellung greift <a class="reference external" href="#_regal_api_2">regal-api</a> auf den
Hilfsdienst <a class="reference external" href="#_thumby">Thumby</a> zu um darüber Thumbnail-Darstellungen
von PDFs oder Bilder zu kreieren. Bei großen Bildern wird außerdem der
<a class="reference external" href="#_deepzoomer">Deepzoomer</a> angelinkt, der eine Darstellung von
hochauflösenden Bildern über das Tool
<a class="reference external" href="https://openseadragon.github.io/">OpenSeadragon</a> erlaubt. Video- und
Audio-Dateien werden über die entsprechenden HTML5 Elemente gerendert.</p>
</div>
<div class="section" id="der-hbz-verbundkatalog">
<h2>Der hbz-Verbundkatalog<a class="headerlink" href="#der-hbz-verbundkatalog" title="Permalink to this headline">¶</a></h2>
<p>Metadaten, die über den Verbundkatalog importiert wurden, können über
einen Cronjob regelmäßig aktualisiert werden. Außerdem können diese
Daten über OAI-PMH an den Verbundkatalog zurückgeliefert werden, so dass
dieser, Links auf die Volltexte erhält.</p>
</div>
<div class="section" id="metadatenkonvertierung">
<h2>Metadatenkonvertierung<a class="headerlink" href="#metadatenkonvertierung" title="Permalink to this headline">¶</a></h2>
<p>Für die Metadatenkonvertierung gibt es kein festes Vorgehensmodell oder
Werkzeug. I.d.R. gibt es für jede Representation eine oder eine Reihe
von Javaklassen, die für eine On-the-fly-Konvertierung sorgen. Die
HTML-Darstellung basiert grundlegend auf denselben Daten, die auch im
<a class="reference external" href="https://www.elastic.co/guide/index.html">Elasticsearch</a>-Index liegen
und ist im wesentlichen eine JSON-LD-Darstellung, die mit Hilfe der in
<a class="reference external" href="#_etikett">Etikett</a> hinterlegten Konfiguration aus den
bibliografischen Metadaten gewonnen wurde.</p>
</div>
<div class="section" id="oai-providing">
<h2>OAI-Providing<a class="headerlink" href="#oai-providing" title="Permalink to this headline">¶</a></h2>
<p>Öffentlich zugängliche Publikationen sind auch über die
OAI-Schnittstelle verfügbar. Dabei wird jede Publikation einer Reihe von
OAI-Sets zugeordnet und in unterschiedlichen Formaten angeboten.</p>
<table class="docutils align-default" id="id17">
<caption><span class="caption-text">OAI Set</span><a class="headerlink" href="#id17" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Set</p></th>
<th class="head"><p>Kriterium</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ddc:*</p></td>
<td><p>Wenn ein dc:subject mit dem
String “http://dewey.info/class/”
beginnt, wird ein Set mit der
entsprechenden DDC-Nummer
gebildet und die Publikation wird
zugeordnet</p></td>
</tr>
<tr class="row-odd"><td><p>contentType</p></td>
<td><p>Der “contentType” weist darauf
hin, in welcher Weise die
Publikation in Regal. Abgelegt
ist.</p></td>
</tr>
<tr class="row-even"><td><p>open_access</p></td>
<td><p>All Publikationen, die als
Sichtbarkeit “public” haben</p></td>
</tr>
<tr class="row-odd"><td><p>urn-set-1</p></td>
<td><p>Publikationen mit einer URN, die
mit <a class="reference external" href="urn:nbn:de:hbz:929:01">urn:nbn:de:hbz:929:01</a> beginnt</p></td>
</tr>
<tr class="row-even"><td><p>urn-set-2</p></td>
<td><p>Publikationen mit einer URN, die
mit <a class="reference external" href="urn:nbn:de:hbz:929:02">urn:nbn:de:hbz:929:02</a> beginnt</p></td>
</tr>
<tr class="row-odd"><td><p>epicur</p></td>
<td><p>Publikationen, die in einem
URN-Set sind</p></td>
</tr>
<tr class="row-even"><td><p>aleph</p></td>
<td><p>Publikationen , die mit einer
Aleph-Id verknüpft sind</p></td>
</tr>
<tr class="row-odd"><td><p>edoweb01</p></td>
<td><p>spezielles, pro
<a class="reference external" href="#_regal_api_2">reg
al-api</a>-Instanz
konfigurierbares Set für alle
Publikationen, die im aleph-Set
sind</p></td>
</tr>
<tr class="row-even"><td><p>ellinet01</p></td>
<td><p>spezielles, pro
<a class="reference external" href="#_regal_api_2">reg
al-api</a>-Instanz
konfigurierbares Set für alle
Publikationen, die im aleph-Set
sind</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id18">
<caption><span class="caption-text">OAI Metadatenformat</span><a class="headerlink" href="#id18" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Format</p></th>
<th class="head"><p>Kriterium</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>oai_dc</p></td>
<td><p>Alle öffentlich sichtbaren
Objekte, die als bestimmte
ContentTypes angelegt wurden.</p></td>
</tr>
<tr class="row-odd"><td><p>epicur</p></td>
<td><p>Alle Objekte, die eine URN haben</p></td>
</tr>
<tr class="row-even"><td><p>aleph</p></td>
<td><p>Alle Objekte, die einen
persistenten Identifier haben</p></td>
</tr>
<tr class="row-odd"><td><p>mets</p></td>
<td><p>Wie oai_dc</p></td>
</tr>
<tr class="row-even"><td><p>rdf</p></td>
<td><p>Wie oai_dc</p></td>
</tr>
<tr class="row-odd"><td><p>wgl</p></td>
<td><p>Format für LeibnizOpen. Alle
Objekte die über das Feld
“collectionOne” einer Institution
zugeordnet wurden und über den
ContentType “article”
eingeliefert wurden.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="suche">
<h2>Suche<a class="headerlink" href="#suche" title="Permalink to this headline">¶</a></h2>
<p>Der Elasticsearch-Index wird mit Hilfe einer JSON-LD Konvertierung
befüllt. Die Konvertierung basiert im wesentlichen auf den
bibliografischen Metadaten der einzelnen Ressourcen und wir mit Hilfe
der in <a class="reference external" href="#_etikett">Etikett</a> hinterlegten Konfiguration erzeugt.</p>
</div>
<div class="section" id="zugriffsberechtigungen-und-sichtbarkeiten">
<h2>Zugriffsberechtigungen und Sichtbarkeiten<a class="headerlink" href="#zugriffsberechtigungen-und-sichtbarkeiten" title="Permalink to this headline">¶</a></h2>
<p>Regal setzt ein rollenbasiertes Konzept zur Steuerung von
Zugriffsberechtigungen um. Eine besondere Bedeutung kommt dem lesenden
Zugriff auf Ressourcen zu. Einzelne Ressourcen können in ihrer
Sichtbarkeit so eingeschränkt werden, dass nur mit den Rechten einer
bestimmten Rolle lesend zugegriffen werden kann. Dabei kann der Zugriff
auf Metadaten und Daten separat gesteuert werden.</p>
<div class="figure align-default" id="id19">
<img alt="Screenshot zur Verdeutlichung von Sichtbarkeiten in Regal" src="_images/accessControl.png" />
<p class="caption"><span class="caption-text">Screenshot zur Verdeutlichung von Sichtbarkeiten in Regal</span><a class="headerlink" href="#id19" title="Permalink to this image">¶</a></p>
</div>
<p>Die Konfiguration hat Auswirkungen auf die Sichtbarkeit einer
Publikation in den unterschiedlichen Systemteilen. Die folgende Tabelle
veranschaulicht den derzeitigen Stand der Implementierung.</p>
<div class="section" id="sichtbarkeiten-operationen-rollen">
<h3>Sichtbarkeiten, Operationen, Rollen<a class="headerlink" href="#sichtbarkeiten-operationen-rollen" title="Permalink to this headline">¶</a></h3>
<table class="docutils align-default" id="id20">
<caption><span class="caption-text"><strong>Schreibender</strong> Zugriff auf Daten und Metadaten</span><a class="headerlink" href="#id20" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Rolle</p></td>
<td><p>Art der Aktion</p></td>
</tr>
<tr class="row-even"><td><p>ADMIN</p></td>
<td><p>Darf alle Aktionen durchführen.
Auch Bulk-Aktionen und “Purges”</p></td>
</tr>
<tr class="row-odd"><td><p>EDITOR</p></td>
<td><p>Darf Objekte anlegen, löschen,
Sichtbarkeiten ändern, etc.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id21">
<caption><span class="caption-text"><strong>Lesender</strong> Zugriff auf Metadaten</span><a class="headerlink" href="#id21" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Sichtbarkeit</p></th>
<th class="head"><p>Rolle</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>public</p></td>
<td><p>GUEST,READ
ER,SUBSCRIBER,REMOTE,ADMIN,EDITOR</p></td>
</tr>
<tr class="row-odd"><td><p>private</p></td>
<td><p>ADMIN,EDITOR</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id22">
<caption><span class="caption-text"><strong>Lesender</strong> Zugriff auf Daten</span><a class="headerlink" href="#id22" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Sichtbarkeit</p></th>
<th class="head"><p>Rolle</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>public</p></td>
<td><p>GUEST,READ
ER,SUBSCRIBER,REMOTE,ADMIN,EDITOR</p></td>
</tr>
<tr class="row-odd"><td><p>restricted</p></td>
<td><p>READ
ER,SUBSCRIBER,REMOTE,ADMIN,EDITOR</p></td>
</tr>
<tr class="row-even"><td><p>remote</p></td>
<td><p>READ
ER,SUBSCRIBER,REMOTE,ADMIN,EDITOR</p></td>
</tr>
<tr class="row-odd"><td><p>single</p></td>
<td><p>SUBSCRIBER,ADMIN,EDITOR</p></td>
</tr>
<tr class="row-even"><td><p>private</p></td>
<td><p>ADMIN,EDITOR</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="benutzerverwaltung">
<h2>Benutzerverwaltung<a class="headerlink" href="#benutzerverwaltung" title="Permalink to this headline">¶</a></h2>
<p>Die Benutzerverwaltung von Regal findet innerhalb von Drupal statt. Zwar
können auch in der <a class="reference external" href="#_regal_api_2">regal-api</a> Benutzer angelegt
werden, jedoch ist die Implementierung in diesem Bereich erst
rudimentär.</p>
<div class="section" id="drupal">
<h3>Drupal<a class="headerlink" href="#drupal" title="Permalink to this headline">¶</a></h3>
<p>Benutzer in Drupal können über das Modul
<a class="reference external" href="#_regal_drupal">regal-drupal</a> unterschiedlichen Rollen zugewiesen
werden. Die Authorisierung erfolgt passwortbasiert. Alle Drupal-Benutzer
greifen über einen vorkonfigurierten Accessor auf die
<a class="reference external" href="#_regal_api_2">regal-api</a> zu. Alle Zugriffe erfolgen verschlüsselt
unter Angabe eines Passwortes. Die Rolle mit deren Berechtigungen
zugegriffen wird, wird dabei in <a class="reference external" href="#_regal_drupal">regal-drupal</a>
gesetzt. Die Drupal-BenutzerId wird als Metadatum in Form eines
proprietären HTTP-Headers mit an <a class="reference external" href="#_regal_api_2">regal-api</a>
geliefert.</p>
</div>
<div class="section" id="regal-api">
<h3>Regal-Api<a class="headerlink" href="#regal-api" title="Permalink to this headline">¶</a></h3>
<p>Auch in regal-api können Api-Benutzer angelegt werden. Zur
Benutzerverwaltung wird eine MySQL-Datenbank eingesetzt, in der die
Passworte der Nutzer abgelegt sind.</p>
</div>
</div>
<div class="section" id="ansichten">
<h2>Ansichten<a class="headerlink" href="#ansichten" title="Permalink to this headline">¶</a></h2>
<p>Um Daten, die in <a class="reference external" href="#_regal_api_2">regal-api</a> abgelegt wurden zur
Anzeige zu bringen sind i.d.R. mehrere Schritte nötig. Die genaue
Vorgehensweise ist davon abhängig, wo die Daten abgelegt werden (in
welchem Fedora Datenstrom). Grundsätzlich basiert die HTML-Darstellung
auf den Daten, die unter dem Format <code class="docutils literal notranslate"><span class="pre">.json2</span></code> einer Ressource abrufbar
sind und einen Eintrag in context.json haben.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">**</span><span class="n">Daten</span> <span class="n">zur</span> <span class="n">Ansicht</span> <span class="n">bringen</span><span class="o">**</span>
</pre></div>
</div>
<ol class="arabic simple">
<li><p>Eintrag des zugehörigen RDF-Properties in die entsprechende
<a class="reference external" href="#_etikett">Etikett</a>-Instanz, bzw. in die <code class="docutils literal notranslate"><span class="pre">/conf/labels.json</span></code>.
Der Eintrag muss einen Namen, ein Label und einen Datentyp haben.
<a class="reference external" href="#_regal_api_2">regal-api</a> neu starten, bzw mit
<code class="docutils literal notranslate"><span class="pre">POST</span> <span class="pre">/context.json</span></code> das neu Laden der Contexteinträge erzwingen.</p></li>
<li><p>Dies müsste reichen, um eine Standardanzeige in der HTML-Ausgabe zu
erreichen</p></li>
<li><p>Wenn die Daten nicht erscheinen, sollte man überprüfen, ob sie unter
dem Format <code class="docutils literal notranslate"><span class="pre">.json2</span></code> erscheinen. Wenn nicht, stellt sich die Frage,
wo die Daten abgelegt werden. Komplett werden nur die Daten aus dem
Fedora Datenstrom /metadata2 prozessiert. Befindet sich das Datum in
z.B. im /RELS-EXT Datenstrom so muss es zunächst manuell unter
<code class="docutils literal notranslate"><span class="pre">helper.JsonMapper#getLd2()</span></code> in das JSON-Objekt eingefügt werden.</p></li>
<li><p>Einige Felder werden auch ausgeblendet. Dies geschieht in
<a class="reference external" href="#_regal_api_2">regal-api</a> unter <code class="docutils literal notranslate"><span class="pre">/public/stylesheets/main.css</span></code>
und in Drupal innerhalb der entsprechenden themes.</p></li>
<li><p>Um spezielle Anzeigen zu realisieren muss schließlich im
HTML-Template angefasst werden, unter
<code class="docutils literal notranslate"><span class="pre">/app/views/tags/resourceView.scala.html</span></code> .</p></li>
</ol>
<p>Insgesamt läuft es also so: Alles was in <a class="reference external" href="#_etikett">Etikett</a>
konfiguriert ist, wird auch ins JSON und damit ins HTML und in den
Suchindex übernommen. Dinge, die im HTML nicht benötigt werden, werden
über CSS wieder ausgeblendet.</p>
</div>
</div>
<div class="section" id="software">
<h1>Software<a class="headerlink" href="#software" title="Permalink to this headline">¶</a></h1>
<p>Die technische Dokumentation der HTTP-Schnittstelle findet sich unter
<a class="reference external" href="./api.html">API Doku</a></p>
<p>Nachfolgend sei eine Innenansicht der einzelnen Module aufgestellt. Die
Integration der Module erfolgt i.d.R. über HTTPs. Die Module werden über
entsprechende Einträge in der Apache-Konfiguration sichtbar gemacht. Es
handelt sich also um eine Webservice-Architektur, in der alle
Webservices über einen Apache-Webserver und entsprechende Einträge in
ihren Konfigurationsdateien miteinander verbunden werden.</p>
<div class="figure align-default" id="id23">
<img alt="Regal Abhängigkeiten" src="_images/regal-dependencies.jpeg" />
<p class="caption"><span class="caption-text">Regal Abhängigkeiten</span><a class="headerlink" href="#id23" title="Permalink to this image">¶</a></p>
</div>
<div class="section" id="id1">
<h2>regal-api<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<table class="docutils align-default" id="id24">
<caption><span class="caption-text">Überblick</span><a class="headerlink" href="#id24" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Source</p></td>
<td><p><a class="reference external" href="https://github.com/edoweb/regal-api">regal-api</a></p></td>
</tr>
<tr class="row-even"><td><p>Technik</p></td>
<td><p><a class="reference external" href="https://www.playframework.com/documentation/2.4.x/JavaHome">Play
2.4
.2</a></p></td>
</tr>
<tr class="row-odd"><td><p>Ports</p></td>
<td><p>9000 / 9100</p></td>
</tr>
<tr class="row-even"><td><p>Verzeichnis</p></td>
<td><p>/opt/regal/apps/regal ,
/opr/regal/src/regal</p></td>
</tr>
<tr class="row-odd"><td><p>HTTP Pfad</p></td>
<td><p>/</p></td>
</tr>
</tbody>
</table>
<p>Mit regal-api werden alle grundlegenden Funktionen von Regal
bereitgestellt. Dies umfasst:</p>
<ul class="simple">
<li><p>HTTP Schnittstelle</p></li>
<li><p>Sichtbarkeiten, Zugriffskontrolle, Rollen</p></li>
<li><p>Speicherung, Datenhaltung</p></li>
<li><p>Konvertierungen</p></li>
<li><p>Ansichten</p></li>
<li><p>Suche</p></li>
<li><p>Webarchivierung</p></li>
</ul>
<p>Der Webservice ist auf Basis von <a class="reference external" href="https://www.playframework.com/documentation/2.4.x/JavaHome">Play
2.4.2</a>
realisiert und bietet eine reichhaltig HTTP-API zur Verwaltung von
elektronischen Publikationen an. Die <a class="reference external" href="#_regal_api_2">regal-api</a>
operiert auf <a class="reference external" href="#_fedora_commons_3">Fedora Commons 3</a>,
<a class="reference external" href="#_mysql">MySql</a> und <a class="reference external" href="#_elasticsearch_1_1">Elasticsearch 1.1</a>.
Über die API werden auch Funktionalitäten von <a class="reference external" href="#_etikett">Etikett</a>,
<a class="reference external" href="#_thumby">Thumby</a>, <a class="reference external" href="#_zettel">Zettel</a> und
<a class="reference external" href="#_deepzoomer">Deepzoomer</a> angesprochen. Für die Webarchivierung
werden <a class="reference external" href="#_heritrix">heritrix</a>, <a class="reference external" href="#_wpull">wpull</a> und
<a class="reference external" href="#_openwayback">openwayback</a> angebunden.</p>
<div class="section" id="konfiguration">
<h3>Konfiguration<a class="headerlink" href="#konfiguration" title="Permalink to this headline">¶</a></h3>
<table class="docutils align-default" id="id25">
<caption><span class="caption-text">Dateien im /conf Verzeichnis</span><a class="headerlink" href="#id25" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Datei</p></th>
<th class="head"><p>Beschreibung</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>aggregations.conf</strong></p></td>
<td><p>Diese Datei wird verwendet um die
Schnittstelle <code class="docutils literal notranslate"><span class="pre">/browse</span></code> zu
konfigurieren. Die Einträg im
Object “aggs” können direkt über
die <code class="docutils literal notranslate"><span class="pre">/browse</span></code> Schnittstelle
angesprochen werden. Mit Hilfe
des Elasticsearch-Indexes wird
dann eine entsprechende Antwort
generiert. Beispiel:
<code class="docutils literal notranslate"><span class="pre">/browse/rdftype</span></code> liefert eine
Liste mit allen
Publikationstypen, die im Index
vorhanden sind.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>application.conf.tmpl</strong></p></td>
<td><p>Eine template Datei für die
Hauptkonfiguration von
<a class="reference external" href="#_regal_api_2">regal-api</a>.
Diese Datei sollte zur lokalen
Verwendung einmal nach
application.conf kopiert werden.
In der Datei sind alle Passwörter
auf <em>admin</em> gesetzt.</p></td>
</tr>
<tr class="row-even"><td><p>crawler-beans.cxml</p></td>
<td><p>Die Datei wird verwendet, wenn im
Webarchivierungsmodul eine neue
Konfiguration für eine Webseite
angelegt wird.</p></td>
</tr>
<tr class="row-odd"><td><p>ehcache.xml</p></td>
<td><p>die Konfiguration der Ehcache
Komponente</p></td>
</tr>
<tr class="row-even"><td><p>fedora-users.xml</p></td>
<td><p>deprecated - Zur Löschung
vorgeschlagen</p></td>
</tr>
<tr class="row-odd"><td><p>hbz_edoweb_url.txt</p></td>
<td><p>deprecated - Zur Löschung
vorgeschlagen</p></td>
</tr>
<tr class="row-even"><td><p>html.html</p></td>
<td><p>deprecated - Zur Löschung
vorgeschlagen</p></td>
</tr>
<tr class="row-odd"><td><p>install.properties</p></td>
<td><p>deprecated - Zur Löschung
vorgeschlagen</p></td>
</tr>
<tr class="row-even"><td><p>labels-edoweb.de</p></td>
<td><p>Labels für eine bestimmt
Regal-Instanz</p></td>
</tr>
<tr class="row-odd"><td><p>labels-for
-proceeding-and-researchData.json</p></td>
<td><p>deprecated - Zur Löschung
vorgeschlagen</p></td>
</tr>
<tr class="row-even"><td><p>labels-lobid.json</p></td>
<td><p>deprecated - Zur Löschung
vorgeschlagen</p></td>
</tr>
<tr class="row-odd"><td><p>labels-publisso.de</p></td>
<td><p>Labels für eine bestimmte
Regal-Instanz</p></td>
</tr>
<tr class="row-even"><td><p><strong>labels.json</strong></p></td>
<td><p>Eine sinnvolle
Startkonfiguration. Die Datei
wurde mit <a class="reference external" href="#_etikett">Etikett</a>
erzeugt. Beim Start von
<a class="reference external" href="#_regal_api_2">regal-api</a>
wird zunächst versucht eine
ähnliche Konfiguration direkt von
einer laufenden
<a class="reference external" href="#_etikett">Etikett</a>-Instanz
zu holen. Wenn dies nicht klappt,
wird auf die labels.json
zurückgegriffen.</p></td>
</tr>
<tr class="row-odd"><td><p>list.html</p></td>
<td><p>deprecated - Zur Löschung
vorgeschlagen</p></td>
</tr>
<tr class="row-even"><td><p>logback.developer.xml</p></td>
<td><p>Eine logging Konfiguration. Ich
kopiere die immer nach
logback.developer.js.xml (in
.gitignore) und trage sie dann in
die application.conf ein. Auf
diese Weise kann ich an Loglevels
herumkonfigurieren ohne das in
diese Änderungen in die
Versionsverwaltung spielen zu
müssen.</p></td>
</tr>
<tr class="row-odd"><td><p>logback.xml</p></td>
<td><p>Konfiguration des Loggers. Diese
Datei ist in application.conf
eingetragen.</p></td>
</tr>
<tr class="row-even"><td><p>mab
xml-string-template-on-record.xml</p></td>
<td><p>Eine template-Datei zur
Generierung von MAB-Ausgaben.</p></td>
</tr>
<tr class="row-odd"><td><p>mail.properties</p></td>
<td><p>Konfiguration zur Versendung von
Mails. Standardmäßig schickt die
Applikation eine Mail, sobald sie
im Production-Mode neu gestartet
wurde. Auch der Umzugsservice im
Webarchivierungsmodul verschickt
Mails.</p></td>
</tr>
<tr class="row-even"><td><p>nwbib-spatial.ttl</p></td>
<td><p>deprecated - Zur Löschung
vorgeschlagen</p></td>
</tr>
<tr class="row-odd"><td><p>nwbib.ttl</p></td>
<td><p>deprecated - Zur Löschung
vorgeschlagen</p></td>
</tr>
<tr class="row-even"><td><p><strong>public-index-config.json</strong></p></td>
<td><p>Konfiguration des
Elasticsearch-Indexes. Da in dem
Index vorallem Metadaten liegen,
soll fast nicht tokenisiert
werden.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>routes</strong></p></td>
<td><p>Hier sind alle HTTP-Pfade
übersichtlich aufgeführt.</p></td>
</tr>
<tr class="row-even"><td><p>scm-info.sh</p></td>
<td><p>Diese Datei kann man unter Linux
in die profile-Konfiguration
seines Benutzers einbinden. Dann
erhält man im Terminal farbige
Angabgen zu Git-Branches,etc.</p></td>
</tr>
<tr class="row-odd"><td><p>start-regal.sh</p></td>
<td><p>deprecated - Zur Löschung
vorgeschlagen</p></td>
</tr>
<tr class="row-even"><td><p>tomcat-users.xml</p></td>
<td><p>deprecated - Zur Löschung
vorgeschlagen</p></td>
</tr>
<tr class="row-odd"><td><p>unescothes.ttl</p></td>
<td><p>deprecated - Zur Löschung
vorgeschlagen</p></td>
</tr>
<tr class="row-even"><td><p>wglcontributor.csv</p></td>
<td><p>deprecated - Zur Löschung
vorgeschlagen</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="die-applikation">
<h3>Die Applikation<a class="headerlink" href="#die-applikation" title="Permalink to this headline">¶</a></h3>
<table class="docutils align-default" id="id26">
<caption><span class="caption-text">Das /app Verzeichnis</span><a class="headerlink" href="#id26" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Package</p></th>
<th class="head"><p>Beschreibung</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>default package</p></td>
<td><p>Hier befindet sich die Datei
Global, die in <a class="reference external" href="https://www.playframework.com/documentation/2.4.x/JavaHome">Play
2
.4</a>
noch eine große Rolle spielt. In
der Datei können zum Beispiel
Aktionen vor dem Start der
Applikation erfolgen, auch können
hier HTTP-Requests mit geloggt
werden. Bestimmte Aktionen werden
nur im Production-Mode
ausgeführt, d.h. nur wenn die
Applikation mit <code class="docutils literal notranslate"><span class="pre">start</span></code>
gestartet wurde oder über
<code class="docutils literal notranslate"><span class="pre">dist</span></code> ein entsprechendes
Binary erzeugt wurde.</p></td>
</tr>
<tr class="row-odd"><td><p>actions</p></td>
<td><p>Hier sind Funktionen versammelt,
die meist unmittelbar aus den
Controller-Klassen aufgerufen
werden.</p></td>
</tr>
<tr class="row-even"><td><p>archive.fedora</p></td>
<td><p>Ein Reihe von Dateien, über die
Zugriffe auf <a class="reference external" href="#_fedora_commons_3">Fedora Commons
3</a>
organisiert werden. Hier finden
sich auch einige Hilfsklassen
(<code class="docutils literal notranslate"><span class="pre">Utils</span></code>). Das FedoraInterface
zeigt an, welche Aktionen auf der
Fedora ausgeführt werden. Der
Code in diesem Paket gehört mit
zu dem ältesten Code im gesamten
Regal-Projekt.</p></td>
</tr>
<tr class="row-odd"><td><p>archive.search</p></td>
<td><p>Zugriff auf die Elasticsearch</p></td>
</tr>
<tr class="row-even"><td><p>authenticate</p></td>
<td><p>Regal verwendet Basic-Auth zur
Authentifizierung. Um die
entsprechenden Aufrufe in den
Controllern zu Schützen wird eine
Annotation <code class="docutils literal notranslate"><span class="pre">&#64;BasicAuth</span></code>
verwendet. Diese findet sich
hier. Die Annotation selbst
bewirkt, dass jeder
Controller-Aufruf durch die
Methode <code class="docutils literal notranslate"><span class="pre">basicAuth</span></code> der Klasse
<code class="docutils literal notranslate"><span class="pre">BasicAuthAction.java</span></code> läuft.
Ziel dieser Prozedur ist es, dem
aktuellen Zugriff die
Berechtigungen einer bestimmten
Rolle zuzuordnen.</p></td>
</tr>
<tr class="row-odd"><td><p>controllers</p></td>
<td><p>Der Code, der in diesen Klassen
organisiert ist, wird bei den
entsprechenden HTTP-Aufrufen
ausgeführt. In der
<code class="docutils literal notranslate"><span class="pre">/conf/routes</span></code> Datei kann man
sehen, welcher HTTP-Aufruf,
welchen Methoden-Aufruf zur Folge
hat. Die Controller-Klassen sind
i.d.R. von der Klasse
MyController abgeleitet, die
Hilfsfunktionen bereitstellt,
aber auch Funktionen zur
Überprüfung von Zugriffsrechten.
Die Überprüfung von
Zugriffsrechten erfolgt durch
eingebettet Calls und wird über
die internen Klassen von
MyController realisiert.
Beispiel: Die Funktion
<code class="docutils literal notranslate"><span class="pre">listNodes</span></code> in der Klasse
<code class="docutils literal notranslate"><span class="pre">controllers.Resource</span></code> ruft
ihre Prozeduren eingebettet in
eine Funktion der Klasse
<code class="docutils literal notranslate"><span class="pre">ListAction</span></code> auf. Die Klasse
<code class="docutils literal notranslate"><span class="pre">ListAction</span></code> ist in
<code class="docutils literal notranslate"><span class="pre">MyController</span></code> implementiert
und überprüft, ob der Aufruf mit
der nötigen Berechtigung
erfolgte. Vgl.
<a class="reference external" href="#_zugriffsberechtigungen_und_sichtbarkeiten">Zugriffsberechtigungen und
Sichtbarkeiten</a></p></td>
</tr>
<tr class="row-even"><td><p>converter.mab</p></td>
<td><p>Diese Datei realisiert das
OAI-Providing von MAB-Daten.
Ursprünglich war geplant,
wesentlich umfangreichere
MAB-Datensätze an den
Verbundkatalog zu liefern. Daher
wird hier mit einer eigenen
Template-Engine gearbeitet, etc.
Ein lustiges Produkt in diesem
Kontext ist auch die Klasse
<code class="docutils literal notranslate"><span class="pre">models.MabRecord</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p>de.hbz.lobid.helper</p></td>
<td><p>Der hier befindliche Code kommt
ursprünglich aus einem anderen
Paket, wurde dann aber beim
Neuaufbau des Lobid 2
Datendienstes gemeinsam mit den
Kollegen weiterentwickelt und ist
schließlich wieder hier gelandet.
Mittlerweile ist die offizielle
JSON-LD-Library soweit
entwickelt, dass man die
Konvertierung auch darüber machen
kann. Achja, denn dafür ist der
Code: Lobid N-Triples in schönes
JSON umzuformen, das dann auch in
den Elasticsearch-Index kann.</p></td>
</tr>
<tr class="row-even"><td><p>helper</p></td>
<td><p>Die mit Abstand wichtigste Klasse
in diesem Package heißt
<code class="docutils literal notranslate"><span class="pre">JsonMapper</span></code>. Hier wird das
JSON für Index und Ansichten
erzeugt.</p></td>
</tr>
<tr class="row-odd"><td><p>helper.mail</p></td>
<td><p>Emails verschicken.</p></td>
</tr>
<tr class="row-even"><td><p>helper.oai</p></td>
<td><p>Einige Klassen zur Regelung des
OAI-Providings. Der
<code class="docutils literal notranslate"><span class="pre">OAIDispatcher</span></code> analysiert, ob
und wie ein <code class="docutils literal notranslate"><span class="pre">Node</span></code> an die
OAI-Schnittstelle gelangt.</p></td>
</tr>
<tr class="row-odd"><td><p>models</p></td>
<td><p>Die wichtigste Klasse hier ist
<code class="docutils literal notranslate"><span class="pre">Node</span></code> über diese Klasse läuft
der Großteil des
Datentransportes.</p></td>
</tr>
<tr class="row-even"><td><p>views</p></td>
<td><p>Templates in der Sprache
<code class="docutils literal notranslate"><span class="pre">Twirl</span></code> und einige
Java-Hilfsklassen.</p></td>
</tr>
<tr class="row-odd"><td><p>views.mediaViewers</p></td>
<td><p>Ein paar Viewer, die über die
Hilfsklasse <code class="docutils literal notranslate"><span class="pre">ViewerInfo</span></code> in
<code class="docutils literal notranslate"><span class="pre">tags.resourceView</span></code> eingebunden
werden können.</p></td>
</tr>
<tr class="row-even"><td><p>views.oai</p></td>
<td><p>Mit <code class="docutils literal notranslate"><span class="pre">Twirl</span></code> XML zu generieren
war keine gute Idee.</p></td>
</tr>
<tr class="row-odd"><td><p>views.tags</p></td>
<td><p>Hilfstemplates.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="etikett">
<h2>Etikett<a class="headerlink" href="#etikett" title="Permalink to this headline">¶</a></h2>
<table class="docutils align-default" id="id27">
<caption><span class="caption-text">Überblick</span><a class="headerlink" href="#id27" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Source</p></td>
<td><p><a class="reference external" href="https://github.com/hbz/etikett">etikett</a></p></td>
</tr>
<tr class="row-even"><td><p>Technik</p></td>
<td><p><a class="reference external" href="https://www.playframework.com/documentation/2.2.x/JavaHome">Play Play
2.2
.2</a></p></td>
</tr>
<tr class="row-odd"><td><p>Ports</p></td>
<td><p>9002 / 9102</p></td>
</tr>
<tr class="row-even"><td><p>Verzeichnis</p></td>
<td><p>/opt/regal/apps/etikett ,
/opr/regal/src/etikett</p></td>
</tr>
<tr class="row-odd"><td><p>HTTP Pfad</p></td>
<td><p>/tools/etikett</p></td>
</tr>
</tbody>
</table>
<p>Etikett ist eine einfache Datenbankanwendung, die es erlaubt</p>
<ol class="arabic simple">
<li><p>Menschenlesbare Labels für URIs abzulegen. Über eine
HTTP-Schnittstelle kann dann nach dem Label gefragt werden.</p></li>
<li><p>Auch Konfigurationen zur Erzeugung eines JSON-LD Kontextes können
abgelegt werden.</p></li>
<li><p>Die Etikett-Datenbank erweitert sich dynamisch. Wird in einem
authentifizierten Zugriff nach einer noch nicht bekannten URI
gefragt, so versucht die Applikation ein Label für die URI zu finden.</p></li>
</ol>
<p>In Etikett sind verschiedene Lookups realisiert, die dynamisch Labels
für URIs finden können. Beispiele:</p>
<ul class="simple">
<li><p>Crossref</p></li>
<li><p>Geonames</p></li>
<li><p>GND</p></li>
<li><p>Openstreetmap</p></li>
<li><p>Orcid</p></li>
<li><p>RDF, Skos, etc.</p></li>
</ul>
<p>Fragt man Etikett nach einem Label, so antwortet Etikett mit dem
Ergebnis des Lookups. Wenn Etikett nicht in der Lage ist, ein Label zu
finden, wird die URI, mit angefragt wurde, zurückgegeben.</p>
<p>Etikett kann auch als Cache verwendet werden. So werden authentifizierte
Anfragen in einer Datenbank persistiert. Erneute Anfragen werden dann
aus der Datenbank beantwortet, ein erneuter Lookup wird eingespart.
Einmal persistierte Labels werden nicht invalidiert. Die Invalidierung
kann von außerhalb über authentifizierte HTTP-Zugriffe realisiert
werden, stellt aber insgesamt noch ein Desiderat dar.</p>
<p>Etikett kann auch mit Labels vorkonfiguriert werden. Dabei können
zusätzliche Informationen zu jeder URIs mit abgelegt werden. Folgende
Informationen können in etikett abgelegt werden:</p>
<ul class="simple">
<li><p>URI</p></li>
<li><p>Label</p></li>
<li><p>Weight - Zur Definition von Anzeigereihenfolgen.</p></li>
<li><p>Pictogram Iconfont-ID - Kann anstatt oder zusätzlich zum Label
angezeigt werden.</p></li>
<li><p>ReferenceType - JSON-LD Typ</p></li>
<li><p>Container - JSON-LD Container</p></li>
<li><p>Beschreibung - Kommentar als Markdown</p></li>
</ul>
<div class="figure align-default" id="id28">
<img alt="Etikett Oberfläche" src="_images/etikett-screen.png" />
<p class="caption"><span class="caption-text">Etikett Oberfläche</span><a class="headerlink" href="#id28" title="Permalink to this image">¶</a></p>
</div>
<p>Mit Hilfe dieser Angaben kann Etikett auch einen “JSON-LD Context”
bereitstellen. Insgesamt wird über Etikett eine Art “Application
Profile” realisiert. Das Profil gibt Auskunft, welche Metadatenfelder
(definiert als URIs) in welcher Weise (Typ, Container) Verwendung finden
und wie sie angezeigt werden sollen (Label, Weight, Pictogram).</p>
<p>Im Regal-Kontext wird <a class="reference external" href="#_etikett">Etikett</a> an vielen Stellen
verwendet.</p>
<ul class="simple">
<li><p>Zur Wandlung von RDF nach JSON-LD</p></li>
<li><p>Zur Anreicherung von RDF Importen</p></li>
<li><p>Zur menschenlesbaren Darstellung von RDF</p></li>
<li><p>Zur Konfiguration von Labels, Anzeigereihenfolgen und Pictogrammen</p></li>
<li><p>Als Cache</p></li>
</ul>
<div class="section" id="id2">
<h3>Konfiguration<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<table class="docutils align-default" id="id29">
<caption><span class="caption-text">Dateien im /conf Verzeichnis</span><a class="headerlink" href="#id29" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Datei</p></th>
<th class="head"><p>Beschreibung</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>evolutions</strong></p></td>
<td><p>Dieses Verzeichnis enthält
SQL-Skripte, die bei Änderungen
des Datenbankschemas automatisch
über EBean angelegt werden. Beim
nächsten Deployment einer neuen
Etikett-Version werden die
Skripte automatische angewendet.
Die Skripte enthalten immer einen
mit “Up” markierten Part, und
einen mit “Down” markierten Part
(für rollbacks).</p></td>
</tr>
<tr class="row-odd"><td><p><strong>application.conf</strong></p></td>
<td><p>Hier kann ein Benutzer
eingestellt werden. Alle Klassen
im Verzeichnis <code class="docutils literal notranslate"><span class="pre">models.*</span></code>
erhalten eine SQL-Tabelle.</p></td>
</tr>
<tr class="row-even"><td><p>ddc.turtle</p></td>
<td><p>Eine DDC Datei. Die Datei bietet
Labels für DDC-URIs an.</p></td>
</tr>
<tr class="row-odd"><td><p>labels.json</p></td>
<td><p>Eine Labels-Datei, die zur
initialen Befüllung verwendet
werden kann.</p></td>
</tr>
<tr class="row-even"><td><p>regal.turtle</p></td>
<td><p>Eine Labels-Datei, die zur
initialen Befüllung verwendet
werden kann.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>routes</strong></p></td>
<td><p>Alle HTTP-Schnittstellen
übersichtlich in einer Datei</p></td>
</tr>
<tr class="row-even"><td><p>rpb.turtle</p></td>
<td><p>Eine Labels-Datei, die zur
initialen Befüllung verwendet
werden kann.</p></td>
</tr>
<tr class="row-odd"><td><p>rpb2.turtle</p></td>
<td><p>Eine Labels-Datei, die zur
initialen Befüllung verwendet
werden kann.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id3">
<h3>Die Applikation<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<table class="docutils align-default" id="id30">
<caption><span class="caption-text">Das /app Verzeichnis</span><a class="headerlink" href="#id30" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Package</p></th>
<th class="head"><p>Beschreibung</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>default</p></td>
<td><p>In <code class="docutils literal notranslate"><span class="pre">Global</span></code> werden die Requests
mit geloggt.</p></td>
</tr>
<tr class="row-odd"><td><p>controllers</p></td>
<td><p>In <code class="docutils literal notranslate"><span class="pre">Application</span></code> werden alle
HTTP-Operationen implementiert.
Unterstützt wird BasicAuth.</p></td>
</tr>
<tr class="row-even"><td><p>helper</p></td>
<td><p>Verschiedene Klassen, die eine
URI verfolgen und versuchen ein
Label aus den zurückgelieferten
Daten zu kreieren.</p></td>
</tr>
<tr class="row-odd"><td><p>models</p></td>
<td><p>Das Model <code class="docutils literal notranslate"><span class="pre">Etikett</span></code> ist
persistierbar.</p></td>
</tr>
<tr class="row-even"><td><p>views</p></td>
<td><p>Die meisten HTTP-Operationen
lassen sich auch über eine
Weboberfläche im Browser
aufrufen.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="zettel">
<h2>Zettel<a class="headerlink" href="#zettel" title="Permalink to this headline">¶</a></h2>
<table class="docutils align-default" id="id31">
<caption><span class="caption-text">Überblick</span><a class="headerlink" href="#id31" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Source</p></td>
<td><p><a href="#id56"><span class="problematic" id="id57">`zettel &lt;
https://github.com/hbz/zettel&gt;`__</span></a></p></td>
</tr>
<tr class="row-even"><td><p>Technik</p></td>
<td><p><a class="reference external" href="https://www.playframework.com/documentation/2.5.x/JavaHome">Play Play
2.5
.4</a></p></td>
</tr>
<tr class="row-odd"><td><p>Ports</p></td>
<td><p>9003 / 9103</p></td>
</tr>
<tr class="row-even"><td><p>Verzeichnis</p></td>
<td><p>/opt/regal/apps/zettel,
/opr/regal/src/zettel</p></td>
</tr>
<tr class="row-odd"><td><p>HTTP Pfad</p></td>
<td><p>/tools/zettel</p></td>
</tr>
</tbody>
</table>
<p>Zettel ist ein Webservice zur Bereitstellung von Webformularen. Die
Webformulare können über ein HTTP-GET geladen werden. Sollen
existierende Daten in ein Formular geladen werden, so können diese Daten
(1) als Form-encoded, (2) als JSON, oder (3) als RDF-XML über ein
<code class="docutils literal notranslate"><span class="pre">HTTP</span> <span class="pre">POST</span></code> in das Formular geladen werden. Gleichzeitig kann
spezifiziert werden, in welchem Format das Formular Daten zurückliefern
soll.</p>
<div class="figure align-default" id="id32">
<img alt="Zettel Oberfläche" src="_images/zettel-screen.png" />
<p class="caption"><span class="caption-text">Zettel Oberfläche</span><a class="headerlink" href="#id32" title="Permalink to this image">¶</a></p>
</div>
<p>Zettel verfügt über keine eigene Speicherschicht. Daten die über ein
Formular erzeugt wurden, werden in der HTTP-Response zurückgeliefert.
Zur Integration von Zettel in andere Applikationen wurde ein
Kommunikationspattern entwickelt, das auf Javascript beruht. Das
Zettel-Formular wird hierzu in einem IFrame in die Applikation
eingebunden. Die Applikation muss außerdem ein Javascript einbinden, das
auf bestimmte Nachrichten aus dem IFrame lauscht. Bei bestimmte Aktionen
sendet das Zettel-Formular dann Nachrichten an die Applikation und
erlaubt dieser darauf zu reagieren. Um Daten von Zettel in die
Applikation zu bekommen, werden diese im HTML-DOM gespeichert und können
von dort durch die Applikation entgegengenommen werden.</p>
<div class="figure align-default" id="id33">
<img alt="Zettel Datenfluss" src="_images/zettel-flos.png" />
<p class="caption"><span class="caption-text">Zettel Datenfluss</span><a class="headerlink" href="#id33" title="Permalink to this image">¶</a></p>
</div>
<div class="section" id="id4">
<h3>Konfiguration<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<table class="docutils align-default" id="id34">
<caption><span class="caption-text">Dateien im /conf Verzeichnis</span><a class="headerlink" href="#id34" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Datei</p></th>
<th class="head"><p>Beschreibung</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>application.conf</strong></p></td>
<td><p>Die Datei enthält einen Eintrag
zur Konfiguration von
<a class="reference external" href="#_etikett">Etikett</a>. Über
einen weiteren Eintrag können
“Hilfetexte” angelinkt werden.
Die Hilfetexte müssen in einer
statischen HTML abgelegt sein. Am
Ende der Datei werden einige
Limits deutlich über den Standard
erhöht, damit die großen
RDF-Posts auch funktionieren.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>collectionOne.csv</strong></p></td>
<td><p>Die Datei regelt den Inhalt eines
Combo-Box widgets mit id
collectionOne.</p></td>
</tr>
<tr class="row-even"><td><p><strong>ddc.csv</strong></p></td>
<td><p>Die Datei regelt den Inhalt eines
Combo-Box widgets mit id ddc.</p></td>
</tr>
<tr class="row-odd"><td><p>labels.json</p></td>
<td><p>Ein paar labels, falls keine
Instanz von
<a class="reference external" href="#_etikett">Etikett</a>
erreichbar ist.</p></td>
</tr>
<tr class="row-even"><td><p>logback.xml</p></td>
<td><p>Logger Konfiguration.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>professionalGroup.csv</strong></p></td>
<td><p>Die Datei regelt den Inhalt eines
Combo-Box widgets mit id
professionalGroup.</p></td>
</tr>
<tr class="row-even"><td><p>routes</p></td>
<td><p>Alle HTTP-Pfade übersichtlich in
einer Datei</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id5">
<h3>Die Applikation<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<table class="docutils align-default" id="id35">
<caption><span class="caption-text">Das /app Verzeichnis</span><a class="headerlink" href="#id35" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Package</p></th>
<th class="head"><p>Beschreibung</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>controllers</p></td>
<td><p>Es gibt nur einen Controller.
Hier ist sowohl die
Basisfunktionalität
implementiert, als auch die
Autocompletion-Endpunkte für die
unterschiedlichen Widgets. Die
Schnittstelle zu Abhandlung von
Formulardaten ist recht generisch
gehalten. Über eine ID wird das
entsprechende Formular aus dem
services.ZettelRegister geholt
und das zugehörige Formular wird
gerendert. Die Formular erhalten
dabei unterschiedliche Templates
(z.B. <code class="docutils literal notranslate"><span class="pre">views.Article</span></code>) und
unterschiedliche Modelklassen
(z.B. models.Article).</p></td>
</tr>
<tr class="row-odd"><td><p>models</p></td>
<td><p>Das Model “Article” heißt aus
historischen Gründen so.
Tatsächlich können mittlerweile
auch Kongressschriften und
Buchkapitel darüber abgebildet
werden (vermutlich wird sich der
Name nochmal ändern). Das Model
“Catalog” dient zum Import von
Daten aus dem Aleph-Katalog (über
Lobid). Mit ResearchData steht
ein prototypisches Model zur
Verarbeitung von Daten über
Forschungsdaten zur Verfügung.
Alle Models basieren auf einem
einzigen “fetten” ZettelModel.
Das ZettelModel enthält auch
Funktionen zur De/Serialisierung
in RDF und Json.</p></td>
</tr>
<tr class="row-even"><td><p>services</p></td>
<td><p>Hier werden verschiedene
Hilfsklassen versammelt. Die
Klasse ZettelFields enthält ein
Mapping zur RDF-Deserialisierung.</p></td>
</tr>
<tr class="row-odd"><td><p>views</p></td>
<td><p>Alle HTML-Sichten und die
eigentlichen Formulare.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="skos-lookup">
<h2>skos-lookup<a class="headerlink" href="#skos-lookup" title="Permalink to this headline">¶</a></h2>
<table class="docutils align-default" id="id36">
<caption><span class="caption-text">Überblick</span><a class="headerlink" href="#id36" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Source</p></td>
<td><p><a class="reference external" href="https://github.com/hbz/skos-lookup">skos-lookup</a></p></td>
</tr>
<tr class="row-even"><td><p>Technik</p></td>
<td><p><a class="reference external" href="https://www.playframework.com/documentation/2.5.x/JavaHome">Play Play
2.5
.8</a></p></td>
</tr>
<tr class="row-odd"><td><p>Ports</p></td>
<td><p>9004 / 9104</p></td>
</tr>
<tr class="row-even"><td><p>Verzeichnis</p></td>
<td><p>/opt/regal/apps/skos-lookup,
/opr/regal/src/skos-lookup</p></td>
</tr>
<tr class="row-odd"><td><p>HTTP Pfad</p></td>
<td><p>/tools/skos-lookup</p></td>
</tr>
</tbody>
</table>
<p><a class="reference external" href="#_skos_lookup">skos-lookup</a> dient zur Unterstützung von
<a class="reference external" href="#_zettel">Zettel</a>. Der Webservice startet eine eingebettete
Elasticsearch-Instanz und verfügt über eine Schnittstelle um SKOS-Daten
in separate Indexe zu importieren und Schnittstellen zur Unterstützung
von jQuery-Autocomplete- und Select2-Widgets aufzubauen. Auf diese Weise
können auch umfangreichere Thesauri und Notationssysteme in den
Formularen von <a class="reference external" href="#_zettel">Zettel</a> fachgerecht angelinkt werden.
<a class="reference external" href="#_skos_lookup">skos-lookup</a> unterstützt auch mehrsprachige Thesauri.</p>
<div class="figure align-default" id="id37">
<img alt="SKOS-Lookup Beispiel 1" src="_images/skos-lookup-autocomplete.png" />
<p class="caption"><span class="caption-text">SKOS-Lookup Beispiel 1</span><a class="headerlink" href="#id37" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id38">
<img alt="SKOS-Lookup Beispiel 2" src="_images/example-select2.png" />
<p class="caption"><span class="caption-text">SKOS-Lookup Beispiel 2</span><a class="headerlink" href="#id38" title="Permalink to this image">¶</a></p>
</div>
<div class="section" id="id6">
<h3>Konfiguration<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<table class="docutils align-default" id="id39">
<caption><span class="caption-text">Dateien im /conf Verzeichnis</span><a class="headerlink" href="#id39" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Datei</p></th>
<th class="head"><p>Beschreibung</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>application.conf</strong></p></td>
<td><p>Hier wird der interne
Elasticsearch-Index konfiguriert.
Auch werden einige
Speichereinstellungen erhöht.
Damit auch große SKOS-Dateien
geladen werden können, sollten
auch die Java-Opts erhöht werden.</p></td>
</tr>
<tr class="row-odd"><td><p>logback.xml</p></td>
<td><p>Logger Konfiguration</p></td>
</tr>
<tr class="row-even"><td><p>routes</p></td>
<td><p>Alle HTTP-Pfade übersichtlich in
einer Datei</p></td>
</tr>
<tr class="row-odd"><td><p>skos-context.json</p></td>
<td><p>Ein JSON-LD-Kontext zur
Umwandlung von RDF nach JSON.
(Origianl von: Jakob Voss)</p></td>
</tr>
<tr class="row-even"><td><p>skos-setting.json</p></td>
<td><p>Settings zur Konfiguration des
Elasticsearchindexse. (Original
von: Jörg Prante)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id7">
<h3>Die Applikation<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<table class="docutils align-default" id="id40">
<caption><span class="caption-text">Das /app Verzeichnis</span><a class="headerlink" href="#id40" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Package</p></th>
<th class="head"><p>Beschreibung</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>controllers</p></td>
<td><p>Alles in einem Controller. Die
API-Methoden liefern HTML und
JSON, so dass man sie aus dem
Browser, aber auch über andere
Tools ansprechen kann.</p></td>
</tr>
<tr class="row-odd"><td><p>elasticsearch</p></td>
<td><p>Eine embedded Elasticsearch. Dies
hat den Vorteil, dass man eine
aktuellere Version nutzen kann,
als z.B. die
<a class="reference external" href="#_regal_api_2">regal-api</a>.</p></td>
</tr>
<tr class="row-even"><td><p>services</p></td>
<td><p>Hilfsklassen zum Laden der Daten.</p></td>
</tr>
<tr class="row-odd"><td><p>views</p></td>
<td><p>Ein Formular um neue Daten in die
Applikation zu laden. Und ein
Beispielformular zur
Demonstration der Nutzung.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="thumby">
<h2>Thumby<a class="headerlink" href="#thumby" title="Permalink to this headline">¶</a></h2>
<table class="docutils align-default" id="id41">
<caption><span class="caption-text">Überblick</span><a class="headerlink" href="#id41" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Source</p></td>
<td><p><a href="#id56"><span class="problematic" id="id58">`thumby &lt;
https://github.com/hbz/thumby&gt;`__</span></a></p></td>
</tr>
<tr class="row-even"><td><p>Technik</p></td>
<td><p><a class="reference external" href="https://www.playframework.com/documentation/2.2.x/JavaHome">Play Play
2.2
.2</a></p></td>
</tr>
<tr class="row-odd"><td><p>Ports</p></td>
<td><p>9001 / 9101</p></td>
</tr>
<tr class="row-even"><td><p>Verzeichnis</p></td>
<td><p>/opt/regal/apps/thumby,
/opr/regal/src/thumby</p></td>
</tr>
<tr class="row-odd"><td><p>HTTP Pfad</p></td>
<td><p>/tools/thumby</p></td>
</tr>
</tbody>
</table>
<p><a class="reference external" href="#_thumby">Thumby</a> realisiert einen Thumbnail-Generator. Über ein
HTTP-GET wird <a class="reference external" href="#_thumby">Thumby</a> die URL eines PDFs, oder eines
Bildes übergeben. Sofern die <a class="reference external" href="#_thumby">Thumby</a> den Server kennt,
wird es versuchen ein Thumbnail der zurückgelieferten Daten zu
erstellen. Die Daten werden dauerhaft auf der Platte abgelegt und
zukünftige Requests, die auf dasselbe Bild verweisen werden direkt aus
dem Speicher von <a class="reference external" href="#_thumby">Thumby</a> beantwortet.</p>
<div class="section" id="id8">
<h3>Konfiguration<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<table class="docutils align-default" id="id42">
<caption><span class="caption-text">Dateien im /conf Verzeichnis</span><a class="headerlink" href="#id42" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Datei</p></th>
<th class="head"><p>Beschreibung</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>application.conf</strong></p></td>
<td><p>Hier wird eine Whitelist gesetzt.
Thumby verarbeitet nur URLs von
den hier angegebenen Quellen.
Hier wird auch der Pfad auf der
Platte gesetzt, unter dem Thumby
thumbnail-Daten ablegt.</p></td>
</tr>
<tr class="row-odd"><td><p>routes</p></td>
<td><p>Alle HTTP-Pfade übersichtlich in
einer Datei</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id9">
<h3>Die Applikation<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<table class="docutils align-default" id="id43">
<caption><span class="caption-text">Das /app Verzeichnis</span><a class="headerlink" href="#id43" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Package</p></th>
<th class="head"><p>Beschreibung</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>controllers</p></td>
<td><p>Der Controller realisiert eine
GET-Methode, über die Thumbnails
erzeugt und zurückgegeben werden.</p></td>
</tr>
<tr class="row-odd"><td><p>helper</p></td>
<td><p>Klassen zur Organisation des
Speichers und zur
Thumbnailgenerierung.</p></td>
</tr>
<tr class="row-even"><td><p>views</p></td>
<td><p>Es gibt eine Oberfläche mit einem
Upload-Formular.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="deepzoomer">
<h2>Deepzoomer<a class="headerlink" href="#deepzoomer" title="Permalink to this headline">¶</a></h2>
<table class="docutils align-default" id="id44">
<caption><span class="caption-text">Überblick</span><a class="headerlink" href="#id44" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Source</p></td>
<td><p><a class="reference external" href="https://github.com/hbz/DeepZoomService">DeepZoomService</a></p></td>
</tr>
<tr class="row-even"><td><p>Technik</p></td>
<td><p><a href="#id56"><span class="problematic" id="id59">`Servlet
2.3 &lt;
https://download.oracle.com/otn-p
ub/jcp/7840-servlet-2.3-spec-oth-
JSpec/servlet-2_3-fcs-spec.ps&gt;`__</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>Ports</p></td>
<td><p>9091 / 9191</p></td>
</tr>
<tr class="row-even"><td><p>Verzeichnis</p></td>
<td><p>/opt/regal/tomcat-for-deepzoom/,
/opr/regal/src/DeepZoomService</p></td>
</tr>
</tbody>
</table>
<p>Der [DeepZoomService] kann als WAR in einem Application-Server deployed
werden. Mit dem Deepzoomer können pyramidale Bilder erzeugt, gespeichert
und über eine OpenSeadragon-konforme Schnittstelle abgerufen werden. Auf
diese Weise kann in Regal eine Viewer-Komponente realisiert werden, die
die Anzeige sehr großer, hochaufgelöster Bilder im Webbrowser
unterstützt.</p>
<div class="section" id="id10">
<h3>Konfiguration<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h3>
<table class="docutils align-default" id="id45">
<caption><span class="caption-text">Dateien im /conf Verzeichnis</span><a class="headerlink" href="#id45" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Datei</p></th>
<th class="head"><p>Beschreibung</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>deepzoomer.cfgf</strong></p></td>
<td><p>Hier werden lokale Verzeichnisse,
aber auch die Server-URLs, unter
denen der Service öffentlich
abrufbar ist, gesetzt.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="regal-drupal">
<h2>regal-drupal<a class="headerlink" href="#regal-drupal" title="Permalink to this headline">¶</a></h2>
<table class="docutils align-default" id="id46">
<caption><span class="caption-text">Überblick</span><a class="headerlink" href="#id46" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Source</p></td>
<td><p><a class="reference external" href="https://github.com/edoweb/regal-drupal">regal-drupal</a></p></td>
</tr>
<tr class="row-even"><td><p>Technik</p></td>
<td><p><a class="reference external" href="https://www.php.net/manual/en/">PHP
5</a></p></td>
</tr>
<tr class="row-odd"><td><p>Ports</p></td>
<td><p>80 / 443</p></td>
</tr>
<tr class="row-even"><td><p>Verzeichnis</p></td>
<td><p>/opt/re
gal/var/drupal/sites/all/modules/</p></td>
</tr>
</tbody>
</table>
<p>Ein Drupal 7 Modul über das Funktionalitäten der
<a class="reference external" href="#_regal_api_2">regal-api</a> angesprochen werden können. Das Modul
bietet Oberflächen zur Konfiguration, zur Suche und zur Verwaltung von
Objekthierarchien.</p>
<div class="section" id="id11">
<h3>Die Applikation<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h3>
<table class="docutils align-default" id="id47">
<caption><span class="caption-text">Verzeichnisstruktur</span><a class="headerlink" href="#id47" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Verzeichnis</p></th>
<th class="head"><p>Beschreibung</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>edoweb</p></td>
<td><p>Hier ist der Code für die
Oberflächen.</p></td>
</tr>
<tr class="row-odd"><td><p>edoweb-field</p></td>
<td><p>Hier werden Felder für
unterschiedliche RDF-Properties
in der Drupal-Datenbank
konfiguriert. Der Code ist
größtenteils obsolet, da die
Feldlogik nicht mehr benutzt
wird.</p></td>
</tr>
<tr class="row-even"><td><p>edoweb_storage</p></td>
<td><p>Hier sind die Zugriffe auf
<a class="reference external" href="#_regal_api_2">regal-api</a> und
<a class="reference external" href="#_elasticsearch">???</a> zu
finden.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="edoweb-drupal-theme">
<h2>edoweb-drupal-theme<a class="headerlink" href="#edoweb-drupal-theme" title="Permalink to this headline">¶</a></h2>
<table class="docutils align-default" id="id48">
<caption><span class="caption-text">Überblick</span><a class="headerlink" href="#id48" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Source</p></td>
<td><p><a class="reference external" href="https://github.com/edoweb/edoweb-drupal-theme">edow
eb-drupal-theme</a></p></td>
</tr>
<tr class="row-even"><td><p>Technik</p></td>
<td><p><a class="reference external" href="https://www.php.net/manual/en/">PHP
5</a></p></td>
</tr>
<tr class="row-odd"><td><p>Ports</p></td>
<td><p>80 / 443</p></td>
</tr>
<tr class="row-even"><td><p>Verzeichnis</p></td>
<td><p>/opt/r
egal/var/drupal/sites/all/themes/</p></td>
</tr>
</tbody>
</table>
<p>Eine Reihe von Stylsheets, CSS, Icons zur Gestaltung einer Oberfläche
für den Server <a class="reference external" href="https://edoweb-rlp.de">https://edoweb-rlp.de</a></p>
</div>
<div class="section" id="zbmed-drupal-theme">
<h2>zbmed-drupal-theme<a class="headerlink" href="#zbmed-drupal-theme" title="Permalink to this headline">¶</a></h2>
<table class="docutils align-default" id="id49">
<caption><span class="caption-text">Überblick</span><a class="headerlink" href="#id49" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Source</p></td>
<td><p><a class="reference external" href="https://github.com/edoweb/zbmed-drupal-theme">zb
med-drupal-theme</a></p></td>
</tr>
<tr class="row-even"><td><p>Technik</p></td>
<td><p><a class="reference external" href="https://www.php.net/manual/en/">PHP
5</a></p></td>
</tr>
<tr class="row-odd"><td><p>Ports</p></td>
<td><p>80 / 443</p></td>
</tr>
<tr class="row-even"><td><p>Verzeichnis</p></td>
<td><p>/opt/r
egal/var/drupal/sites/all/themes/</p></td>
</tr>
</tbody>
</table>
<p>Eine Reihe von Stylsheets, CSS, Icons zur Gestaltung einer Oberfläche
für den Server <a class="reference external" href="https://repository.publisso.de">https://repository.publisso.de</a></p>
</div>
<div class="section" id="openwayback">
<h2>openwayback<a class="headerlink" href="#openwayback" title="Permalink to this headline">¶</a></h2>
<p>Repo: <a class="reference external" href="https://github.com/iipc/openwayback">https://github.com/iipc/openwayback</a> Servlet 2.5 .Überblick</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Source</p></td>
<td><p><a class="reference external" href="https://github.com/iipc/openwayback">openwayback</a></p></td>
</tr>
<tr class="row-even"><td><p>Technik</p></td>
<td><p><a class="reference external" href="https://download.oracle.com/otn-pub/jcp/servlet-2.5-mr5-oth-JSpec/servlet-2.5-mr5-spec.pdf">Servlet
2.5</a></p></td>
</tr>
<tr class="row-odd"><td><p>Ports</p></td>
<td><p>8091 / 8191</p></td>
</tr>
<tr class="row-even"><td><p>Verzeichnis</p></td>
<td><p>/o
pt/regal/tomcat-for-openwayback/,
/opr/regal/src/openwayback</p></td>
</tr>
</tbody>
</table>
<p><strong>Achtung</strong>: Es gibt einen am hbz entwickelten Branch. Dieser ist nicht
auf Github.</p>
<p>Openwayback ist eine Webapplikation die im ROOT Bereich eines Tomcats
installiert werden will. Sie kann Verzeichnisse mit WARC-Dateien
indexieren und darauf eine Oberfläche zur Recherche und zur Navigation
aufbauen.</p>
</div>
<div class="section" id="heritrix">
<h2>heritrix<a class="headerlink" href="#heritrix" title="Permalink to this headline">¶</a></h2>
<p>Heritrix ist ein Werkzeug zur Sammlung von Webseiten. Heritrix startet
standalone als Webapplikation und bietet eine Weboberfläche zur
Verwaltung von Sammelvorgängen an. Eingesammelte Webseiten werden als
WARC-Dateien in einem bestimmten Bereich der Platte abgelegt.</p>
</div>
<div class="section" id="wpull">
<h2>wpull<a class="headerlink" href="#wpull" title="Permalink to this headline">¶</a></h2>
<p>Wpull ist ein Kommandozeilen-Wermzeug zur Sammlung von Webseiten. Mit
WPull können WARC-Dateien erzeugt werden.</p>
</div>
<div class="section" id="fedora-commons-3">
<h2>Fedora Commons 3<a class="headerlink" href="#fedora-commons-3" title="Permalink to this headline">¶</a></h2>
<p>Fedora Commons 3 ist ein Repository-Framework. Für Regal wird vorallem
die Speicherschicht von Fedora Commons 3 benutzt. Fedora-Commons legt
alle Daten im Dateisystem (auch) ab. Mit den Daten aus dem Dateisystem
lässt sich eine komplette Fedora-Commons 3 Instanz von grundauf neu
aufbauen.</p>
</div>
<div class="section" id="mysql">
<h2>MySql<a class="headerlink" href="#mysql" title="Permalink to this headline">¶</a></h2>
<p>MySQL wir von Fedora, regal-api und etikett verwendet.</p>
</div>
<div class="section" id="elasticsearch-1-1">
<h2>Elasticsearch 1.1<a class="headerlink" href="#elasticsearch-1-1" title="Permalink to this headline">¶</a></h2>
<p>Elasticsearch ist eine Suchmaschine und wird von
<a class="reference external" href="#_regal_api_2">regal-api</a> verwendet. Auch
<a class="reference external" href="#_regal_drupal">regal-drupal</a> greift auf den Index zu.</p>
</div>
<div class="section" id="drupal-7">
<h2>Drupal 7<a class="headerlink" href="#drupal-7" title="Permalink to this headline">¶</a></h2>
<p>Über Drupal 7</p>
</div>
</div>
<div class="section" id="installation">
<h1>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="vagrant">
<h2>Vagrant<a class="headerlink" href="#vagrant" title="Permalink to this headline">¶</a></h2>
<p>Zur Veranschaulichung dieser Dokumentation wird ein Vagrant-Skript
angeboten, mit dem eine Regal-Installation innerhalb eines
VirtualBox-Images erzeugt werden kann.</p>
<p>Zur Installation kannst Du folgende Schritte ausführen. Die Kommandos
beziehen sich auf die Installation auf einem Ubuntu-System. Für andere
Betriebssyteme ist die Installation ähnlich.</p>
<p>Die VirtualBox hat folgendes Setup</p>
<ul class="simple">
<li><p>hdd 40GB</p></li>
<li><p>cpu 2core</p></li>
<li><p>ram 4096M</p></li>
</ul>
<div class="section" id="virtualbox-installieren">
<h3>VirtualBox installieren<a class="headerlink" href="#virtualbox-installieren" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">virtualbox</span>
</pre></div>
</div>
</div>
<div class="section" id="vagrant-installieren">
<h3>Vagrant installieren<a class="headerlink" href="#vagrant-installieren" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">/</span><span class="n">tmp</span>
<span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">releases</span><span class="o">.</span><span class="n">hashicorp</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">vagrant</span><span class="o">/</span><span class="mf">2.2</span><span class="o">.</span><span class="mi">3</span><span class="o">/</span><span class="n">vagrant_2</span><span class="o">.</span><span class="mf">2.3</span><span class="n">_x86_64</span><span class="o">.</span><span class="n">deb</span>
<span class="n">sudo</span> <span class="n">dpkg</span> <span class="o">-</span><span class="n">i</span> <span class="n">vagrant_2</span><span class="o">.</span><span class="mf">2.3</span><span class="n">_x86_64</span><span class="o">.</span><span class="n">deb</span>
</pre></div>
</div>
</div>
<div class="section" id="repository-herunterladen">
<h3>Repository herunterladen<a class="headerlink" href="#repository-herunterladen" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">jschnasse</span><span class="o">/</span><span class="n">Regal</span>
<span class="n">cd</span> <span class="n">Regal</span><span class="o">/</span><span class="n">vagrant</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">-</span><span class="mf">14.04</span>
</pre></div>
</div>
</div>
<div class="section" id="eine-jdk8-bereitstellen">
<h3>Eine JDK8 bereitstellen<a class="headerlink" href="#eine-jdk8-bereitstellen" title="Permalink to this headline">¶</a></h3>
<p>Hierfür bitte ein JDK8-Tarball herunterladen und unter dem Namen
<code class="docutils literal notranslate"><span class="pre">java8.tar.gz</span></code> in einem Verzeichnis <code class="docutils literal notranslate"><span class="pre">/bin</span></code> unterhalb des
Vagrant-Directories bereitstellen.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="nb">bin</span>
<span class="n">mv</span> <span class="o">~/</span><span class="n">downloads</span><span class="o">/</span><span class="n">jdk</span><span class="o">....</span> <span class="nb">bin</span><span class="o">/</span><span class="n">java8</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
</pre></div>
</div>
</div>
<div class="section" id="geteiltes-entwicklungsverzeichnis">
<h3>Geteiltes Entwicklungsverzeichnis<a class="headerlink" href="#geteiltes-entwicklungsverzeichnis" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="o">~/</span><span class="n">regal</span><span class="o">-</span><span class="n">dev</span>
</pre></div>
</div>
</div>
<div class="section" id="vagrant-guest-additions-installieren">
<h3>Vagrant Guest Additions installieren<a class="headerlink" href="#vagrant-guest-additions-installieren" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vagrant</span> <span class="n">plugin</span> <span class="n">install</span> <span class="n">vagrant</span><span class="o">-</span><span class="n">vbguest</span> <span class="o">&amp;&amp;</span> <span class="n">vagrant</span> <span class="n">reload</span>
</pre></div>
</div>
</div>
<div class="section" id="vagrant-host-anlegen">
<h3>Vagrant Host anlegen<a class="headerlink" href="#vagrant-host-anlegen" title="Permalink to this headline">¶</a></h3>
<p>Damit alle Dienste komfortabel erreichbar sind, muss in die lokale HOSTs
Datei ein Eintrag für die Vagrant-Box erfolgen. Im Vagrantfile ist die
IP <code class="docutils literal notranslate"><span class="pre">192.168.50.4</span></code> für die Box konfiguriert. Über die <code class="docutils literal notranslate"><span class="pre">FRONTEND</span></code> und
<code class="docutils literal notranslate"><span class="pre">BACKEND</span></code> Einträge in der <code class="docutils literal notranslate"><span class="pre">variables.conf</span></code> ist der Servername als
<code class="docutils literal notranslate"><span class="pre">regal.vagrant</span></code> definiert.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">printf</span> <span class="s2">&quot;192.168.50.4 regal.vagrant api.regal.vagrant&quot;</span> <span class="o">&gt;&gt;</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">hosts</span>
</pre></div>
</div>
</div>
<div class="section" id="vagrant-starten">
<h3>Vagrant starten<a class="headerlink" href="#vagrant-starten" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vagrant</span> <span class="n">up</span>
</pre></div>
</div>
</div>
<div class="section" id="auf-der-maschine-einloggen">
<h3>Auf der Maschine einloggen<a class="headerlink" href="#auf-der-maschine-einloggen" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vagrant</span> <span class="n">ssh</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="server">
<h2>Server<a class="headerlink" href="#server" title="Permalink to this headline">¶</a></h2>
<p>Die Installation auf einem Server kann mit Hilfe des mitgelieferten
Skriptes
<a class="reference external" href="https://github.com/jschnasse/Regal/blob/master/vagrant/ubuntu-14.04/regal-install.sh">regal-install.sh</a>
erfolgen. Dazu muss analog zur Vagrant-Installation zunächst das <code class="docutils literal notranslate"><span class="pre">bin</span></code>
Verzeichnis mit einem JDK aufgebaut werden. Danach erfolgt die
Installation unter <code class="docutils literal notranslate"><span class="pre">/opt/regal</span></code> und mit einem Benutzer <code class="docutils literal notranslate"><span class="pre">regal</span></code> (vgl.
<code class="docutils literal notranslate"><span class="pre">variables.conf</span></code>)</p>
<div class="section" id="hardware-empfehlung">
<h3>Hardware Empfehlung<a class="headerlink" href="#hardware-empfehlung" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>hdd &gt;500GB</p></li>
<li><p>cpu 8 core</p></li>
<li><p>ram 32 G</p></li>
</ul>
</div>
<div class="section" id="unterschiede-zur-vagrant-installation">
<h3>Unterschiede zur Vagrant Installation<a class="headerlink" href="#unterschiede-zur-vagrant-installation" title="Permalink to this headline">¶</a></h3>
<p>Auf dem Server empfehlen ich den fedora tomcat mit erweiterten
Speichereinstellungen zu betreiben.</p>
<p>Dazu in <code class="docutils literal notranslate"><span class="pre">/opt/regal/bin/fedora/tomcat/bin</span></code> eine <code class="docutils literal notranslate"><span class="pre">setenv.sh</span></code> anlegen
und folgende Zeilen hinein kopieren.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CATALINA_OPTS</span><span class="o">=</span><span class="s2">&quot; </span><span class="se">\</span>
<span class="s2">-Xms1536m </span><span class="se">\</span>
<span class="s2">-Xmx1536m </span><span class="se">\</span>
<span class="s2">-XX:NewSize=256m </span><span class="se">\</span>
<span class="s2">-XX:MaxNewSize=256m </span><span class="se">\</span>
<span class="s2">-XX:PermSize=256m </span><span class="se">\</span>
<span class="s2">-XX:MaxPermSize=256m </span><span class="se">\</span>
<span class="s2">-server </span><span class="se">\</span>
<span class="s2">-Djava.awt.headless=true </span><span class="se">\</span>
<span class="s2">-Dorg.apache.jasper.runtime.BodyContentImpl.LIMIT_BUFFER=true&quot;</span>

<span class="n">export</span> <span class="n">CATALINA_OPTS</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="entwicklung-java">
<h1>Entwicklung Java<a class="headerlink" href="#entwicklung-java" title="Permalink to this headline">¶</a></h1>
<div class="section" id="in-der-virtualbox">
<h2>In der VirtualBox<a class="headerlink" href="#in-der-virtualbox" title="Permalink to this headline">¶</a></h2>
<p>Hat man über <a class="reference external" href="#_vagrant">Vagrant</a> eine neue VirtualBox erzeugt und
alle Konfigurationen wie beschrieben vorgenommen, kann man die
VirtualBox zur Entwicklung nutzen. Da im Installationsprozess bereits
Eclipse-Projekte der unter <code class="docutils literal notranslate"><span class="pre">/opt/regal/src</span></code> befindlichen
Java-Applikationen erzeugt wurden, können die Projekte direkt aus dem
“synced folder” unter <code class="docutils literal notranslate"><span class="pre">~/regal-dev</span></code> in eine Eclipse-IDE auf dem
Host-System importiert werden.</p>
<p>Damit Änderungen am Code in der VirtualBox direkt sichtbar werden,
sollte die Applikation zunächst im Develop-Mode neu gestartet werden.
Dazu loggt man sich auf der VirtualBox mit <code class="docutils literal notranslate"><span class="pre">vagrant</span> <span class="pre">ssh</span></code> ein und
stoppt zunächst den entsprechenden Service, z.B.
<code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">service</span> <span class="pre">regal-api</span> <span class="pre">stop</span></code>. Anschließend navigiert man in das
Source-Verzeichnis, z.B. <code class="docutils literal notranslate"><span class="pre">cd</span> <span class="pre">/opt/regal/src/regal-api</span></code>. Hier startet
man die Applikation auf dem korrekten Port (im Zweifel unter
<code class="docutils literal notranslate"><span class="pre">/opt/regal/apps/regal-api/conf/application.conf</span></code> nachschauen). Der
Start im Develop-Mode erfolgt aus dem Verzeichnis der Applikation, mit
z.B. <code class="docutils literal notranslate"><span class="pre">/opt/regal/bin/activator/bin/activator</span> <span class="pre">-Dhttp.port=9100</span></code>. Danach
kann in die Kosole <code class="docutils literal notranslate"><span class="pre">run</span></code> eingegegeben werden. Die Applikation sollte
nun unter dem entsprechenden Port (im Beispiel: 9100) antworten.</p>
<p>Leider funktioniert das Reloading zwischen Host-System und
Guest-VirtualBox nicht richtig. D.h. nach Code-Änderungen im Host, muss
auf der Virtualbox zunächst mit <code class="docutils literal notranslate"><span class="pre">Ctrl+D</span></code> und <code class="docutils literal notranslate"><span class="pre">run</span></code> neu gestartet
werden, damit die Änderungen sichtbar werden.</p>
</div>
<div class="section" id="auf-dem-eigenen-system">
<h2>Auf dem eigenen System<a class="headerlink" href="#auf-dem-eigenen-system" title="Permalink to this headline">¶</a></h2>
<p>Die Javakomponenten können problemlos auch auf einem aktuellen
Ubuntusystem entwickelt werden. Leider läuft die
PHP/Drupal-Implementierung nicht unter neueren Ubuntusystemen. Für die
lokale installation können die entsprechenden Funktionen aus dem
<code class="docutils literal notranslate"><span class="pre">regal-install.sh</span></code> ausgeführt werden. Dazu einfach eine Kopie anlegen,
entsprechend editieren und ausführen.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="n">regal</span><span class="o">-</span><span class="n">install</span>
<span class="n">cp</span> <span class="o">-</span><span class="n">r</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">Regal</span><span class="o">/</span><span class="n">vagrant</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">-</span><span class="n">XX</span><span class="o">/*</span> <span class="n">regal</span><span class="o">-</span><span class="n">install</span>
<span class="n">cd</span> <span class="n">regal</span><span class="o">-</span><span class="n">install</span>
<span class="c1"># Edit system user &quot;vagrant&quot; --&gt; &quot;your user&quot;</span>
<span class="n">editor</span> <span class="n">variables</span><span class="o">.</span><span class="n">conf</span>
<span class="c1"># put drupal stuff in comments</span>
<span class="c1">#</span>
<span class="c1">#  #installDrush</span>
<span class="c1">#  #installDrupal</span>
<span class="c1">#  #installRegalDrupal</span>
<span class="c1">#  #installDrupalThemes</span>
<span class="c1">#  #configureDrupalLanguages</span>
<span class="c1">#  #configureDrupal</span>
<span class="c1">#</span>
<span class="n">editor</span> <span class="n">regal</span><span class="o">-</span><span class="n">install</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="administration">
<h1>Administration<a class="headerlink" href="#administration" title="Permalink to this headline">¶</a></h1>
<div class="section" id="aktualisierung">
<h2>Aktualisierung<a class="headerlink" href="#aktualisierung" title="Permalink to this headline">¶</a></h2>
<div class="section" id="play-applikationen">
<h3>Play-Applikationen<a class="headerlink" href="#play-applikationen" title="Permalink to this headline">¶</a></h3>
<p>Die Aktualisierung der Regal-Komponenten erfolgt über Skripte. Die
Aktualisierung funktioniert dabei so, dass der Quellcode der zu
aktualisierenden Komponente unter <code class="docutils literal notranslate"><span class="pre">/opt/regal/src</span></code> per <code class="docutils literal notranslate"><span class="pre">git</span></code> auf den
entsprechenden Branch gestellt wird. Danach wird ein neues Kompilat der
Komponente erzeugt. Die aktuelle Konfiguration wird aus
<code class="docutils literal notranslate"><span class="pre">/opt/regal/conf</span></code> genommen und es wird unter <code class="docutils literal notranslate"><span class="pre">/opt/regal/apps</span></code> eine
neue lauffähige Version abgelegt.</p>
<p>Neue Versionen werden immer parallel zu alten Versionen gestartet und
über einen Wechsel der Apachekonfiguration aktiviert. Erst danach wird
die alte Version heruntergefahren.</p>
<p>Der komplette Aktualisierungsprozess erfolgt automatisch. Die alte
Version bleibt immer auf dem Server liegen, so dass bei Bedarf wieder
zurück gewechselt werden kann.</p>
</div>
<div class="section" id="tomcat-applikation">
<h3>Tomcat-Applikation<a class="headerlink" href="#tomcat-applikation" title="Permalink to this headline">¶</a></h3>
<p>Es wird ein <code class="docutils literal notranslate"><span class="pre">war</span></code>-Container erzeugt und im Tomcat <code class="docutils literal notranslate"><span class="pre">hot</span></code>-deployed.</p>
</div>
<div class="section" id="drupal-module">
<h3>Drupal-Module<a class="headerlink" href="#drupal-module" title="Permalink to this headline">¶</a></h3>
<p>Beinhaltet die Aktualisierung ein Datenbankupdate, so wird Drupal erst
in den Wartungszustand versetzt (per drush oder über die Oberfläche).
Danach wird die aktualisierte Version einfach per Git geholt. Bei
Datenbankupdates wird noch ein Drupal-Updateskript ausgeführt.</p>
</div>
<div class="section" id="speicherschicht">
<h3>Speicherschicht<a class="headerlink" href="#speicherschicht" title="Permalink to this headline">¶</a></h3>
<p>Aktualisierungen von MySQL, Elasticsearch und Fedora gehen mit einer
Downtime einher.</p>
</div>
</div>
<div class="section" id="verzeichnisse">
<h2>Verzeichnisse<a class="headerlink" href="#verzeichnisse" title="Permalink to this headline">¶</a></h2>
<table class="docutils align-default" id="id50">
<caption><span class="caption-text">Verzeichnisstruktur</span><a class="headerlink" href="#id50" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Verzeichnis</p></th>
<th class="head"><p>Beschreibung</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>/opt/regal</p></td>
<td><p>Außer Apache2, Elasticsearch und
MySQL befinden sich alle
Regal-Komponenten unter diesem
Verzeichnis.</p></td>
</tr>
<tr class="row-odd"><td><p>/opt/regal/apps</p></td>
<td><p>Die auf <code class="docutils literal notranslate"><span class="pre">Play</span></code> beruhenden
Komponenten:
<code class="docutils literal notranslate"><span class="pre">etikett</span>&#160; <span class="pre">fedora</span>&#160; <span class="pre">regal-a</span>
<span class="pre">pi</span>&#160; <span class="pre">skos-lookup</span>&#160; <span class="pre">thumby</span>&#160; <span class="pre">zettel</span></code></p></td>
</tr>
<tr class="row-even"><td><p>/opt/regal/bin</p></td>
<td><p>Fremdpakete wie activator,
fedora, heritrix, python -
weitere tomcats.</p></td>
</tr>
<tr class="row-odd"><td><p>/opt/regal/conf</p></td>
<td><p>Die variables.conf und die
application.conf wird von
verschiedenen Komponenten
verwendet.</p></td>
</tr>
<tr class="row-even"><td><p>/opt/regal/logs</p></td>
<td><p>Logfiles der Skripte und Cronjobs</p></td>
</tr>
<tr class="row-odd"><td><p>/opt/regal/src</p></td>
<td><p>Alle Eigenentwicklungen oder im
Quellcode modifizierten
Komponenten.</p></td>
</tr>
<tr class="row-even"><td><p>/opt/regal/var</p></td>
<td><p>drupal und Datenverzeichnisse.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="ports">
<h2>Ports<a class="headerlink" href="#ports" title="Permalink to this headline">¶</a></h2>
<table class="docutils align-default" id="id51">
<caption><span class="caption-text">Ports und Komponenten (typische Belegung)</span><a class="headerlink" href="#id51" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Port</p></th>
<th class="head"><p>Komponente</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>80 /443</p></td>
<td><p>Apache 2</p></td>
</tr>
<tr class="row-odd"><td><p>8080</p></td>
<td><p>fedora tomcat</p></td>
</tr>
<tr class="row-even"><td><p>9090</p></td>
<td><p>openwayback tomcat</p></td>
</tr>
<tr class="row-odd"><td><p>9200</p></td>
<td><p>elasticsearch</p></td>
</tr>
<tr class="row-even"><td><p>9000/9100</p></td>
<td><p>regal-api</p></td>
</tr>
<tr class="row-odd"><td><p>9001/9101</p></td>
<td><p>thumby</p></td>
</tr>
<tr class="row-even"><td><p>9002/9102</p></td>
<td><p>etikett</p></td>
</tr>
<tr class="row-odd"><td><p>9003/9103</p></td>
<td><p>zettel</p></td>
</tr>
<tr class="row-even"><td><p>9004/9104</p></td>
<td><p>skos-lookup</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="logs">
<h2>Logs<a class="headerlink" href="#logs" title="Permalink to this headline">¶</a></h2>
<table class="docutils align-default" id="id52">
<caption><span class="caption-text">Logfiles</span><a class="headerlink" href="#id52" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Komponente</p></th>
<th class="head"><p>Pfad</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Apache</p></td>
<td><p>/var/log/apache2</p></td>
</tr>
<tr class="row-odd"><td><p>Tomcat</p></td>
<td><p>/opt/regal/bin/fedora/tomcat/logs</p></td>
</tr>
<tr class="row-even"><td><p>Fedora</p></td>
<td><p>/opt/regal/bin/fedora/server/logs</p></td>
</tr>
<tr class="row-odd"><td><p>Elasticsearch</p></td>
<td><p>/var/log/elasticsearch</p></td>
</tr>
<tr class="row-even"><td><p>regal-api</p></td>
<td><p>/opt/regal/apps/regal-api/logs</p></td>
</tr>
<tr class="row-odd"><td><p>drupal</p></td>
<td><p>/var/log/apache2 #otherhosts !
und/var/log/apache2/error.log
(hier ist auch die Debugausgabe)</p></td>
</tr>
<tr class="row-even"><td><p>MySql</p></td>
<td><p>/var/log/mysql</p></td>
</tr>
<tr class="row-odd"><td><p>monit</p></td>
<td><p>/var/log/monit.log</p></td>
</tr>
<tr class="row-even"><td><p>regal-scripts</p></td>
<td><p>/opt/regal/logs</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="configs">
<h2>Configs<a class="headerlink" href="#configs" title="Permalink to this headline">¶</a></h2>
<table class="docutils align-default" id="id53">
<caption><span class="caption-text">Configfiles</span><a class="headerlink" href="#id53" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Komponente</p></th>
<th class="head"><p>Pfad</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Apache</p></td>
<td><p>/etc/apache2/sites-enabled</p></td>
</tr>
<tr class="row-odd"><td><p>Tomcat</p></td>
<td><p>/opt/regal/bin/fedora/tomcat/conf</p></td>
</tr>
<tr class="row-even"><td><p>Fedora</p></td>
<td><p>/opt/regal/bin/fedora/server/conf</p></td>
</tr>
<tr class="row-odd"><td><p>Elasticsearch</p></td>
<td><p>/etc/elasticsearch</p></td>
</tr>
<tr class="row-even"><td><p>regal-api</p></td>
<td><p>/opt/regal/conf enthält
Konfigurationsvorschläge des
Installers</p></td>
</tr>
<tr class="row-odd"><td><p>regal-api</p></td>
<td><p>/opt/regal/apps/regal-api/conf</p></td>
</tr>
<tr class="row-even"><td><p>drupal</p></td>
<td><p>Konfig kann gut mit dem Tool
drush überwacht werden</p></td>
</tr>
<tr class="row-odd"><td><p>Elasticsearch Plugins</p></td>
<td><p>/etc/elasticsearch</p></td>
</tr>
<tr class="row-even"><td><p>oai-pmh</p></td>
<td><p>/opt/regal/
bin/fedora/tomcat/webapps/dnb-unr
/WEB-INF/classes/proai.properties</p></td>
</tr>
<tr class="row-odd"><td><p>monit</p></td>
<td><p>/etc/monit</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="apache2">
<h2>Apache2<a class="headerlink" href="#apache2" title="Permalink to this headline">¶</a></h2>
<table class="docutils align-default" id="id54">
<caption><span class="caption-text">Frontend Pfade</span><a class="headerlink" href="#id54" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Komponente</p></th>
<th class="head"><p>HTTP-Pfad</p></th>
<th class="head"><p>Lokaler Pfad/Proxy</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Drupal</p></td>
<td><p>/</p></td>
<td><p>/opt/regal/var/drupal</p></td>
</tr>
<tr class="row-odd"><td><p>Alte Importe von
Webarchiven</p></td>
<td><p>/webharvests</p></td>
<td><p>/data/webharvests</p></td>
</tr>
<tr class="row-even"><td><p>Täglich generierte
Datei mit Kennziffern</p></td>
<td><p>/crawlreports</p></td>
<td><p>/o
pt/regal/crawlreports</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id55">
<caption><span class="caption-text">API Pfade</span><a class="headerlink" href="#id55" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Komponente</p></th>
<th class="head"><p>HTTP-Pfad</p></th>
<th class="head"><p>Lokaler Pfad/Proxy</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Über wget erstellte
Webarchive</p></td>
<td><p>/wget-data</p></td>
<td><p>/op
t/regal/var/wget-data</p></td>
</tr>
<tr class="row-odd"><td><p>Über wpull erstellte
Webarchive</p></td>
<td><p>/wpull-data</p></td>
<td><p>/opt
/regal/var/wpull-data</p></td>
</tr>
<tr class="row-even"><td><p>Über heritrix
erstellte Webarchive</p></td>
<td><p>/heritrix-data</p></td>
<td><p>/opt/re
gal/var/heritrix-data</p></td>
</tr>
<tr class="row-odd"><td><p>OAI-Schnittstelle für
die DNB</p></td>
<td><p>/dnb-urn</p></td>
<td><p><a class="reference external" href="http://loc">http://loc</a>
alhost:8080/dnb-urn$1</p></td>
</tr>
<tr class="row-even"><td><p>OAI-Schnittstelle</p></td>
<td><p>/oai-pmh</p></td>
<td><p><a class="reference external" href="http://loc">http://loc</a>
alhost:8080/oai-pmh$1</p></td>
</tr>
<tr class="row-odd"><td><p>Deepzoomer</p></td>
<td><p>/deepzoom</p></td>
<td><p><a class="reference external" href="http://loca">http://loca</a>
lhost:7080/deepzoom$1</p></td>
</tr>
<tr class="row-even"><td><p>Openwayback privat</p></td>
<td><p>/wayback</p></td>
<td><p><a class="reference external" href="http://l">http://l</a>
ocalhost:9080/wayback</p></td>
</tr>
<tr class="row-odd"><td><p>Openwayback
öffentlich</p></td>
<td><p>/weltweit</p></td>
<td><p><a class="reference external" href="http://lo">http://lo</a>
calhost:9080/weltweit</p></td>
</tr>
<tr class="row-even"><td><p>Thumby</p></td>
<td><p>/tools/thumby</p></td>
<td><p><a class="reference external" href="http://localh">http://localh</a>
ost:9001/tools/thumby</p></td>
</tr>
<tr class="row-odd"><td><p>Etikett</p></td>
<td><p>/tools/etikett</p></td>
<td><p><a class="reference external" href="http://localho">http://localho</a>
st:9002/tools/etikett</p></td>
</tr>
<tr class="row-even"><td><p>Zettel</p></td>
<td><p>/tools/zettel</p></td>
<td><p><a class="reference external" href="http://localh">http://localh</a>
ost:9004/tools/zettel</p></td>
</tr>
<tr class="row-odd"><td><p>Elasticsearch GET</p></td>
<td><p>/search</p></td>
<td><p><a class="reference external" href="http://localhost:9200">http://localhost:9200</a></p></td>
</tr>
<tr class="row-even"><td><p>Fedora</p></td>
<td><p>/fedora</p></td>
<td><p><a class="reference external" href="http://">http://</a>
localhost:8080/fedora</p></td>
</tr>
<tr class="row-odd"><td><p>JSON-LD Context</p></td>
<td><p>/
public/resources.json</p></td>
<td><p><a class="reference external" href="http:/">http:/</a>
/localhost:9002/tools
/etikett/context.json</p></td>
</tr>
<tr class="row-even"><td><p>regal-api</p></td>
<td><p>/</p></td>
<td><p>h
ttp://localhost:9000/</p></td>
</tr>
<tr class="row-odd"><td><p>heritrix</p></td>
<td><p>/tools/heritrix</p></td>
<td><p><a class="reference external" href="https://localhos">https://localhos</a>
t:8443/tools/heritrix</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="matomo">
<h2>Matomo<a class="headerlink" href="#matomo" title="Permalink to this headline">¶</a></h2>
<p>Matomo wird einmal täglich per Cronjob mit Apache-Logfiles befüllt.
Dabei erfolgt eine Anonymisierung. Die Logfiles verbleiben noch sieben
Tage auf dem Server und werden dann annoynmisiert.</p>
</div>
<div class="section" id="monit">
<h2>Monit<a class="headerlink" href="#monit" title="Permalink to this headline">¶</a></h2>
<p>Das Tool Monit erlaubt es, den Status der Regal-Komponenten zu
überwachen und Dienste ggfl. neu zu starten. Folgende Einträge können in
/etc/monit/monitrc vorgenommen werden</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">check</span> <span class="n">process</span> <span class="n">apache</span> <span class="k">with</span> <span class="n">pidfile</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">apache2</span><span class="o">/</span><span class="n">apache2</span><span class="o">.</span><span class="n">pid</span>
    <span class="n">start</span> <span class="n">program</span> <span class="o">=</span> <span class="s2">&quot;/etc/init.d/apache2 start&quot;</span> <span class="k">with</span> <span class="n">timeout</span> <span class="mi">60</span> <span class="n">seconds</span>
    <span class="n">stop</span> <span class="n">program</span>  <span class="o">=</span> <span class="s2">&quot;/etc/init.d/apache2 stop&quot;</span>

<span class="n">check</span> <span class="n">process</span> <span class="n">regal</span><span class="o">-</span><span class="n">api</span> <span class="k">with</span> <span class="n">pidfile</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">apps</span><span class="o">/</span><span class="n">regal</span><span class="o">-</span><span class="n">api</span><span class="o">/</span><span class="n">RUNNING_PID</span>
     <span class="n">start</span> <span class="n">program</span> <span class="o">=</span> <span class="s2">&quot;/etc/init.d/regal-api start&quot;</span> <span class="k">with</span> <span class="n">timeout</span> <span class="mi">60</span> <span class="n">seconds</span>
     <span class="n">stop</span> <span class="n">program</span> <span class="o">=</span> <span class="s2">&quot;/etc/init.d/regal-api stop&quot;</span>

<span class="n">check</span> <span class="n">process</span> <span class="n">tomcat6</span> <span class="k">with</span> <span class="n">pidfile</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">tomcat6</span><span class="o">.</span><span class="n">pid</span>
     <span class="n">start</span> <span class="n">program</span> <span class="o">=</span> <span class="s2">&quot;/etc/init.d/tomcat6 start&quot;</span> <span class="k">with</span> <span class="n">timeout</span> <span class="mi">60</span> <span class="n">seconds</span>
     <span class="n">stop</span> <span class="n">program</span> <span class="o">=</span> <span class="s2">&quot;/etc/init.d/regal-api stop&quot;</span>

<span class="n">check</span> <span class="n">process</span> <span class="n">elasticsearch</span> <span class="k">with</span> <span class="n">pidfile</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">elasticsearch</span><span class="o">.</span><span class="n">pid</span>
     <span class="n">start</span> <span class="n">program</span> <span class="o">=</span> <span class="s2">&quot;/etc/init.d/elasticsearch start&quot;</span> <span class="k">with</span> <span class="n">timeout</span> <span class="mi">60</span> <span class="n">seconds</span>
     <span class="n">stop</span> <span class="n">program</span> <span class="o">=</span> <span class="s2">&quot;/etc/init.d/elasticsearch stop&quot;</span>

<span class="n">check</span> <span class="n">process</span> <span class="n">thumby</span> <span class="k">with</span> <span class="n">pidfile</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">apps</span><span class="o">/</span><span class="n">thumby</span><span class="o">/</span><span class="n">RUNNING_PID</span>
     <span class="n">start</span> <span class="n">program</span> <span class="o">=</span> <span class="s2">&quot;/etc/init.d/thumby start&quot;</span> <span class="k">with</span> <span class="n">timeout</span> <span class="mi">60</span> <span class="n">seconds</span>
     <span class="n">stop</span> <span class="n">program</span> <span class="o">=</span> <span class="s2">&quot;/etc/init.d/thumby stop&quot;</span>

<span class="n">check</span> <span class="n">process</span> <span class="n">etikett</span> <span class="k">with</span> <span class="n">pidfile</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">apps</span><span class="o">/</span><span class="n">etikett</span><span class="o">/</span><span class="n">RUNNING_PID</span>
     <span class="n">start</span> <span class="n">program</span> <span class="o">=</span> <span class="s2">&quot;/etc/init.d/etikett start&quot;</span> <span class="k">with</span> <span class="n">timeout</span> <span class="mi">60</span> <span class="n">seconds</span>
     <span class="n">stop</span> <span class="n">program</span> <span class="o">=</span> <span class="s2">&quot;/etc/init.d/etikett stop&quot;</span>

<span class="n">check</span> <span class="n">process</span> <span class="n">zettel</span> <span class="k">with</span> <span class="n">pidfile</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">apps</span><span class="o">/</span><span class="n">zettel</span><span class="o">/</span><span class="n">RUNNING_PID</span>
     <span class="n">start</span> <span class="n">program</span> <span class="o">=</span> <span class="s2">&quot;/etc/init.d/zettel start&quot;</span> <span class="k">with</span> <span class="n">timeout</span> <span class="mi">60</span> <span class="n">seconds</span>
     <span class="n">stop</span> <span class="n">program</span> <span class="o">=</span> <span class="s2">&quot;/etc/init.d/zettel stop&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="scripts-und-cronjobs">
<h2>Scripts und Cronjobs<a class="headerlink" href="#scripts-und-cronjobs" title="Permalink to this headline">¶</a></h2>
<p>Für das Funktionieren von Regal sind einige regal-scripts sinnvoll. Die
Skripte sind sämtlich unter Github zu finden.</p>
<p><a class="reference external" href="https://github.com/edoweb/regal-scripts">https://github.com/edoweb/regal-scripts</a></p>
<p>Die folgenden Abschnitte zeigen ein typisches Setup.</p>
<div class="section" id="id12">
<h3>OAI-Providing<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h3>
<p>Der OAI-Provider läuft nicht die ganze Zeit mit, da dies Probleme
gemacht hat. Er wird nur für einen bestimmten Zeitraum angestellt und
dann wieder ausgestellt. Auf diese Weise liefert die OAI-Schnittstelle
tagesaktuelle Daten.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span> <span class="mi">2</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">regal</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">turnOnOaiPmhPolling</span><span class="o">.</span><span class="n">sh</span>
<span class="mi">0</span> <span class="mi">5</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">regal</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">turnOffOaiPmhPolling</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
</div>
<div class="section" id="urn-registrierung">
<h3>URN-Registrierung<a class="headerlink" href="#urn-registrierung" title="Permalink to this headline">¶</a></h3>
<p>Die URN-Registrierung erfolgt mit einem gewissen Verzug. Das dafür
zuständige Skript überprüft daher zunächst das Anlagedatum der
Ressource.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">05</span> <span class="mi">7</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">regal</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">register_urn</span><span class="o">.</span><span class="n">sh</span> <span class="n">control</span>  <span class="o">&gt;&gt;</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">regal</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">control_urn_vergabe</span><span class="o">.</span><span class="n">log</span>
<span class="mi">1</span> <span class="mi">1</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">regal</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">register_urn</span><span class="o">.</span><span class="n">sh</span> <span class="n">katalog</span> <span class="o">&gt;&gt;</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">regal</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">katalog_update</span><span class="o">.</span><span class="n">log</span>
<span class="mi">1</span> <span class="mi">0</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">regal</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">register_urn</span><span class="o">.</span><span class="n">sh</span> <span class="n">register</span> <span class="o">&gt;&gt;</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">regal</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">register_urn</span><span class="o">.</span><span class="n">log</span>
</pre></div>
</div>
</div>
<div class="section" id="katalog-aktualisierung">
<h3>Katalog-Aktualisierung<a class="headerlink" href="#katalog-aktualisierung" title="Permalink to this headline">¶</a></h3>
<p>Das System gleicht einmal am Tag Metadaten mit dem hbz-Verbundkatalog ab
und führt ggf. Aktualisierungen durch.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span> <span class="mi">5</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">regal</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">updateAll</span><span class="o">.</span><span class="n">sh</span> <span class="o">&gt;</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">null</span>
</pre></div>
</div>
</div>
<div class="section" id="id13">
<h3>Matomo<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h3>
<p>Matomo wird mit Apache-Logfiles befüllt. Innerhalb von Matomo werden die
Einträge annonymisiert.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span> <span class="mi">1</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">regal</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">import</span><span class="o">-</span><span class="n">logfiles</span><span class="o">.</span><span class="n">sh</span> <span class="o">&gt;/</span><span class="n">dev</span><span class="o">/</span><span class="n">null</span>
</pre></div>
</div>
</div>
<div class="section" id="logfile-annonymisierung">
<h3>Logfile Annonymisierung<a class="headerlink" href="#logfile-annonymisierung" title="Permalink to this headline">¶</a></h3>
<p>Apache-Logfiles werden sieben Tage unverändert aufbewahrt. Danach
erfolgt eine Annonymisierung.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span> <span class="mi">2</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">regal</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">depersonalize</span><span class="o">-</span><span class="n">apache</span><span class="o">-</span><span class="n">logs</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
</div>
<div class="section" id="webgatherer">
<h3>Webgatherer<a class="headerlink" href="#webgatherer" title="Permalink to this headline">¶</a></h3>
<p>Der Webgatherer prüft Archivierungsintervalle von Webpages und stößt bei
Bedarf die Erzeugung eines neuen Snapshots/Version an.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span> <span class="mi">20</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">regal</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">runGatherer</span><span class="o">.</span><span class="n">sh</span> <span class="o">&gt;&gt;</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">regal</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">runGatherer</span><span class="o">.</span><span class="n">log</span>
<span class="c1"># Auswertung des letzten Webgatherer-Laufs</span>
<span class="mi">0</span> <span class="mi">21</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">regal</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">evalWebgatherer</span><span class="o">.</span><span class="n">sh</span> <span class="o">&gt;&gt;</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">regal</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">runGatherer</span><span class="o">.</span><span class="n">log</span>
<span class="c1"># Crawl Reports</span>
<span class="mi">0</span> <span class="mi">22</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">regal</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">crawlReport</span><span class="o">.</span><span class="n">sh</span> <span class="o">&gt;&gt;</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">logs</span><span class="o">/</span><span class="n">crawlReport</span><span class="o">.</span><span class="n">log</span>
</pre></div>
</div>
</div>
<div class="section" id="backup">
<h3>Backup<a class="headerlink" href="#backup" title="Permalink to this headline">¶</a></h3>
<p>MySQL und Elasticsearch</p>
<p>Der Elasticsearch-Index und die MySQL-Datenbanken werden täglich
gesichert. Es werden Backups der letzten 30 Tage aufbewahrt. Ältere
Backups werden von der Platte gelöscht.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span> <span class="mi">2</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">regal</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">backup</span><span class="o">-</span><span class="n">es</span><span class="o">.</span><span class="n">sh</span> <span class="o">-</span><span class="n">c</span> <span class="o">&gt;&gt;</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">logs</span><span class="o">/</span><span class="n">backup</span><span class="o">-</span><span class="n">es</span><span class="o">.</span><span class="n">log</span> <span class="mi">2</span><span class="o">&gt;&amp;</span><span class="mi">1</span>
<span class="mi">30</span> <span class="mi">2</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">regal</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">backup</span><span class="o">-</span><span class="n">es</span><span class="o">.</span><span class="n">sh</span> <span class="o">-</span><span class="n">b</span> <span class="o">&gt;&gt;</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">logs</span><span class="o">/</span><span class="n">backup</span><span class="o">-</span><span class="n">es</span><span class="o">.</span><span class="n">log</span> <span class="mi">2</span><span class="o">&gt;&amp;</span><span class="mi">1</span>
<span class="mi">0</span> <span class="mi">2</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">regal</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">backup</span><span class="o">-</span><span class="n">db</span><span class="o">.</span><span class="n">sh</span> <span class="o">-</span><span class="n">c</span> <span class="o">&gt;&gt;</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">logs</span><span class="o">/</span><span class="n">backup</span><span class="o">-</span><span class="n">db</span><span class="o">.</span><span class="n">log</span> <span class="mi">2</span><span class="o">&gt;&amp;</span><span class="mi">1</span>
<span class="mi">30</span> <span class="mi">2</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">regal</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">backup</span><span class="o">-</span><span class="n">db</span><span class="o">.</span><span class="n">sh</span> <span class="o">-</span><span class="n">b</span> <span class="o">&gt;&gt;</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">logs</span><span class="o">/</span><span class="n">backup</span><span class="o">-</span><span class="n">db</span><span class="o">.</span><span class="n">log</span> <span class="mi">2</span><span class="o">&gt;&amp;</span><span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="section" id="entwicklung">
<h3>Entwicklung<a class="headerlink" href="#entwicklung" title="Permalink to this headline">¶</a></h3>
<p>Für die Entwicklung an Regal empfiehlt sich folgende Vorgehensweise…</p>
</div>
</div>
</div>
<div class="section" id="dokumentation">
<h1>Dokumentation<a class="headerlink" href="#dokumentation" title="Permalink to this headline">¶</a></h1>
<p>Diese Dokumentation ist mit asciidoc geschrieben und wurde mit
asciidoctor in HTML übersetzt. Dazu wurde das foundation.css Stylesheet
aus dem asciidoctor-stylesheet-factory Repository verwendet.</p>
<p>Die Schritte, um an der Doku zu arbeiten sind folgenden</p>
<div class="section" id="dieses-repo-herunterladen">
<h2>Dieses Repo herunterladen<a class="headerlink" href="#dieses-repo-herunterladen" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">hbz</span><span class="o">/</span><span class="n">to</span><span class="o">.</span><span class="n">science</span>
</pre></div>
</div>
</div>
<div class="section" id="asciidoctor-und-asciidoctor-stylesheets-installieren">
<h2>Asciidoctor und Asciidoctor-Stylesheets installieren<a class="headerlink" href="#asciidoctor-und-asciidoctor-stylesheets-installieren" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gpg</span> <span class="o">--</span><span class="n">keyserver</span> <span class="n">hkp</span><span class="p">:</span><span class="o">//</span><span class="n">pool</span><span class="o">.</span><span class="n">sks</span><span class="o">-</span><span class="n">keyservers</span><span class="o">.</span><span class="n">net</span> <span class="o">--</span><span class="n">recv</span><span class="o">-</span><span class="n">keys</span> <span class="mi">409</span><span class="n">B6B1796C275462A1703113804BB82D39DC0E3</span> <span class="mi">7</span><span class="n">D2BAF1CF37B13E2069D6956105BD0E739499BDB</span>
\<span class="n">curl</span> <span class="o">-</span><span class="n">sSL</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">get</span><span class="o">.</span><span class="n">rvm</span><span class="o">.</span><span class="n">io</span> <span class="o">|</span> <span class="n">sudo</span> <span class="n">bash</span> <span class="o">-</span><span class="n">s</span> <span class="n">stable</span> <span class="o">--</span><span class="n">ruby</span>
<span class="c1">#login again</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">bundler</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">gem</span>
<span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">asciidoctor</span><span class="o">/</span><span class="n">asciidoctor</span>
<span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">asciidoctor</span><span class="o">/</span><span class="n">asciidoctor</span><span class="o">-</span><span class="n">stylesheet</span><span class="o">-</span><span class="n">factory</span>
<span class="n">cd</span> <span class="n">asciidoctor</span>
<span class="n">sudo</span> <span class="n">gem</span> <span class="n">install</span> <span class="n">asciidoctor</span>
<span class="n">cd</span> <span class="o">../</span><span class="n">asciidoctor</span><span class="o">-</span><span class="n">stylesheet</span><span class="o">-</span><span class="n">factory</span>
<span class="n">bundle</span> <span class="n">install</span>
<span class="n">compass</span> <span class="nb">compile</span>
</pre></div>
</div>
</div>
<div class="section" id="doku-modifizieren-und-in-html-ubersetzen">
<h2>Doku modifizieren und in HTML übersetzen<a class="headerlink" href="#doku-modifizieren-und-in-html-ubersetzen" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">Regal</span><span class="o">/</span><span class="n">doc</span>
<span class="n">editor</span> <span class="n">regal</span><span class="o">.</span><span class="n">asciidoc</span>
<span class="n">asciidoctor</span> <span class="o">-</span><span class="n">astylesheet</span><span class="o">=</span><span class="n">foundation</span><span class="o">.</span><span class="n">css</span> <span class="o">-</span><span class="n">astylesdir</span><span class="o">=../../</span><span class="n">asciidoctor</span><span class="o">-</span><span class="n">stylesheet</span><span class="o">-</span><span class="n">factory</span><span class="o">/</span><span class="n">stylesheets</span> <span class="n">regal</span><span class="o">.</span><span class="n">asciidoc</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="license">
<h1>License<a class="headerlink" href="#license" title="Permalink to this headline">¶</a></h1>
<p><img alt="https://i.creativecommons.org/l/by-nc/4.0/88x31.png" src="https://i.creativecommons.org/l/by-nc/4.0/88x31.png" /></p>
<p>This work is licensed under a <a href="#id56"><span class="problematic" id="id60">`Creative Commons
Attribution-NonCommercial 4.0 International
License &lt;http://creativecommons.org/licenses/by-nc/4.0/&gt;&gt;`__</span></a>.</p>
</div>
<div class="section" id="links">
<h1>Links<a class="headerlink" href="#links" title="Permalink to this headline">¶</a></h1>
<div class="section" id="slides">
<h2>Slides<a class="headerlink" href="#slides" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Lobid - <a class="reference external" href="http://hbz.github.io/slides/">http://hbz.github.io/slides/</a></p></li>
<li><p>Skos-Lookup - <a class="reference external" href="http://hbz.github.io/slides/siit-170511/#/">http://hbz.github.io/slides/siit-170511/#/</a></p></li>
<li><p>Regal - <a class="reference external" href="http://hbz.github.io/slides/danrw-20180905/#/">http://hbz.github.io/slides/danrw-20180905/#/</a></p></li>
</ul>
</div>
<div class="section" id="internes-wiki">
<h2>Internes Wiki<a class="headerlink" href="#internes-wiki" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://wiki1.hbz-nrw.de/display/edd/Dokumentation">https://wiki1.hbz-nrw.de/display/edd/Dokumentation</a></p></li>
</ul>
</div>
<div class="section" id="github">
<h2>Github<a class="headerlink" href="#github" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/edoweb">https://github.com/edoweb</a></p></li>
<li><p><a class="reference external" href="https://github.com/hbz">https://github.com/hbz</a></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">!figure-caption</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">to.science</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Einleitung</a></li>
<li class="toctree-l1"><a class="reference internal" href="#konzepte">Konzepte</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#objektmodell">Objektmodell</a></li>
<li class="toctree-l2"><a class="reference internal" href="#namespaces-und-identifier">Namespaces und Identifier</a></li>
<li class="toctree-l2"><a class="reference internal" href="#deskriptive-metadaten">Deskriptive Metadaten</a></li>
<li class="toctree-l2"><a class="reference internal" href="#anzeige-und-darstellung">Anzeige und Darstellung</a></li>
<li class="toctree-l2"><a class="reference internal" href="#der-hbz-verbundkatalog">Der hbz-Verbundkatalog</a></li>
<li class="toctree-l2"><a class="reference internal" href="#metadatenkonvertierung">Metadatenkonvertierung</a></li>
<li class="toctree-l2"><a class="reference internal" href="#oai-providing">OAI-Providing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#suche">Suche</a></li>
<li class="toctree-l2"><a class="reference internal" href="#zugriffsberechtigungen-und-sichtbarkeiten">Zugriffsberechtigungen und Sichtbarkeiten</a></li>
<li class="toctree-l2"><a class="reference internal" href="#benutzerverwaltung">Benutzerverwaltung</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ansichten">Ansichten</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#software">Software</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id1">regal-api</a></li>
<li class="toctree-l2"><a class="reference internal" href="#etikett">Etikett</a></li>
<li class="toctree-l2"><a class="reference internal" href="#zettel">Zettel</a></li>
<li class="toctree-l2"><a class="reference internal" href="#skos-lookup">skos-lookup</a></li>
<li class="toctree-l2"><a class="reference internal" href="#thumby">Thumby</a></li>
<li class="toctree-l2"><a class="reference internal" href="#deepzoomer">Deepzoomer</a></li>
<li class="toctree-l2"><a class="reference internal" href="#regal-drupal">regal-drupal</a></li>
<li class="toctree-l2"><a class="reference internal" href="#edoweb-drupal-theme">edoweb-drupal-theme</a></li>
<li class="toctree-l2"><a class="reference internal" href="#zbmed-drupal-theme">zbmed-drupal-theme</a></li>
<li class="toctree-l2"><a class="reference internal" href="#openwayback">openwayback</a></li>
<li class="toctree-l2"><a class="reference internal" href="#heritrix">heritrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="#wpull">wpull</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fedora-commons-3">Fedora Commons 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mysql">MySql</a></li>
<li class="toctree-l2"><a class="reference internal" href="#elasticsearch-1-1">Elasticsearch 1.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="#drupal-7">Drupal 7</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#installation">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#vagrant">Vagrant</a></li>
<li class="toctree-l2"><a class="reference internal" href="#server">Server</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#entwicklung-java">Entwicklung Java</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#in-der-virtualbox">In der VirtualBox</a></li>
<li class="toctree-l2"><a class="reference internal" href="#auf-dem-eigenen-system">Auf dem eigenen System</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#administration">Administration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#aktualisierung">Aktualisierung</a></li>
<li class="toctree-l2"><a class="reference internal" href="#verzeichnisse">Verzeichnisse</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ports">Ports</a></li>
<li class="toctree-l2"><a class="reference internal" href="#logs">Logs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configs">Configs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#apache2">Apache2</a></li>
<li class="toctree-l2"><a class="reference internal" href="#matomo">Matomo</a></li>
<li class="toctree-l2"><a class="reference internal" href="#monit">Monit</a></li>
<li class="toctree-l2"><a class="reference internal" href="#scripts-und-cronjobs">Scripts und Cronjobs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#dokumentation">Dokumentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#dieses-repo-herunterladen">Dieses Repo herunterladen</a></li>
<li class="toctree-l2"><a class="reference internal" href="#asciidoctor-und-asciidoctor-stylesheets-installieren">Asciidoctor und Asciidoctor-Stylesheets installieren</a></li>
<li class="toctree-l2"><a class="reference internal" href="#doku-modifizieren-und-in-html-ubersetzen">Doku modifizieren und in HTML übersetzen</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#license">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="#links">Links</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#slides">Slides</a></li>
<li class="toctree-l2"><a class="reference internal" href="#internes-wiki">Internes Wiki</a></li>
<li class="toctree-l2"><a class="reference internal" href="#github">Github</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html#environment">Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html#regal-api">regal-api</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html#etikett">etikett</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html#zettel">zettel</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html#skos-lookup">skos-lookup</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html#thumby">thumby</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html#dokumentation">Dokumentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html#license">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html#references">References</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Welcome to to.science’s documentation!</a></li>
      <li>Next: <a href="api.html" title="next chapter">Preface</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, Jan Schnasse, Peter Reimer.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.5.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/regal.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>