<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="API-documentation" href="api.html" /><link rel="prev" title="to.science - Toolbox Open Science" href="index.html" />

    <meta name="generator" content="sphinx-4.3.1, furo 2021.11.23"/>
        <title>Einleitung - to.science documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=7f0192ddeb2adecfbaa87ffbcf67d16358b30bc1" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=0af69da206d614734f649b27d4cdc2dd6c31f41d" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  body[data-theme="dark"] {
    --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
  }
  @media (prefers-color-scheme: dark) {
    body:not([data-theme="light"]) {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
  }
</style></head>
  <body>
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" />
      <line x1="4" y1="6" x2="20" y2="6" />
      <line x1="10" y1="12" x2="20" y2="12" />
      <line x1="6" y1="18" x2="20" y2="18" />
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">to.science  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand centered" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="_static/hbz-logo.svg" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">to.science  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Einleitung</a></li>
<li class="toctree-l1"><a class="reference internal" href="#konzepte">Konzepte</a></li>
<li class="toctree-l1"><a class="reference internal" href="#software">Software</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="api.html">API-documentation</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="api-toscience.html">to.science.api</a></li>
<li class="toctree-l2"><a class="reference internal" href="api-labels.html">to.science.labels</a></li>
<li class="toctree-l2"><a class="reference internal" href="api-forms.html">to.science.forms</a></li>
<li class="toctree-l2"><a class="reference internal" href="api-thumbs.html">to.science.thumbs</a></li>
<li class="toctree-l2"><a class="reference internal" href="api-skos.html">skos-lookup</a></li>
<li class="toctree-l2"><a class="reference internal" href="api-complex-example.html">Complex Example of hierarchical content</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="colophon.html">Dokumentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="colophon.html#license">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="colophon.html#links">Links</a></li>
</ul>

</div>
</div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="einleitung">
<span id="id1"></span><h1>Einleitung<a class="headerlink" href="#einleitung" title="Permalink to this headline">ï</a></h1>
<p>to.science (ehemals âRegalâ) ist eine Content Repository zur Verwaltung
und VerÃ¶ffentlichung elektronischer Publikationen. Es wird seit 2013 am
<a class="reference external" href="https://hbz-nrw.de">Hochschulbibliothekszentrum NRW (hbz)</a>
entwickelt.</p>
<p>to.science basiert auf den folgenden Kerntechnologien:</p>
<ul class="simple">
<li><p>Fedora Commons 3</p></li>
<li><p>Elasticsearch 1.1</p></li>
<li><p>Drupal 7</p></li>
<li><p>Playframework 2.4</p></li>
<li><p>MySQL 5</p></li>
<li><p>Java 8</p></li>
<li><p>PHP 5</p></li>
</ul>
<p>FÃ¼r die Webarchivierung kommen auÃerdem Openwayback, Heritrix und WPull
zum Einsatz.</p>
<ul class="simple">
<li><p>openwayback hbz-2.3.2</p></li>
<li><p>pywb</p></li>
<li><p>heritrix 3.2.0</p></li>
<li><p>wpull</p></li>
</ul>
<p>Regal ist ein mehrkomponentiges System. Einzelne Komponenten sind als
Webservices realisiert und kommunizieren Ã¼ber HTTP-APIs miteinander.
Derzeit sind folgende Komponenten im Einsatz</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/hbz/to.science.api">to.science.api</a></p></li>
<li><p><a class="reference external" href="https://github.com/hbz/to.science.labels">to.science.labels</a></p></li>
<li><p><a class="reference external" href="https://github.com/hbz/to.science.forms">to.science.forms</a></p></li>
<li><p><a class="reference external" href="https://github.com/hbz/skos-lookup">skos-lookup</a></p></li>
<li><p><a class="reference external" href="https://github.com/hbz/thumby">thumby</a></p></li>
<li><p><a class="reference external" href="https://github.com/hbz/DeepZoomService">deepzoomer</a></p></li>
<li><p><a class="reference external" href="https://github.com/hbz/to.science.drupal">to.science.drupal</a></p></li>
</ul>
<p>Drupal Themes</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/edoweb/zbmed-drupal-theme">zbmed-drupal-theme</a></p></li>
<li><p><a class="reference external" href="https://github.com/edoweb/edoweb-drupal-theme">edoweb-drupal-theme</a></p></li>
</ul>
<p>Ãber die Systemschnittstellen kÃ¶nnen eine ganze Reihe von Drittsystemen
angesprochen werden. Die folgende Abbildung verschafft einen groben
Ãberblick Ã¼ber eine typische Regal-Installation und die angebundenen
Drittsysteme.</p>
<figure class="align-default" id="id84">
<img alt="Typische Regal-Installation mit Drupal Frontend, Backendkomponenten und angebundenen Drittsytemen" src="_images/regal-arch-4.jpeg"/>
<figcaption>
<p><span class="caption-text">Typische Regal-Installation mit Drupal Frontend, Backendkomponenten und angebundenen Drittsytemen</span><a class="headerlink" href="#id84" title="Permalink to this image">ï</a></p>
</figcaption>
</figure>
</section>
<section id="konzepte">
<span id="id2"></span><h1>Konzepte<a class="headerlink" href="#konzepte" title="Permalink to this headline">ï</a></h1>
<section id="objektmodell">
<span id="id3"></span><h2>Objektmodell<a class="headerlink" href="#objektmodell" title="Permalink to this headline">ï</a></h2>
<p>Regal realisiert ein einheitliches Objektmodell in dem sich eine
Vielzahl von Publikationstypen speichern lassen. Die Speicherschicht
wird Ã¼ber <a class="reference external" href="#_fedora_commons_3">Fedora Commons 3</a> realisiert.</p>
<p>Eine einzelne Publikation besteht i.d.R. aus mehreren <a class="reference external" href="#_fedora_commons_3">Fedora Commons
3</a>-Objekten, die in einer hierarchischen
Beziehung zueinander stehen.</p>
<div class="table-wrapper"><table class="docutils align-default" id="id85">
<caption><span class="caption-text">Fedora Object</span><a class="headerlink" href="#id85" title="Permalink to this table">ï</a></caption>
<colgroup>
<col style="width: 33%"/>
<col style="width: 33%"/>
<col style="width: 33%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Datenstrom</p></th>
<th class="head"><p>Pflicht</p></th>
<th class="head"><p>Beschreibung</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>DC</p></td>
<td><p>Ja</p></td>
<td><p>Von Fedora
vorgeschrieben. Wird
fÃ¼r die fedorainterne
Suche verwendet</p></td>
</tr>
<tr class="row-odd"><td><p>RELS-EXT</p></td>
<td><p>Ja</p></td>
<td><p>Von Fedora
vorgeschrieben. Wird
fÃ¼r viele Sachen
verwendet - (1)
Hierarchien - (2)
Steuerung der
Sichtbarkeiten - (2)
OAI-Providing</p></td>
</tr>
<tr class="row-even"><td><p>data</p></td>
<td><p>Nein</p></td>
<td><p>Die eigentlichen
Daten der
Publikation. Oft ein
PDF.</p></td>
</tr>
<tr class="row-odd"><td><p>metadata oder
metadata2</p></td>
<td><p>Nein</p></td>
<td><p>Bibliografische
Metadaten. Metadata2
wurde mit dem Umstieg
auf die Lobid-API v2
eingefÃ¼hrt.</p></td>
</tr>
<tr class="row-even"><td><p>objectTimestamp</p></td>
<td><p>Nein</p></td>
<td><p>Eine Datei mit einem
Zeitstempel. Der
Zeitstempel wird bei
bestimmten Aktionen
gesetzt.</p></td>
</tr>
<tr class="row-odd"><td><p>seq</p></td>
<td><p>Nein</p></td>
<td><p>Eine Hilfsdatei mit
einem JSON-Array. Das
Array zeigt an, in
welcher Reihenfolge
Kindobjekte
anzuzeigen sind.
Dieses Hilfskonstrukt
existiert, da in der
RELS-EXT keine
RDF-Listen abgelegt
werden kÃ¶nnen.</p></td>
</tr>
<tr class="row-even"><td><p>conf</p></td>
<td><p>Nein</p></td>
<td><p>Websites und
Webschnitte speichern
in einem
conf-Datenstrom alle
Parameter mit denen
die zugehÃ¶rige
Webseite geharvested
wurde.</p></td>
</tr>
</tbody>
</table></div>
<p>Die Metadaten werden als ASCII-Kodierte N-Triple abgelegt. Da alle
Fedora-Daten als Dateien im Dateisystem abgelegt werden, ist diese
Veriante besonders robust gegen Speicherfehler. N-Triple ist ein Format,
dass sich Zeilenweise lesen lÃ¤sst. ASCII ist die einfachste Form der
Textkodierung.</p>
<p>Die Daten werden als âmanagedâ-Datastream in den Objektspeicher der
Fedora abgelegt. Eine Ausnahme bilden Webseiten. Die als WARC
gespeicherten Inhalte werden âunmanagedâ lediglich verlinkt. Im Fedora
Objektspeicher wird nur eine Datei mit der ensprechenden Referenz
abgelegt.</p>
</section>
<section id="namespaces-und-identifier">
<span id="id4"></span><h2>Namespaces und Identifier<a class="headerlink" href="#namespaces-und-identifier" title="Permalink to this headline">ï</a></h2>
<p>Jede Regal-Installation arbeitet auf einem festgelegten Namespace. Wenn
Ã¼ber die <a class="reference external" href="#_regal_api_2">regal-api</a> Objekte angelegt werden, finden
sich diese immer in dem entsprechenden Namespace wieder. Hinter dem
Namespace findet sich, abgetrennt mit einem Dopplepunkt eine
hochlaufende Zahl, die i.d.R. Ã¼ber <a class="reference external" href="#_fedora_commons_3">Fedora Commons
3</a> bezogen wird.</p>
<p>Der so zusammengesetzte Identifier kommt in allen Systemkomponenten zum
Einsatz.</p>
<div class="table-wrapper"><table class="docutils align-default" id="id86">
<caption><span class="caption-text">Beispiel Regal Identifier</span><a class="headerlink" href="#id86" title="Permalink to this table">ï</a></caption>
<colgroup>
<col style="width: 33%"/>
<col style="width: 33%"/>
<col style="width: 33%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>ID</p></th>
<th class="head"><p>Komponente</p></th>
<th class="head"><p>URL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>regal:1</p></td>
<td><p>drupal</p></td>
<td><p><a class="reference external" href="http://local">http://local</a>
host/resource/regal:1</p></td>
</tr>
<tr class="row-odd"><td><p>regal:1</p></td>
<td><p>regal-api</p></td>
<td><p><a class="reference external" href="http://api.local">http://api.local</a>
host/resource/regal:1</p></td>
</tr>
<tr class="row-even"><td><p>regal:1</p></td>
<td><p>fedora</p></td>
<td><p>ht
tp://localhost:8080/f
edora/objects/regal:1</p></td>
</tr>
<tr class="row-odd"><td><p>regal:1</p></td>
<td><p>elasticsearch</p></td>
<td><p><a class="reference external" href="http://localhost:92">http://localhost:92</a>
00/regal/_all/regal:1</p></td>
</tr>
</tbody>
</table></div>
</section>
<section id="deskriptive-metadaten">
<span id="id5"></span><h2>Deskriptive Metadaten<a class="headerlink" href="#deskriptive-metadaten" title="Permalink to this headline">ï</a></h2>
<p>Regal unterstÃ¼tzt eine groÃe Anzahl von Metadatenfeldern zur
Beschreibung von bibliografischen Ressourcen. Jedes in Regal
verspeicherte Objekt kann mit Hilfe von RDF-Metadaten beschrieben
werden. Das System verspeichert grundsÃ¤tzlich alle Metadaten, solange
Sie im richtigen Format an die Schnittstelle gespielt werden.</p>
<p>DarÃ¼ber hinaus kÃ¶nnen Ã¼ber bestimmte Angaben, bestimmte weitergehende
Funktionen angesteuert werden. Dies betrifft u.A.:</p>
<ul class="simple">
<li><p>Anzeige und Darstellung</p></li>
<li><p>Metadatenkonvertierungen</p></li>
<li><p>OAI-Providing</p></li>
<li><p>Suche</p></li>
</ul>
<p>Alle bekannten MetadateneintrÃ¤ge werden in der Komponente
<a class="reference external" href="#_etikett">Etikett</a> verwaltet. In <a class="reference external" href="#_etikett">Etikett</a> kann
konfiguriert werden, welche URIs aus den RDF-Daten in das JSON-LD-Format
von <a class="reference external" href="#_regal_api_2">regal-api</a> Ã¼berfÃ¼hrt werden. AuÃerdem kann die
Reihenfolge der Darstellung, und das Label zur Anzeige gesetzt werden.</p>
<div class="table-wrapper"><table class="docutils align-default" id="id87">
<caption><span class="caption-text">Etikett-Eintrag fÃ¼r dc:title</span><a class="headerlink" href="#id87" title="Permalink to this table">ï</a></caption>
<colgroup>
<col style="width: 14%"/>
<col style="width: 14%"/>
<col style="width: 14%"/>
<col style="width: 14%"/>
<col style="width: 14%"/>
<col style="width: 14%"/>
<col style="width: 14%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Label</p></th>
<th class="head"><p>Pi
ctogram</p></th>
<th class="head"><p>Name
(json)</p></th>
<th class="head"><p>URI</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Co
ntainer</p></th>
<th class="head"><p>Comment</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Titel</p></td>
<td><p>keine
Angabe</p></td>
<td><p>title</p></td>
<td><p>ht
tp://pu
rl.org/
dc/term
s/title</p></td>
<td><p>String</p></td>
<td><p>keine
Angabe</p></td>
<td><p>keine
Angabe</p></td>
</tr>
</tbody>
</table></div>
<p><strong>Etikett-Eintrag als Json.</strong></p>
<p>âtitleâ:{ â@idâ=â<a class="reference external" href="http://purl.org/dc/terms/title">http://purl.org/dc/terms/title</a>â, âlabelâ=âTitelâ }</p>
<p>Die etikett Datenbank wird beim Neustart jeder
<a class="reference external" href="#_regal_api_2">regal-api</a>-Instanz eingelesen. AuÃerdem wird die
HTTP-Schnittstelle von Etikett immer wieder angesprochen um zur Anzeige
geeignete Labels in das System zu holen und anstatt der rohen URIs
einzublenden. Das <a class="reference external" href="#_regal_api_2">regal-api</a>-Modul lÃ¤uft dabei auch
ohne den Etikett-Services, allerdings nur mit eingeschrÃ¤nkter
FunktionalitÃ¤t; beispielsweise fallen Anzeigen von verlinkten Ressourcen
(und das ist in Regal fast alles) weniger schÃ¶n aus.</p>
<section id="wie-kommen-bibliografische-metadaten-ins-system">
<span id="id6"></span><h3>Wie kommen bibliografische Metadaten ins System?<a class="headerlink" href="#wie-kommen-bibliografische-metadaten-ins-system" title="Permalink to this headline">ï</a></h3>
<p>In Regal kÃ¶nnen bibliografische Metadaten aus dem hbz-Verbundkatalog an
Ressourcen âangelinktâ werden. Dies erfolgt Ã¼ber Angabe der ID des
entsprechenden Titelsatzes (z.b. HT017766754). Mit Hilfe dieser ID kann
Regal einen Titelimport durchfÃ¼hren. Dabei wird auf die Schnittstellen
der <a class="reference external" href="https://lobid.org">Lobid-API</a> zugegriffen.</p>
<p>Regal bietet auÃerdem die MÃ¶glichkeit, Metadaten Ã¼ber Erfassungsmasken
zu erzeugen und zu speichern. Dies erfolgt mit Hilfe des Moduls
<a class="reference external" href="#_zettel">Zettel</a>. <a class="reference external" href="#_zettel">Zettel</a> ist ein Webservice, der
verschiedene HTML-Formulare bereitstellt. Die Formulare kÃ¶nnen
RDF-Metadaten einlesen und ausgeben. Zettel-Formulare werden Ã¼ber
Javascript mit Hilfe eines IFrame in die eigentliche Anwendung
angebunden. Ãber Zettel werden Konzepte aus dem Bereich Linked Data
umgesetzt. So kÃ¶nnen Feldinhalte Ã¼ber entsprechende Eingabeelemente in
Drittsystemen recherchiert und verlinkt werden. Die Darstellung von
Links erfolgt in Zettel mit Hilfe von <a class="reference external" href="#_etikett">Etikett</a>.
Umfangreichere Notationssysteme wie Agrovoc oder DDC werden Ã¼ber einen
eigenen Index aus dem Modul <a class="reference external" href="#_skos_lookup">skos-lookup</a> eingebunden.
Zettel unterstÃ¼tzt zur Zeit folgende Linked-Data-Quellen:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://lobid.org/gnd">Lobid (GND)</a></p></li>
<li><p><a class="reference external" href="https://lobid.org/resources">Lobid (Ressource)</a></p></li>
<li><p><a class="reference external" href="http://aims.fao.org/vest-registry/vocabularies/agrovoc">Agrovoc</a></p></li>
<li><p><a class="reference external" href="https://www.oclc.org/en/dewey.html">DDC</a></p></li>
<li><p><a class="reference external" href="https://www.crossref.org/services/funder-registry/">CrossRef (Funder
Registry)</a></p></li>
<li><p><a class="reference external" href="https://orcid.org/">Orcid</a></p></li>
<li><p><a class="reference external" href="https://www.geonames.org/">Geonames</a></p></li>
<li><p><a class="reference external" href="https://www.openstreetmap.org">Open Street Maps Koordinaten</a></p></li>
</ul>
</section>
</section>
<section id="anzeige-und-darstellung">
<span id="id7"></span><h2>Anzeige und Darstellung<a class="headerlink" href="#anzeige-und-darstellung" title="Permalink to this headline">ï</a></h2>
<p>Ãber die Schnittstellen der <a class="reference external" href="#_regal_api_2">regal-api</a> kÃ¶nnen
unterschiedliche Darstellungen einer Publikation bezogen werden. Ãber
<a class="reference external" href="https://de.wikipedia.org/wiki/Content_Negotiation">Content
Negotiation</a>
kÃ¶nnen Darstellungen per HTTP-Header angefragt werden. Um
unterschiedliche Darstellungen im Browser anzeigen zu lassen, kann
auÃerden, Ã¼ber das Setzen von entsprechenden Endungen, auf
unterschiedliche Representationen eine Resource zugegriffen werden.</p>
<p><strong>Auswahl von Pfaden zu unterschiedlichen Representationen einer
Ressource.</strong></p>
<p>/resource/regal:1 /resource/regal:1.json /resource/regal:1.rdf
/resource/regal:1.epicur /resource/regal:1.mets</p>
<p>In der HTML-Darstellung greift <a class="reference external" href="#_regal_api_2">regal-api</a> auf den
Hilfsdienst <a class="reference external" href="#_thumby">Thumby</a> zu um darÃ¼ber Thumbnail-Darstellungen
von PDFs oder Bilder zu kreieren. Bei groÃen Bildern wird auÃerdem der
<a class="reference external" href="#_deepzoomer">Deepzoomer</a> angelinkt, der eine Darstellung von
hochauflÃ¶senden Bildern Ã¼ber das Tool
<a class="reference external" href="https://openseadragon.github.io/">OpenSeadragon</a> erlaubt. Video- und
Audio-Dateien werden Ã¼ber die entsprechenden HTML5 Elemente gerendert.</p>
</section>
<section id="der-hbz-verbundkatalog">
<span id="id8"></span><h2>Der hbz-Verbundkatalog<a class="headerlink" href="#der-hbz-verbundkatalog" title="Permalink to this headline">ï</a></h2>
<p>Metadaten, die Ã¼ber den Verbundkatalog importiert wurden, kÃ¶nnen Ã¼ber
einen Cronjob regelmÃ¤Ãig aktualisiert werden. AuÃerdem kÃ¶nnen diese
Daten Ã¼ber OAI-PMH an den Verbundkatalog zurÃ¼ckgeliefert werden, so dass
dieser, Links auf die Volltexte erhÃ¤lt.</p>
</section>
<section id="metadatenkonvertierung">
<span id="id9"></span><h2>Metadatenkonvertierung<a class="headerlink" href="#metadatenkonvertierung" title="Permalink to this headline">ï</a></h2>
<p>FÃ¼r die Metadatenkonvertierung gibt es kein festes Vorgehensmodell oder
Werkzeug. I.d.R. gibt es fÃ¼r jede Representation eine oder eine Reihe
von Javaklassen, die fÃ¼r eine On-the-fly-Konvertierung sorgen. Die
HTML-Darstellung basiert grundlegend auf denselben Daten, die auch im
<a class="reference external" href="https://www.elastic.co/guide/index.html">Elasticsearch</a>-Index liegen
und ist im wesentlichen eine JSON-LD-Darstellung, die mit Hilfe der in
<a class="reference external" href="#_etikett">Etikett</a> hinterlegten Konfiguration aus den
bibliografischen Metadaten gewonnen wurde.</p>
</section>
<section id="oai-providing">
<span id="id10"></span><h2>OAI-Providing<a class="headerlink" href="#oai-providing" title="Permalink to this headline">ï</a></h2>
<p>Ãffentlich zugÃ¤ngliche Publikationen sind auch Ã¼ber die
OAI-Schnittstelle verfÃ¼gbar. Dabei wird jede Publikation einer Reihe von
OAI-Sets zugeordnet und in unterschiedlichen Formaten angeboten.</p>
<div class="table-wrapper"><table class="docutils align-default" id="id88">
<caption><span class="caption-text">OAI Set</span><a class="headerlink" href="#id88" title="Permalink to this table">ï</a></caption>
<colgroup>
<col style="width: 50%"/>
<col style="width: 50%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Set</p></th>
<th class="head"><p>Kriterium</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ddc:*</p></td>
<td><p>Wenn ein dc:subject mit dem
String âhttp://dewey.info/class/â
beginnt, wird ein Set mit der
entsprechenden DDC-Nummer
gebildet und die Publikation wird
zugeordnet</p></td>
</tr>
<tr class="row-odd"><td><p>contentType</p></td>
<td><p>Der âcontentTypeâ weist darauf
hin, in welcher Weise die
Publikation in Regal. Abgelegt
ist.</p></td>
</tr>
<tr class="row-even"><td><p>open_access</p></td>
<td><p>All Publikationen, die als
Sichtbarkeit âpublicâ haben</p></td>
</tr>
<tr class="row-odd"><td><p>urn-set-1</p></td>
<td><p>Publikationen mit einer URN, die
mit <a class="reference external" href="urn:nbn:de:hbz:929:01">urn:nbn:de:hbz:929:01</a> beginnt</p></td>
</tr>
<tr class="row-even"><td><p>urn-set-2</p></td>
<td><p>Publikationen mit einer URN, die
mit <a class="reference external" href="urn:nbn:de:hbz:929:02">urn:nbn:de:hbz:929:02</a> beginnt</p></td>
</tr>
<tr class="row-odd"><td><p>epicur</p></td>
<td><p>Publikationen, die in einem
URN-Set sind</p></td>
</tr>
<tr class="row-even"><td><p>aleph</p></td>
<td><p>Publikationen , die mit einer
Aleph-Id verknÃ¼pft sind</p></td>
</tr>
<tr class="row-odd"><td><p>edoweb01</p></td>
<td><p>spezielles, pro
<a class="reference external" href="#_regal_api_2">reg
al-api</a>-Instanz
konfigurierbares Set fÃ¼r alle
Publikationen, die im aleph-Set
sind</p></td>
</tr>
<tr class="row-even"><td><p>ellinet01</p></td>
<td><p>spezielles, pro
<a class="reference external" href="#_regal_api_2">reg
al-api</a>-Instanz
konfigurierbares Set fÃ¼r alle
Publikationen, die im aleph-Set
sind</p></td>
</tr>
</tbody>
</table></div>
<div class="table-wrapper"><table class="docutils align-default" id="id89">
<caption><span class="caption-text">OAI Metadatenformat</span><a class="headerlink" href="#id89" title="Permalink to this table">ï</a></caption>
<colgroup>
<col style="width: 50%"/>
<col style="width: 50%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Format</p></th>
<th class="head"><p>Kriterium</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>oai_dc</p></td>
<td><p>Alle Ã¶ffentlich sichtbaren
Objekte, die als bestimmte
ContentTypes angelegt wurden.</p></td>
</tr>
<tr class="row-odd"><td><p>epicur</p></td>
<td><p>Alle Objekte, die eine URN haben</p></td>
</tr>
<tr class="row-even"><td><p>aleph</p></td>
<td><p>Alle Objekte, die einen
persistenten Identifier haben</p></td>
</tr>
<tr class="row-odd"><td><p>mets</p></td>
<td><p>Wie oai_dc</p></td>
</tr>
<tr class="row-even"><td><p>rdf</p></td>
<td><p>Wie oai_dc</p></td>
</tr>
<tr class="row-odd"><td><p>wgl</p></td>
<td><p>Format fÃ¼r LeibnizOpen. Alle
Objekte die Ã¼ber das Feld
âcollectionOneâ einer Institution
zugeordnet wurden und Ã¼ber den
ContentType âarticleâ
eingeliefert wurden.</p></td>
</tr>
</tbody>
</table></div>
</section>
<section id="suche">
<span id="id11"></span><h2>Suche<a class="headerlink" href="#suche" title="Permalink to this headline">ï</a></h2>
<p>Der Elasticsearch-Index wird mit Hilfe einer JSON-LD Konvertierung
befÃ¼llt. Die Konvertierung basiert im wesentlichen auf den
bibliografischen Metadaten der einzelnen Ressourcen und wir mit Hilfe
der in <a class="reference external" href="#_etikett">Etikett</a> hinterlegten Konfiguration erzeugt.</p>
</section>
<section id="zugriffsberechtigungen-und-sichtbarkeiten">
<span id="id12"></span><h2>Zugriffsberechtigungen und Sichtbarkeiten<a class="headerlink" href="#zugriffsberechtigungen-und-sichtbarkeiten" title="Permalink to this headline">ï</a></h2>
<p>Regal setzt ein rollenbasiertes Konzept zur Steuerung von
Zugriffsberechtigungen um. Eine besondere Bedeutung kommt dem lesenden
Zugriff auf Ressourcen zu. Einzelne Ressourcen kÃ¶nnen in ihrer
Sichtbarkeit so eingeschrÃ¤nkt werden, dass nur mit den Rechten einer
bestimmten Rolle lesend zugegriffen werden kann. Dabei kann der Zugriff
auf Metadaten und Daten separat gesteuert werden.</p>
<figure class="align-default" id="id90">
<img alt="Screenshot zur Verdeutlichung von Sichtbarkeiten in Regal" src="_images/accessControl.png"/>
<figcaption>
<p><span class="caption-text">Screenshot zur Verdeutlichung von Sichtbarkeiten in Regal</span><a class="headerlink" href="#id90" title="Permalink to this image">ï</a></p>
</figcaption>
</figure>
<p>Die Konfiguration hat Auswirkungen auf die Sichtbarkeit einer
Publikation in den unterschiedlichen Systemteilen. Die folgende Tabelle
veranschaulicht den derzeitigen Stand der Implementierung.</p>
<section id="sichtbarkeiten-operationen-rollen">
<span id="id13"></span><h3>Sichtbarkeiten, Operationen, Rollen<a class="headerlink" href="#sichtbarkeiten-operationen-rollen" title="Permalink to this headline">ï</a></h3>
<div class="table-wrapper"><table class="docutils align-default" id="id91">
<caption><span class="caption-text"><strong>Schreibender</strong> Zugriff auf Daten und Metadaten</span><a class="headerlink" href="#id91" title="Permalink to this table">ï</a></caption>
<colgroup>
<col style="width: 50%"/>
<col style="width: 50%"/>
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Rolle</p></td>
<td><p>Art der Aktion</p></td>
</tr>
<tr class="row-even"><td><p>ADMIN</p></td>
<td><p>Darf alle Aktionen durchfÃ¼hren.
Auch Bulk-Aktionen und âPurgesâ</p></td>
</tr>
<tr class="row-odd"><td><p>EDITOR</p></td>
<td><p>Darf Objekte anlegen, lÃ¶schen,
Sichtbarkeiten Ã¤ndern, etc.</p></td>
</tr>
</tbody>
</table></div>
<div class="table-wrapper"><table class="docutils align-default" id="id92">
<caption><span class="caption-text"><strong>Lesender</strong> Zugriff auf Metadaten</span><a class="headerlink" href="#id92" title="Permalink to this table">ï</a></caption>
<colgroup>
<col style="width: 50%"/>
<col style="width: 50%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Sichtbarkeit</p></th>
<th class="head"><p>Rolle</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>public</p></td>
<td><p>GUEST,READ
ER,SUBSCRIBER,REMOTE,ADMIN,EDITOR</p></td>
</tr>
<tr class="row-odd"><td><p>private</p></td>
<td><p>ADMIN,EDITOR</p></td>
</tr>
</tbody>
</table></div>
<div class="table-wrapper"><table class="docutils align-default" id="id93">
<caption><span class="caption-text"><strong>Lesender</strong> Zugriff auf Daten</span><a class="headerlink" href="#id93" title="Permalink to this table">ï</a></caption>
<colgroup>
<col style="width: 50%"/>
<col style="width: 50%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Sichtbarkeit</p></th>
<th class="head"><p>Rolle</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>public</p></td>
<td><p>GUEST,READ
ER,SUBSCRIBER,REMOTE,ADMIN,EDITOR</p></td>
</tr>
<tr class="row-odd"><td><p>restricted</p></td>
<td><p>READ
ER,SUBSCRIBER,REMOTE,ADMIN,EDITOR</p></td>
</tr>
<tr class="row-even"><td><p>remote</p></td>
<td><p>READ
ER,SUBSCRIBER,REMOTE,ADMIN,EDITOR</p></td>
</tr>
<tr class="row-odd"><td><p>single</p></td>
<td><p>SUBSCRIBER,ADMIN,EDITOR</p></td>
</tr>
<tr class="row-even"><td><p>private</p></td>
<td><p>ADMIN,EDITOR</p></td>
</tr>
</tbody>
</table></div>
</section>
</section>
<section id="benutzerverwaltung">
<span id="id14"></span><h2>Benutzerverwaltung<a class="headerlink" href="#benutzerverwaltung" title="Permalink to this headline">ï</a></h2>
<p>Die Benutzerverwaltung von Regal findet innerhalb von Drupal statt. Zwar
kÃ¶nnen auch in der <a class="reference external" href="#_regal_api_2">regal-api</a> Benutzer angelegt
werden, jedoch ist die Implementierung in diesem Bereich erst
rudimentÃ¤r.</p>
<section id="drupal">
<span id="id15"></span><h3>Drupal<a class="headerlink" href="#drupal" title="Permalink to this headline">ï</a></h3>
<p>Benutzer in Drupal kÃ¶nnen Ã¼ber das Modul
<a class="reference external" href="#_regal_drupal">regal-drupal</a> unterschiedlichen Rollen zugewiesen
werden. Die Authorisierung erfolgt passwortbasiert. Alle Drupal-Benutzer
greifen Ã¼ber einen vorkonfigurierten Accessor auf die
<a class="reference external" href="#_regal_api_2">regal-api</a> zu. Alle Zugriffe erfolgen verschlÃ¼sselt
unter Angabe eines Passwortes. Die Rolle mit deren Berechtigungen
zugegriffen wird, wird dabei in <a class="reference external" href="#_regal_drupal">regal-drupal</a>
gesetzt. Die Drupal-BenutzerId wird als Metadatum in Form eines
proprietÃ¤ren HTTP-Headers mit an <a class="reference external" href="#_regal_api_2">regal-api</a>
geliefert.</p>
</section>
<section id="regal-api">
<span id="id16"></span><h3>Regal-Api<a class="headerlink" href="#regal-api" title="Permalink to this headline">ï</a></h3>
<p>Auch in regal-api kÃ¶nnen Api-Benutzer angelegt werden. Zur
Benutzerverwaltung wird eine MySQL-Datenbank eingesetzt, in der die
Passworte der Nutzer abgelegt sind.</p>
</section>
</section>
<section id="ansichten">
<span id="id17"></span><h2>Ansichten<a class="headerlink" href="#ansichten" title="Permalink to this headline">ï</a></h2>
<p>Um Daten, die in <a class="reference external" href="#_regal_api_2">regal-api</a> abgelegt wurden zur
Anzeige zu bringen sind i.d.R. mehrere Schritte nÃ¶tig. Die genaue
Vorgehensweise ist davon abhÃ¤ngig, wo die Daten abgelegt werden (in
welchem Fedora Datenstrom). GrundsÃ¤tzlich basiert die HTML-Darstellung
auf den Daten, die unter dem Format <code class="docutils literal notranslate"><span class="pre">.json2</span></code> einer Ressource abrufbar
sind und einen Eintrag in context.json haben.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">**</span><span class="n">Daten</span> <span class="n">zur</span> <span class="n">Ansicht</span> <span class="n">bringen</span><span class="o">**</span>
</pre></div>
</div>
<ol class="arabic simple">
<li><p>Eintrag des zugehÃ¶rigen RDF-Properties in die entsprechende
<a class="reference external" href="#_etikett">Etikett</a>-Instanz, bzw. in die <code class="docutils literal notranslate"><span class="pre">/conf/labels.json</span></code>.
Der Eintrag muss einen Namen, ein Label und einen Datentyp haben.
<a class="reference external" href="#_regal_api_2">regal-api</a> neu starten, bzw mit
<code class="docutils literal notranslate"><span class="pre">POST</span> <span class="pre">/context.json</span></code> das neu Laden der ContexteintrÃ¤ge erzwingen.</p></li>
<li><p>Dies mÃ¼sste reichen, um eine Standardanzeige in der HTML-Ausgabe zu
erreichen</p></li>
<li><p>Wenn die Daten nicht erscheinen, sollte man Ã¼berprÃ¼fen, ob sie unter
dem Format <code class="docutils literal notranslate"><span class="pre">.json2</span></code> erscheinen. Wenn nicht, stellt sich die Frage,
wo die Daten abgelegt werden. Komplett werden nur die Daten aus dem
Fedora Datenstrom /metadata2 prozessiert. Befindet sich das Datum in
z.B. im /RELS-EXT Datenstrom so muss es zunÃ¤chst manuell unter
<code class="docutils literal notranslate"><span class="pre">helper.JsonMapper#getLd2()</span></code> in das JSON-Objekt eingefÃ¼gt werden.</p></li>
<li><p>Einige Felder werden auch ausgeblendet. Dies geschieht in
<a class="reference external" href="#_regal_api_2">regal-api</a> unter <code class="docutils literal notranslate"><span class="pre">/public/stylesheets/main.css</span></code>
und in Drupal innerhalb der entsprechenden themes.</p></li>
<li><p>Um spezielle Anzeigen zu realisieren muss schlieÃlich im
HTML-Template angefasst werden, unter
<code class="docutils literal notranslate"><span class="pre">/app/views/tags/resourceView.scala.html</span></code> .</p></li>
</ol>
<p>Insgesamt lÃ¤uft es also so: Alles was in <a class="reference external" href="#_etikett">Etikett</a>
konfiguriert ist, wird auch ins JSON und damit ins HTML und in den
Suchindex Ã¼bernommen. Dinge, die im HTML nicht benÃ¶tigt werden, werden
Ã¼ber CSS wieder ausgeblendet.</p>
</section>
</section>
<section id="software">
<span id="id18"></span><h1>Software<a class="headerlink" href="#software" title="Permalink to this headline">ï</a></h1>
<p>Die technische Dokumentation der HTTP-Schnittstelle findet sich unter
<a class="reference internal" href="api.html#api-documentation"><span class="std std-ref">API-documentation</span></a>:</p>
<p>Nachfolgend sei eine Innenansicht der einzelnen Module aufgestellt. Die
Integration der Module erfolgt i.d.R. Ã¼ber HTTPs. Die Module werden Ã¼ber
entsprechende EintrÃ¤ge in der Apache-Konfiguration sichtbar gemacht. Es
handelt sich also um eine Webservice-Architektur, in der alle
Webservices Ã¼ber einen Apache-Webserver und entsprechende EintrÃ¤ge in
ihren Konfigurationsdateien miteinander verbunden werden.</p>
<figure class="align-default" id="id94">
<img alt="Regal AbhÃ¤ngigkeiten" src="_images/regal-dependencies.jpeg"/>
<figcaption>
<p><span class="caption-text">Regal AbhÃ¤ngigkeiten</span><a class="headerlink" href="#id94" title="Permalink to this image">ï</a></p>
</figcaption>
</figure>
<section id="regal-api-2">
<span id="id19"></span><h2>regal-api<a class="headerlink" href="#regal-api-2" title="Permalink to this headline">ï</a></h2>
<div class="table-wrapper"><table class="docutils align-default" id="id95">
<caption><span class="caption-text">Ãberblick</span><a class="headerlink" href="#id95" title="Permalink to this table">ï</a></caption>
<colgroup>
<col style="width: 50%"/>
<col style="width: 50%"/>
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Source</p></td>
<td><p><a class="reference external" href="https://github.com/edoweb/regal-api">regal-api</a></p></td>
</tr>
<tr class="row-even"><td><p>Technik</p></td>
<td><p><a class="reference external" href="https://www.playframework.com/documentation/2.4.x/JavaHome">Play
2.4
.2</a></p></td>
</tr>
<tr class="row-odd"><td><p>Ports</p></td>
<td><p>9000 / 9100</p></td>
</tr>
<tr class="row-even"><td><p>Verzeichnis</p></td>
<td><p>/opt/regal/apps/regal ,
/opr/regal/src/regal</p></td>
</tr>
<tr class="row-odd"><td><p>HTTP Pfad</p></td>
<td><p>/</p></td>
</tr>
</tbody>
</table></div>
<p>Mit regal-api werden alle grundlegenden Funktionen von Regal
bereitgestellt. Dies umfasst:</p>
<ul class="simple">
<li><p>HTTP Schnittstelle</p></li>
<li><p>Sichtbarkeiten, Zugriffskontrolle, Rollen</p></li>
<li><p>Speicherung, Datenhaltung</p></li>
<li><p>Konvertierungen</p></li>
<li><p>Ansichten</p></li>
<li><p>Suche</p></li>
<li><p>Webarchivierung</p></li>
</ul>
<p>Der Webservice ist auf Basis von <a class="reference external" href="https://www.playframework.com/documentation/2.4.x/JavaHome">Play
2.4.2</a>
realisiert und bietet eine reichhaltig HTTP-API zur Verwaltung von
elektronischen Publikationen an. Die <a class="reference external" href="#_regal_api_2">regal-api</a>
operiert auf <a class="reference external" href="#_fedora_commons_3">Fedora Commons 3</a>,
<a class="reference external" href="#_mysql">MySql</a> und <a class="reference external" href="#_elasticsearch_1_1">Elasticsearch 1.1</a>.
Ãber die API werden auch FunktionalitÃ¤ten von <a class="reference external" href="#_etikett">Etikett</a>,
<a class="reference external" href="#_thumby">Thumby</a>, <a class="reference external" href="#_zettel">Zettel</a> und
<a class="reference external" href="#_deepzoomer">Deepzoomer</a> angesprochen. FÃ¼r die Webarchivierung
werden <a class="reference external" href="#_heritrix">heritrix</a>, <a class="reference external" href="#_wpull">wpull</a> und
<a class="reference external" href="#_openwayback">openwayback</a> angebunden.</p>
<section id="konfiguration">
<span id="id20"></span><h3>Konfiguration<a class="headerlink" href="#konfiguration" title="Permalink to this headline">ï</a></h3>
<div class="table-wrapper"><table class="docutils align-default" id="id96">
<caption><span class="caption-text">Dateien im /conf Verzeichnis</span><a class="headerlink" href="#id96" title="Permalink to this table">ï</a></caption>
<colgroup>
<col style="width: 50%"/>
<col style="width: 50%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Datei</p></th>
<th class="head"><p>Beschreibung</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>aggregations.conf</strong></p></td>
<td><p>Diese Datei wird verwendet um die
Schnittstelle <code class="docutils literal notranslate"><span class="pre">/browse</span></code> zu
konfigurieren. Die EintrÃ¤g im
Object âaggsâ kÃ¶nnen direkt Ã¼ber
die <code class="docutils literal notranslate"><span class="pre">/browse</span></code> Schnittstelle
angesprochen werden. Mit Hilfe
des Elasticsearch-Indexes wird
dann eine entsprechende Antwort
generiert. Beispiel:
<code class="docutils literal notranslate"><span class="pre">/browse/rdftype</span></code> liefert eine
Liste mit allen
Publikationstypen, die im Index
vorhanden sind.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>application.conf.tmpl</strong></p></td>
<td><p>Eine template Datei fÃ¼r die
Hauptkonfiguration von
<a class="reference external" href="#_regal_api_2">regal-api</a>.
Diese Datei sollte zur lokalen
Verwendung einmal nach
application.conf kopiert werden.
In der Datei sind alle PasswÃ¶rter
auf <em>admin</em> gesetzt.</p></td>
</tr>
<tr class="row-even"><td><p>crawler-beans.cxml</p></td>
<td><p>Die Datei wird verwendet, wenn im
Webarchivierungsmodul eine neue
Konfiguration fÃ¼r eine Webseite
angelegt wird.</p></td>
</tr>
<tr class="row-odd"><td><p>ehcache.xml</p></td>
<td><p>die Konfiguration der Ehcache
Komponente</p></td>
</tr>
<tr class="row-even"><td><p>fedora-users.xml</p></td>
<td><p>deprecated - Zur LÃ¶schung
vorgeschlagen</p></td>
</tr>
<tr class="row-odd"><td><p>hbz_edoweb_url.txt</p></td>
<td><p>deprecated - Zur LÃ¶schung
vorgeschlagen</p></td>
</tr>
<tr class="row-even"><td><p>html.html</p></td>
<td><p>deprecated - Zur LÃ¶schung
vorgeschlagen</p></td>
</tr>
<tr class="row-odd"><td><p>install.properties</p></td>
<td><p>deprecated - Zur LÃ¶schung
vorgeschlagen</p></td>
</tr>
<tr class="row-even"><td><p>labels-edoweb.de</p></td>
<td><p>Labels fÃ¼r eine bestimmt
Regal-Instanz</p></td>
</tr>
<tr class="row-odd"><td><p>labels-for
-proceeding-and-researchData.json</p></td>
<td><p>deprecated - Zur LÃ¶schung
vorgeschlagen</p></td>
</tr>
<tr class="row-even"><td><p>labels-lobid.json</p></td>
<td><p>deprecated - Zur LÃ¶schung
vorgeschlagen</p></td>
</tr>
<tr class="row-odd"><td><p>labels-publisso.de</p></td>
<td><p>Labels fÃ¼r eine bestimmte
Regal-Instanz</p></td>
</tr>
<tr class="row-even"><td><p><strong>labels.json</strong></p></td>
<td><p>Eine sinnvolle
Startkonfiguration. Die Datei
wurde mit <a class="reference external" href="#_etikett">Etikett</a>
erzeugt. Beim Start von
<a class="reference external" href="#_regal_api_2">regal-api</a>
wird zunÃ¤chst versucht eine
Ã¤hnliche Konfiguration direkt von
einer laufenden
<a class="reference external" href="#_etikett">Etikett</a>-Instanz
zu holen. Wenn dies nicht klappt,
wird auf die labels.json
zurÃ¼ckgegriffen.</p></td>
</tr>
<tr class="row-odd"><td><p>list.html</p></td>
<td><p>deprecated - Zur LÃ¶schung
vorgeschlagen</p></td>
</tr>
<tr class="row-even"><td><p>logback.developer.xml</p></td>
<td><p>Eine logging Konfiguration. Ich
kopiere die immer nach
logback.developer.js.xml (in
.gitignore) und trage sie dann in
die application.conf ein. Auf
diese Weise kann ich an Loglevels
herumkonfigurieren ohne das in
diese Ãnderungen in die
Versionsverwaltung spielen zu
mÃ¼ssen.</p></td>
</tr>
<tr class="row-odd"><td><p>logback.xml</p></td>
<td><p>Konfiguration des Loggers. Diese
Datei ist in application.conf
eingetragen.</p></td>
</tr>
<tr class="row-even"><td><p>mab
xml-string-template-on-record.xml</p></td>
<td><p>Eine template-Datei zur
Generierung von MAB-Ausgaben.</p></td>
</tr>
<tr class="row-odd"><td><p>mail.properties</p></td>
<td><p>Konfiguration zur Versendung von
Mails. StandardmÃ¤Ãig schickt die
Applikation eine Mail, sobald sie
im Production-Mode neu gestartet
wurde. Auch der Umzugsservice im
Webarchivierungsmodul verschickt
Mails.</p></td>
</tr>
<tr class="row-even"><td><p>nwbib-spatial.ttl</p></td>
<td><p>deprecated - Zur LÃ¶schung
vorgeschlagen</p></td>
</tr>
<tr class="row-odd"><td><p>nwbib.ttl</p></td>
<td><p>deprecated - Zur LÃ¶schung
vorgeschlagen</p></td>
</tr>
<tr class="row-even"><td><p><strong>public-index-config.json</strong></p></td>
<td><p>Konfiguration des
Elasticsearch-Indexes. Da in dem
Index vorallem Metadaten liegen,
soll fast nicht tokenisiert
werden.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>routes</strong></p></td>
<td><p>Hier sind alle HTTP-Pfade
Ã¼bersichtlich aufgefÃ¼hrt.</p></td>
</tr>
<tr class="row-even"><td><p>scm-info.sh</p></td>
<td><p>Diese Datei kann man unter Linux
in die profile-Konfiguration
seines Benutzers einbinden. Dann
erhÃ¤lt man im Terminal farbige
Angabgen zu Git-Branches,etc.</p></td>
</tr>
<tr class="row-odd"><td><p>start-regal.sh</p></td>
<td><p>deprecated - Zur LÃ¶schung
vorgeschlagen</p></td>
</tr>
<tr class="row-even"><td><p>tomcat-users.xml</p></td>
<td><p>deprecated - Zur LÃ¶schung
vorgeschlagen</p></td>
</tr>
<tr class="row-odd"><td><p>unescothes.ttl</p></td>
<td><p>deprecated - Zur LÃ¶schung
vorgeschlagen</p></td>
</tr>
<tr class="row-even"><td><p>wglcontributor.csv</p></td>
<td><p>deprecated - Zur LÃ¶schung
vorgeschlagen</p></td>
</tr>
</tbody>
</table></div>
</section>
<section id="die-applikation">
<span id="id21"></span><h3>Die Applikation<a class="headerlink" href="#die-applikation" title="Permalink to this headline">ï</a></h3>
<div class="table-wrapper"><table class="docutils align-default" id="id97">
<caption><span class="caption-text">Das /app Verzeichnis</span><a class="headerlink" href="#id97" title="Permalink to this table">ï</a></caption>
<colgroup>
<col style="width: 50%"/>
<col style="width: 50%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Package</p></th>
<th class="head"><p>Beschreibung</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>default package</p></td>
<td><p>Hier befindet sich die Datei
Global, die in <a class="reference external" href="https://www.playframework.com/documentation/2.4.x/JavaHome">Play
2
.4</a>
noch eine groÃe Rolle spielt. In
der Datei kÃ¶nnen zum Beispiel
Aktionen vor dem Start der
Applikation erfolgen, auch kÃ¶nnen
hier HTTP-Requests mit geloggt
werden. Bestimmte Aktionen werden
nur im Production-Mode
ausgefÃ¼hrt, d.h. nur wenn die
Applikation mit <code class="docutils literal notranslate"><span class="pre">start</span></code>
gestartet wurde oder Ã¼ber
<code class="docutils literal notranslate"><span class="pre">dist</span></code> ein entsprechendes
Binary erzeugt wurde.</p></td>
</tr>
<tr class="row-odd"><td><p>actions</p></td>
<td><p>Hier sind Funktionen versammelt,
die meist unmittelbar aus den
Controller-Klassen aufgerufen
werden.</p></td>
</tr>
<tr class="row-even"><td><p>archive.fedora</p></td>
<td><p>Ein Reihe von Dateien, Ã¼ber die
Zugriffe auf <a class="reference external" href="#_fedora_commons_3">Fedora Commons
3</a>
organisiert werden. Hier finden
sich auch einige Hilfsklassen
(<code class="docutils literal notranslate"><span class="pre">Utils</span></code>). Das FedoraInterface
zeigt an, welche Aktionen auf der
Fedora ausgefÃ¼hrt werden. Der
Code in diesem Paket gehÃ¶rt mit
zu dem Ã¤ltesten Code im gesamten
Regal-Projekt.</p></td>
</tr>
<tr class="row-odd"><td><p>archive.search</p></td>
<td><p>Zugriff auf die Elasticsearch</p></td>
</tr>
<tr class="row-even"><td><p>authenticate</p></td>
<td><p>Regal verwendet Basic-Auth zur
Authentifizierung. Um die
entsprechenden Aufrufe in den
Controllern zu SchÃ¼tzen wird eine
Annotation <code class="docutils literal notranslate"><span class="pre">@BasicAuth</span></code>
verwendet. Diese findet sich
hier. Die Annotation selbst
bewirkt, dass jeder
Controller-Aufruf durch die
Methode <code class="docutils literal notranslate"><span class="pre">basicAuth</span></code> der Klasse
<code class="docutils literal notranslate"><span class="pre">BasicAuthAction.java</span></code> lÃ¤uft.
Ziel dieser Prozedur ist es, dem
aktuellen Zugriff die
Berechtigungen einer bestimmten
Rolle zuzuordnen.</p></td>
</tr>
<tr class="row-odd"><td><p>controllers</p></td>
<td><p>Der Code, der in diesen Klassen
organisiert ist, wird bei den
entsprechenden HTTP-Aufrufen
ausgefÃ¼hrt. In der
<code class="docutils literal notranslate"><span class="pre">/conf/routes</span></code> Datei kann man
sehen, welcher HTTP-Aufruf,
welchen Methoden-Aufruf zur Folge
hat. Die Controller-Klassen sind
i.d.R. von der Klasse
MyController abgeleitet, die
Hilfsfunktionen bereitstellt,
aber auch Funktionen zur
ÃberprÃ¼fung von Zugriffsrechten.
Die ÃberprÃ¼fung von
Zugriffsrechten erfolgt durch
eingebettet Calls und wird Ã¼ber
die internen Klassen von
MyController realisiert.
Beispiel: Die Funktion
<code class="docutils literal notranslate"><span class="pre">listNodes</span></code> in der Klasse
<code class="docutils literal notranslate"><span class="pre">controllers.Resource</span></code> ruft
ihre Prozeduren eingebettet in
eine Funktion der Klasse
<code class="docutils literal notranslate"><span class="pre">ListAction</span></code> auf. Die Klasse
<code class="docutils literal notranslate"><span class="pre">ListAction</span></code> ist in
<code class="docutils literal notranslate"><span class="pre">MyController</span></code> implementiert
und Ã¼berprÃ¼ft, ob der Aufruf mit
der nÃ¶tigen Berechtigung
erfolgte. Vgl.
<a class="reference external" href="#_zugriffsberechtigungen_und_sichtbarkeiten">Zugriffsberechtigungen und
Sichtbarkeiten</a></p></td>
</tr>
<tr class="row-even"><td><p>converter.mab</p></td>
<td><p>Diese Datei realisiert das
OAI-Providing von MAB-Daten.
UrsprÃ¼nglich war geplant,
wesentlich umfangreichere
MAB-DatensÃ¤tze an den
Verbundkatalog zu liefern. Daher
wird hier mit einer eigenen
Template-Engine gearbeitet, etc.
Ein lustiges Produkt in diesem
Kontext ist auch die Klasse
<code class="docutils literal notranslate"><span class="pre">models.MabRecord</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p>de.hbz.lobid.helper</p></td>
<td><p>Der hier befindliche Code kommt
ursprÃ¼nglich aus einem anderen
Paket, wurde dann aber beim
Neuaufbau des Lobid 2
Datendienstes gemeinsam mit den
Kollegen weiterentwickelt und ist
schlieÃlich wieder hier gelandet.
Mittlerweile ist die offizielle
JSON-LD-Library soweit
entwickelt, dass man die
Konvertierung auch darÃ¼ber machen
kann. Achja, denn dafÃ¼r ist der
Code: Lobid N-Triples in schÃ¶nes
JSON umzuformen, das dann auch in
den Elasticsearch-Index kann.</p></td>
</tr>
<tr class="row-even"><td><p>helper</p></td>
<td><p>Die mit Abstand wichtigste Klasse
in diesem Package heiÃt
<code class="docutils literal notranslate"><span class="pre">JsonMapper</span></code>. Hier wird das
JSON fÃ¼r Index und Ansichten
erzeugt.</p></td>
</tr>
<tr class="row-odd"><td><p>helper.mail</p></td>
<td><p>Emails verschicken.</p></td>
</tr>
<tr class="row-even"><td><p>helper.oai</p></td>
<td><p>Einige Klassen zur Regelung des
OAI-Providings. Der
<code class="docutils literal notranslate"><span class="pre">OAIDispatcher</span></code> analysiert, ob
und wie ein <code class="docutils literal notranslate"><span class="pre">Node</span></code> an die
OAI-Schnittstelle gelangt.</p></td>
</tr>
<tr class="row-odd"><td><p>models</p></td>
<td><p>Die wichtigste Klasse hier ist
<code class="docutils literal notranslate"><span class="pre">Node</span></code> Ã¼ber diese Klasse lÃ¤uft
der GroÃteil des
Datentransportes.</p></td>
</tr>
<tr class="row-even"><td><p>views</p></td>
<td><p>Templates in der Sprache
<code class="docutils literal notranslate"><span class="pre">Twirl</span></code> und einige
Java-Hilfsklassen.</p></td>
</tr>
<tr class="row-odd"><td><p>views.mediaViewers</p></td>
<td><p>Ein paar Viewer, die Ã¼ber die
Hilfsklasse <code class="docutils literal notranslate"><span class="pre">ViewerInfo</span></code> in
<code class="docutils literal notranslate"><span class="pre">tags.resourceView</span></code> eingebunden
werden kÃ¶nnen.</p></td>
</tr>
<tr class="row-even"><td><p>views.oai</p></td>
<td><p>Mit <code class="docutils literal notranslate"><span class="pre">Twirl</span></code> XML zu generieren
war keine gute Idee.</p></td>
</tr>
<tr class="row-odd"><td><p>views.tags</p></td>
<td><p>Hilfstemplates.</p></td>
</tr>
</tbody>
</table></div>
</section>
</section>
<section id="etikett">
<span id="id22"></span><h2>Etikett<a class="headerlink" href="#etikett" title="Permalink to this headline">ï</a></h2>
<div class="table-wrapper"><table class="docutils align-default" id="id98">
<caption><span class="caption-text">Ãberblick</span><a class="headerlink" href="#id98" title="Permalink to this table">ï</a></caption>
<colgroup>
<col style="width: 50%"/>
<col style="width: 50%"/>
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Source</p></td>
<td><p><a class="reference external" href="https://github.com/hbz/etikett">etikett</a></p></td>
</tr>
<tr class="row-even"><td><p>Technik</p></td>
<td><p><a class="reference external" href="https://www.playframework.com/documentation/2.2.x/JavaHome">Play Play
2.2
.2</a></p></td>
</tr>
<tr class="row-odd"><td><p>Ports</p></td>
<td><p>9002 / 9102</p></td>
</tr>
<tr class="row-even"><td><p>Verzeichnis</p></td>
<td><p>/opt/regal/apps/etikett ,
/opr/regal/src/etikett</p></td>
</tr>
<tr class="row-odd"><td><p>HTTP Pfad</p></td>
<td><p>/tools/etikett</p></td>
</tr>
</tbody>
</table></div>
<p>Etikett ist eine einfache Datenbankanwendung, die es erlaubt</p>
<ol class="arabic simple">
<li><p>Menschenlesbare Labels fÃ¼r URIs abzulegen. Ãber eine
HTTP-Schnittstelle kann dann nach dem Label gefragt werden.</p></li>
<li><p>Auch Konfigurationen zur Erzeugung eines JSON-LD Kontextes kÃ¶nnen
abgelegt werden.</p></li>
<li><p>Die Etikett-Datenbank erweitert sich dynamisch. Wird in einem
authentifizierten Zugriff nach einer noch nicht bekannten URI
gefragt, so versucht die Applikation ein Label fÃ¼r die URI zu finden.</p></li>
</ol>
<p>In Etikett sind verschiedene Lookups realisiert, die dynamisch Labels
fÃ¼r URIs finden kÃ¶nnen. Beispiele:</p>
<ul class="simple">
<li><p>Crossref</p></li>
<li><p>Geonames</p></li>
<li><p>GND</p></li>
<li><p>Openstreetmap</p></li>
<li><p>Orcid</p></li>
<li><p>RDF, Skos, etc.</p></li>
</ul>
<p>Fragt man Etikett nach einem Label, so antwortet Etikett mit dem
Ergebnis des Lookups. Wenn Etikett nicht in der Lage ist, ein Label zu
finden, wird die URI, mit angefragt wurde, zurÃ¼ckgegeben.</p>
<p>Etikett kann auch als Cache verwendet werden. So werden authentifizierte
Anfragen in einer Datenbank persistiert. Erneute Anfragen werden dann
aus der Datenbank beantwortet, ein erneuter Lookup wird eingespart.
Einmal persistierte Labels werden nicht invalidiert. Die Invalidierung
kann von auÃerhalb Ã¼ber authentifizierte HTTP-Zugriffe realisiert
werden, stellt aber insgesamt noch ein Desiderat dar.</p>
<p>Etikett kann auch mit Labels vorkonfiguriert werden. Dabei kÃ¶nnen
zusÃ¤tzliche Informationen zu jeder URIs mit abgelegt werden. Folgende
Informationen kÃ¶nnen in etikett abgelegt werden:</p>
<ul class="simple">
<li><p>URI</p></li>
<li><p>Label</p></li>
<li><p>Weight - Zur Definition von Anzeigereihenfolgen.</p></li>
<li><p>Pictogram Iconfont-ID - Kann anstatt oder zusÃ¤tzlich zum Label
angezeigt werden.</p></li>
<li><p>ReferenceType - JSON-LD Typ</p></li>
<li><p>Container - JSON-LD Container</p></li>
<li><p>Beschreibung - Kommentar als Markdown</p></li>
</ul>
<figure class="align-default" id="id99">
<img alt="Etikett OberflÃ¤che" src="_images/etikett-screen.png"/>
<figcaption>
<p><span class="caption-text">Etikett OberflÃ¤che</span><a class="headerlink" href="#id99" title="Permalink to this image">ï</a></p>
</figcaption>
</figure>
<p>Mit Hilfe dieser Angaben kann Etikett auch einen âJSON-LD Contextâ
bereitstellen. Insgesamt wird Ã¼ber Etikett eine Art âApplication
Profileâ realisiert. Das Profil gibt Auskunft, welche Metadatenfelder
(definiert als URIs) in welcher Weise (Typ, Container) Verwendung finden
und wie sie angezeigt werden sollen (Label, Weight, Pictogram).</p>
<p>Im Regal-Kontext wird <a class="reference external" href="#_etikett">Etikett</a> an vielen Stellen
verwendet.</p>
<ul class="simple">
<li><p>Zur Wandlung von RDF nach JSON-LD</p></li>
<li><p>Zur Anreicherung von RDF Importen</p></li>
<li><p>Zur menschenlesbaren Darstellung von RDF</p></li>
<li><p>Zur Konfiguration von Labels, Anzeigereihenfolgen und Pictogrammen</p></li>
<li><p>Als Cache</p></li>
</ul>
<section id="konfiguration-2">
<span id="id23"></span><h3>Konfiguration<a class="headerlink" href="#konfiguration-2" title="Permalink to this headline">ï</a></h3>
<div class="table-wrapper"><table class="docutils align-default" id="id100">
<caption><span class="caption-text">Dateien im /conf Verzeichnis</span><a class="headerlink" href="#id100" title="Permalink to this table">ï</a></caption>
<colgroup>
<col style="width: 50%"/>
<col style="width: 50%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Datei</p></th>
<th class="head"><p>Beschreibung</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>evolutions</strong></p></td>
<td><p>Dieses Verzeichnis enthÃ¤lt
SQL-Skripte, die bei Ãnderungen
des Datenbankschemas automatisch
Ã¼ber EBean angelegt werden. Beim
nÃ¤chsten Deployment einer neuen
Etikett-Version werden die
Skripte automatische angewendet.
Die Skripte enthalten immer einen
mit âUpâ markierten Part, und
einen mit âDownâ markierten Part
(fÃ¼r rollbacks).</p></td>
</tr>
<tr class="row-odd"><td><p><strong>application.conf</strong></p></td>
<td><p>Hier kann ein Benutzer
eingestellt werden. Alle Klassen
im Verzeichnis <code class="docutils literal notranslate"><span class="pre">models.*</span></code>
erhalten eine SQL-Tabelle.</p></td>
</tr>
<tr class="row-even"><td><p>ddc.turtle</p></td>
<td><p>Eine DDC Datei. Die Datei bietet
Labels fÃ¼r DDC-URIs an.</p></td>
</tr>
<tr class="row-odd"><td><p>labels.json</p></td>
<td><p>Eine Labels-Datei, die zur
initialen BefÃ¼llung verwendet
werden kann.</p></td>
</tr>
<tr class="row-even"><td><p>regal.turtle</p></td>
<td><p>Eine Labels-Datei, die zur
initialen BefÃ¼llung verwendet
werden kann.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>routes</strong></p></td>
<td><p>Alle HTTP-Schnittstellen
Ã¼bersichtlich in einer Datei</p></td>
</tr>
<tr class="row-even"><td><p>rpb.turtle</p></td>
<td><p>Eine Labels-Datei, die zur
initialen BefÃ¼llung verwendet
werden kann.</p></td>
</tr>
<tr class="row-odd"><td><p>rpb2.turtle</p></td>
<td><p>Eine Labels-Datei, die zur
initialen BefÃ¼llung verwendet
werden kann.</p></td>
</tr>
</tbody>
</table></div>
</section>
<section id="die-applikation-2">
<span id="id24"></span><h3>Die Applikation<a class="headerlink" href="#die-applikation-2" title="Permalink to this headline">ï</a></h3>
<div class="table-wrapper"><table class="docutils align-default" id="id101">
<caption><span class="caption-text">Das /app Verzeichnis</span><a class="headerlink" href="#id101" title="Permalink to this table">ï</a></caption>
<colgroup>
<col style="width: 50%"/>
<col style="width: 50%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Package</p></th>
<th class="head"><p>Beschreibung</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>default</p></td>
<td><p>In <code class="docutils literal notranslate"><span class="pre">Global</span></code> werden die Requests
mit geloggt.</p></td>
</tr>
<tr class="row-odd"><td><p>controllers</p></td>
<td><p>In <code class="docutils literal notranslate"><span class="pre">Application</span></code> werden alle
HTTP-Operationen implementiert.
UnterstÃ¼tzt wird BasicAuth.</p></td>
</tr>
<tr class="row-even"><td><p>helper</p></td>
<td><p>Verschiedene Klassen, die eine
URI verfolgen und versuchen ein
Label aus den zurÃ¼ckgelieferten
Daten zu kreieren.</p></td>
</tr>
<tr class="row-odd"><td><p>models</p></td>
<td><p>Das Model <code class="docutils literal notranslate"><span class="pre">Etikett</span></code> ist
persistierbar.</p></td>
</tr>
<tr class="row-even"><td><p>views</p></td>
<td><p>Die meisten HTTP-Operationen
lassen sich auch Ã¼ber eine
WeboberflÃ¤che im Browser
aufrufen.</p></td>
</tr>
</tbody>
</table></div>
</section>
</section>
<section id="zettel">
<span id="id25"></span><h2>Zettel<a class="headerlink" href="#zettel" title="Permalink to this headline">ï</a></h2>
<div class="table-wrapper"><table class="docutils align-default" id="id102">
<caption><span class="caption-text">Ãberblick</span><a class="headerlink" href="#id102" title="Permalink to this table">ï</a></caption>
<colgroup>
<col style="width: 50%"/>
<col style="width: 50%"/>
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Source</p></td>
<td><p><a href="#id127"><span class="problematic" id="id128">`zettel &lt;
https://github.com/hbz/zettel&gt;`__</span></a></p></td>
</tr>
<tr class="row-even"><td><p>Technik</p></td>
<td><p><a class="reference external" href="https://www.playframework.com/documentation/2.5.x/JavaHome">Play Play
2.5
.4</a></p></td>
</tr>
<tr class="row-odd"><td><p>Ports</p></td>
<td><p>9003 / 9103</p></td>
</tr>
<tr class="row-even"><td><p>Verzeichnis</p></td>
<td><p>/opt/regal/apps/zettel,
/opr/regal/src/zettel</p></td>
</tr>
<tr class="row-odd"><td><p>HTTP Pfad</p></td>
<td><p>/tools/zettel</p></td>
</tr>
</tbody>
</table></div>
<p>Zettel ist ein Webservice zur Bereitstellung von Webformularen. Die
Webformulare kÃ¶nnen Ã¼ber ein HTTP-GET geladen werden. Sollen
existierende Daten in ein Formular geladen werden, so kÃ¶nnen diese Daten
(1) als Form-encoded, (2) als JSON, oder (3) als RDF-XML Ã¼ber ein
<code class="docutils literal notranslate"><span class="pre">HTTP</span> <span class="pre">POST</span></code> in das Formular geladen werden. Gleichzeitig kann
spezifiziert werden, in welchem Format das Formular Daten zurÃ¼ckliefern
soll.</p>
<figure class="align-default" id="id103">
<img alt="Zettel OberflÃ¤che" src="_images/zettel-screen.png"/>
<figcaption>
<p><span class="caption-text">Zettel OberflÃ¤che</span><a class="headerlink" href="#id103" title="Permalink to this image">ï</a></p>
</figcaption>
</figure>
<p>Zettel verfÃ¼gt Ã¼ber keine eigene Speicherschicht. Daten die Ã¼ber ein
Formular erzeugt wurden, werden in der HTTP-Response zurÃ¼ckgeliefert.
Zur Integration von Zettel in andere Applikationen wurde ein
Kommunikationspattern entwickelt, das auf Javascript beruht. Das
Zettel-Formular wird hierzu in einem IFrame in die Applikation
eingebunden. Die Applikation muss auÃerdem ein Javascript einbinden, das
auf bestimmte Nachrichten aus dem IFrame lauscht. Bei bestimmte Aktionen
sendet das Zettel-Formular dann Nachrichten an die Applikation und
erlaubt dieser darauf zu reagieren. Um Daten von Zettel in die
Applikation zu bekommen, werden diese im HTML-DOM gespeichert und kÃ¶nnen
von dort durch die Applikation entgegengenommen werden.</p>
<figure class="align-default" id="id104">
<img alt="Zettel Datenfluss" src="_images/zettel-flos.png"/>
<figcaption>
<p><span class="caption-text">Zettel Datenfluss</span><a class="headerlink" href="#id104" title="Permalink to this image">ï</a></p>
</figcaption>
</figure>
<section id="konfiguration-3">
<span id="id26"></span><h3>Konfiguration<a class="headerlink" href="#konfiguration-3" title="Permalink to this headline">ï</a></h3>
<div class="table-wrapper"><table class="docutils align-default" id="id105">
<caption><span class="caption-text">Dateien im /conf Verzeichnis</span><a class="headerlink" href="#id105" title="Permalink to this table">ï</a></caption>
<colgroup>
<col style="width: 50%"/>
<col style="width: 50%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Datei</p></th>
<th class="head"><p>Beschreibung</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>application.conf</strong></p></td>
<td><p>Die Datei enthÃ¤lt einen Eintrag
zur Konfiguration von
<a class="reference external" href="#_etikett">Etikett</a>. Ãber
einen weiteren Eintrag kÃ¶nnen
âHilfetexteâ angelinkt werden.
Die Hilfetexte mÃ¼ssen in einer
statischen HTML abgelegt sein. Am
Ende der Datei werden einige
Limits deutlich Ã¼ber den Standard
erhÃ¶ht, damit die groÃen
RDF-Posts auch funktionieren.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>collectionOne.csv</strong></p></td>
<td><p>Die Datei regelt den Inhalt eines
Combo-Box widgets mit id
collectionOne.</p></td>
</tr>
<tr class="row-even"><td><p><strong>ddc.csv</strong></p></td>
<td><p>Die Datei regelt den Inhalt eines
Combo-Box widgets mit id ddc.</p></td>
</tr>
<tr class="row-odd"><td><p>labels.json</p></td>
<td><p>Ein paar labels, falls keine
Instanz von
<a class="reference external" href="#_etikett">Etikett</a>
erreichbar ist.</p></td>
</tr>
<tr class="row-even"><td><p>logback.xml</p></td>
<td><p>Logger Konfiguration.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>professionalGroup.csv</strong></p></td>
<td><p>Die Datei regelt den Inhalt eines
Combo-Box widgets mit id
professionalGroup.</p></td>
</tr>
<tr class="row-even"><td><p>routes</p></td>
<td><p>Alle HTTP-Pfade Ã¼bersichtlich in
einer Datei</p></td>
</tr>
</tbody>
</table></div>
</section>
<section id="die-applikation-3">
<span id="id27"></span><h3>Die Applikation<a class="headerlink" href="#die-applikation-3" title="Permalink to this headline">ï</a></h3>
<div class="table-wrapper"><table class="docutils align-default" id="id106">
<caption><span class="caption-text">Das /app Verzeichnis</span><a class="headerlink" href="#id106" title="Permalink to this table">ï</a></caption>
<colgroup>
<col style="width: 50%"/>
<col style="width: 50%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Package</p></th>
<th class="head"><p>Beschreibung</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>controllers</p></td>
<td><p>Es gibt nur einen Controller.
Hier ist sowohl die
BasisfunktionalitÃ¤t
implementiert, als auch die
Autocompletion-Endpunkte fÃ¼r die
unterschiedlichen Widgets. Die
Schnittstelle zu Abhandlung von
Formulardaten ist recht generisch
gehalten. Ãber eine ID wird das
entsprechende Formular aus dem
services.ZettelRegister geholt
und das zugehÃ¶rige Formular wird
gerendert. Die Formular erhalten
dabei unterschiedliche Templates
(z.B. <code class="docutils literal notranslate"><span class="pre">views.Article</span></code>) und
unterschiedliche Modelklassen
(z.B. models.Article).</p></td>
</tr>
<tr class="row-odd"><td><p>models</p></td>
<td><p>Das Model âArticleâ heiÃt aus
historischen GrÃ¼nden so.
TatsÃ¤chlich kÃ¶nnen mittlerweile
auch Kongressschriften und
Buchkapitel darÃ¼ber abgebildet
werden (vermutlich wird sich der
Name nochmal Ã¤ndern). Das Model
âCatalogâ dient zum Import von
Daten aus dem Aleph-Katalog (Ã¼ber
Lobid). Mit ResearchData steht
ein prototypisches Model zur
Verarbeitung von Daten Ã¼ber
Forschungsdaten zur VerfÃ¼gung.
Alle Models basieren auf einem
einzigen âfettenâ ZettelModel.
Das ZettelModel enthÃ¤lt auch
Funktionen zur De/Serialisierung
in RDF und Json.</p></td>
</tr>
<tr class="row-even"><td><p>services</p></td>
<td><p>Hier werden verschiedene
Hilfsklassen versammelt. Die
Klasse ZettelFields enthÃ¤lt ein
Mapping zur RDF-Deserialisierung.</p></td>
</tr>
<tr class="row-odd"><td><p>views</p></td>
<td><p>Alle HTML-Sichten und die
eigentlichen Formulare.</p></td>
</tr>
</tbody>
</table></div>
</section>
</section>
<section id="skos-lookup">
<span id="id28"></span><h2>skos-lookup<a class="headerlink" href="#skos-lookup" title="Permalink to this headline">ï</a></h2>
<div class="table-wrapper"><table class="docutils align-default" id="id107">
<caption><span class="caption-text">Ãberblick</span><a class="headerlink" href="#id107" title="Permalink to this table">ï</a></caption>
<colgroup>
<col style="width: 50%"/>
<col style="width: 50%"/>
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Source</p></td>
<td><p><a class="reference external" href="https://github.com/hbz/skos-lookup">skos-lookup</a></p></td>
</tr>
<tr class="row-even"><td><p>Technik</p></td>
<td><p><a class="reference external" href="https://www.playframework.com/documentation/2.5.x/JavaHome">Play Play
2.5
.8</a></p></td>
</tr>
<tr class="row-odd"><td><p>Ports</p></td>
<td><p>9004 / 9104</p></td>
</tr>
<tr class="row-even"><td><p>Verzeichnis</p></td>
<td><p>/opt/regal/apps/skos-lookup,
/opr/regal/src/skos-lookup</p></td>
</tr>
<tr class="row-odd"><td><p>HTTP Pfad</p></td>
<td><p>/tools/skos-lookup</p></td>
</tr>
</tbody>
</table></div>
<p><a class="reference external" href="#_skos_lookup">skos-lookup</a> dient zur UnterstÃ¼tzung von
<a class="reference external" href="#_zettel">Zettel</a>. Der Webservice startet eine eingebettete
Elasticsearch-Instanz und verfÃ¼gt Ã¼ber eine Schnittstelle um SKOS-Daten
in separate Indexe zu importieren und Schnittstellen zur UnterstÃ¼tzung
von jQuery-Autocomplete- und Select2-Widgets aufzubauen. Auf diese Weise
kÃ¶nnen auch umfangreichere Thesauri und Notationssysteme in den
Formularen von <a class="reference external" href="#_zettel">Zettel</a> fachgerecht angelinkt werden.
<a class="reference external" href="#_skos_lookup">skos-lookup</a> unterstÃ¼tzt auch mehrsprachige Thesauri.</p>
<figure class="align-default" id="id108">
<img alt="SKOS-Lookup Beispiel 1" src="_images/skos-lookup-autocomplete.png"/>
<figcaption>
<p><span class="caption-text">SKOS-Lookup Beispiel 1</span><a class="headerlink" href="#id108" title="Permalink to this image">ï</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id109">
<img alt="SKOS-Lookup Beispiel 2" src="_images/example-select2.png"/>
<figcaption>
<p><span class="caption-text">SKOS-Lookup Beispiel 2</span><a class="headerlink" href="#id109" title="Permalink to this image">ï</a></p>
</figcaption>
</figure>
<section id="konfiguration-4">
<span id="id29"></span><h3>Konfiguration<a class="headerlink" href="#konfiguration-4" title="Permalink to this headline">ï</a></h3>
<div class="table-wrapper"><table class="docutils align-default" id="id110">
<caption><span class="caption-text">Dateien im /conf Verzeichnis</span><a class="headerlink" href="#id110" title="Permalink to this table">ï</a></caption>
<colgroup>
<col style="width: 50%"/>
<col style="width: 50%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Datei</p></th>
<th class="head"><p>Beschreibung</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>application.conf</strong></p></td>
<td><p>Hier wird der interne
Elasticsearch-Index konfiguriert.
Auch werden einige
Speichereinstellungen erhÃ¶ht.
Damit auch groÃe SKOS-Dateien
geladen werden kÃ¶nnen, sollten
auch die Java-Opts erhÃ¶ht werden.</p></td>
</tr>
<tr class="row-odd"><td><p>logback.xml</p></td>
<td><p>Logger Konfiguration</p></td>
</tr>
<tr class="row-even"><td><p>routes</p></td>
<td><p>Alle HTTP-Pfade Ã¼bersichtlich in
einer Datei</p></td>
</tr>
<tr class="row-odd"><td><p>skos-context.json</p></td>
<td><p>Ein JSON-LD-Kontext zur
Umwandlung von RDF nach JSON.
(Origianl von: Jakob Voss)</p></td>
</tr>
<tr class="row-even"><td><p>skos-setting.json</p></td>
<td><p>Settings zur Konfiguration des
Elasticsearchindexse. (Original
von: JÃ¶rg Prante)</p></td>
</tr>
</tbody>
</table></div>
</section>
<section id="die-applikation-4">
<span id="id30"></span><h3>Die Applikation<a class="headerlink" href="#die-applikation-4" title="Permalink to this headline">ï</a></h3>
<div class="table-wrapper"><table class="docutils align-default" id="id111">
<caption><span class="caption-text">Das /app Verzeichnis</span><a class="headerlink" href="#id111" title="Permalink to this table">ï</a></caption>
<colgroup>
<col style="width: 50%"/>
<col style="width: 50%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Package</p></th>
<th class="head"><p>Beschreibung</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>controllers</p></td>
<td><p>Alles in einem Controller. Die
API-Methoden liefern HTML und
JSON, so dass man sie aus dem
Browser, aber auch Ã¼ber andere
Tools ansprechen kann.</p></td>
</tr>
<tr class="row-odd"><td><p>elasticsearch</p></td>
<td><p>Eine embedded Elasticsearch. Dies
hat den Vorteil, dass man eine
aktuellere Version nutzen kann,
als z.B. die
<a class="reference external" href="#_regal_api_2">regal-api</a>.</p></td>
</tr>
<tr class="row-even"><td><p>services</p></td>
<td><p>Hilfsklassen zum Laden der Daten.</p></td>
</tr>
<tr class="row-odd"><td><p>views</p></td>
<td><p>Ein Formular um neue Daten in die
Applikation zu laden. Und ein
Beispielformular zur
Demonstration der Nutzung.</p></td>
</tr>
</tbody>
</table></div>
</section>
</section>
<section id="thumby">
<span id="id31"></span><h2>Thumby<a class="headerlink" href="#thumby" title="Permalink to this headline">ï</a></h2>
<div class="table-wrapper"><table class="docutils align-default" id="id112">
<caption><span class="caption-text">Ãberblick</span><a class="headerlink" href="#id112" title="Permalink to this table">ï</a></caption>
<colgroup>
<col style="width: 50%"/>
<col style="width: 50%"/>
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Source</p></td>
<td><p><a href="#id127"><span class="problematic" id="id129">`thumby &lt;
https://github.com/hbz/thumby&gt;`__</span></a></p></td>
</tr>
<tr class="row-even"><td><p>Technik</p></td>
<td><p><a class="reference external" href="https://www.playframework.com/documentation/2.2.x/JavaHome">Play Play
2.2
.2</a></p></td>
</tr>
<tr class="row-odd"><td><p>Ports</p></td>
<td><p>9001 / 9101</p></td>
</tr>
<tr class="row-even"><td><p>Verzeichnis</p></td>
<td><p>/opt/regal/apps/thumby,
/opr/regal/src/thumby</p></td>
</tr>
<tr class="row-odd"><td><p>HTTP Pfad</p></td>
<td><p>/tools/thumby</p></td>
</tr>
</tbody>
</table></div>
<p><a class="reference external" href="#_thumby">Thumby</a> realisiert einen Thumbnail-Generator. Ãber ein
HTTP-GET wird <a class="reference external" href="#_thumby">Thumby</a> die URL eines PDFs, oder eines
Bildes Ã¼bergeben. Sofern die <a class="reference external" href="#_thumby">Thumby</a> den Server kennt,
wird es versuchen ein Thumbnail der zurÃ¼ckgelieferten Daten zu
erstellen. Die Daten werden dauerhaft auf der Platte abgelegt und
zukÃ¼nftige Requests, die auf dasselbe Bild verweisen werden direkt aus
dem Speicher von <a class="reference external" href="#_thumby">Thumby</a> beantwortet.</p>
<section id="konfiguration-5">
<span id="id32"></span><h3>Konfiguration<a class="headerlink" href="#konfiguration-5" title="Permalink to this headline">ï</a></h3>
<div class="table-wrapper"><table class="docutils align-default" id="id113">
<caption><span class="caption-text">Dateien im /conf Verzeichnis</span><a class="headerlink" href="#id113" title="Permalink to this table">ï</a></caption>
<colgroup>
<col style="width: 50%"/>
<col style="width: 50%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Datei</p></th>
<th class="head"><p>Beschreibung</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>application.conf</strong></p></td>
<td><p>Hier wird eine Whitelist gesetzt.
Thumby verarbeitet nur URLs von
den hier angegebenen Quellen.
Hier wird auch der Pfad auf der
Platte gesetzt, unter dem Thumby
thumbnail-Daten ablegt.</p></td>
</tr>
<tr class="row-odd"><td><p>routes</p></td>
<td><p>Alle HTTP-Pfade Ã¼bersichtlich in
einer Datei</p></td>
</tr>
</tbody>
</table></div>
</section>
<section id="die-applikation-5">
<span id="id33"></span><h3>Die Applikation<a class="headerlink" href="#die-applikation-5" title="Permalink to this headline">ï</a></h3>
<div class="table-wrapper"><table class="docutils align-default" id="id114">
<caption><span class="caption-text">Das /app Verzeichnis</span><a class="headerlink" href="#id114" title="Permalink to this table">ï</a></caption>
<colgroup>
<col style="width: 50%"/>
<col style="width: 50%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Package</p></th>
<th class="head"><p>Beschreibung</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>controllers</p></td>
<td><p>Der Controller realisiert eine
GET-Methode, Ã¼ber die Thumbnails
erzeugt und zurÃ¼ckgegeben werden.</p></td>
</tr>
<tr class="row-odd"><td><p>helper</p></td>
<td><p>Klassen zur Organisation des
Speichers und zur
Thumbnailgenerierung.</p></td>
</tr>
<tr class="row-even"><td><p>views</p></td>
<td><p>Es gibt eine OberflÃ¤che mit einem
Upload-Formular.</p></td>
</tr>
</tbody>
</table></div>
</section>
</section>
<section id="deepzoomer">
<span id="id34"></span><h2>Deepzoomer<a class="headerlink" href="#deepzoomer" title="Permalink to this headline">ï</a></h2>
<div class="table-wrapper"><table class="docutils align-default" id="id115">
<caption><span class="caption-text">Ãberblick</span><a class="headerlink" href="#id115" title="Permalink to this table">ï</a></caption>
<colgroup>
<col style="width: 50%"/>
<col style="width: 50%"/>
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Source</p></td>
<td><p><a class="reference external" href="https://github.com/hbz/DeepZoomService">DeepZoomService</a></p></td>
</tr>
<tr class="row-even"><td><p>Technik</p></td>
<td><p><a href="#id127"><span class="problematic" id="id130">`Servlet
2.3 &lt;
https://download.oracle.com/otn-p
ub/jcp/7840-servlet-2.3-spec-oth-
JSpec/servlet-2_3-fcs-spec.ps&gt;`__</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>Ports</p></td>
<td><p>9091 / 9191</p></td>
</tr>
<tr class="row-even"><td><p>Verzeichnis</p></td>
<td><p>/opt/regal/tomcat-for-deepzoom/,
/opr/regal/src/DeepZoomService</p></td>
</tr>
</tbody>
</table></div>
<p>Der [DeepZoomService] kann als WAR in einem Application-Server deployed
werden. Mit dem Deepzoomer kÃ¶nnen pyramidale Bilder erzeugt, gespeichert
und Ã¼ber eine OpenSeadragon-konforme Schnittstelle abgerufen werden. Auf
diese Weise kann in Regal eine Viewer-Komponente realisiert werden, die
die Anzeige sehr groÃer, hochaufgelÃ¶ster Bilder im Webbrowser
unterstÃ¼tzt.</p>
<section id="konfiguration-6">
<span id="id35"></span><h3>Konfiguration<a class="headerlink" href="#konfiguration-6" title="Permalink to this headline">ï</a></h3>
<div class="table-wrapper"><table class="docutils align-default" id="id116">
<caption><span class="caption-text">Dateien im /conf Verzeichnis</span><a class="headerlink" href="#id116" title="Permalink to this table">ï</a></caption>
<colgroup>
<col style="width: 50%"/>
<col style="width: 50%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Datei</p></th>
<th class="head"><p>Beschreibung</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>deepzoomer.cfgf</strong></p></td>
<td><p>Hier werden lokale Verzeichnisse,
aber auch die Server-URLs, unter
denen der Service Ã¶ffentlich
abrufbar ist, gesetzt.</p></td>
</tr>
</tbody>
</table></div>
</section>
</section>
<section id="regal-drupal">
<span id="id36"></span><h2>regal-drupal<a class="headerlink" href="#regal-drupal" title="Permalink to this headline">ï</a></h2>
<div class="table-wrapper"><table class="docutils align-default" id="id117">
<caption><span class="caption-text">Ãberblick</span><a class="headerlink" href="#id117" title="Permalink to this table">ï</a></caption>
<colgroup>
<col style="width: 50%"/>
<col style="width: 50%"/>
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Source</p></td>
<td><p><a class="reference external" href="https://github.com/edoweb/regal-drupal">regal-drupal</a></p></td>
</tr>
<tr class="row-even"><td><p>Technik</p></td>
<td><p><a class="reference external" href="https://www.php.net/manual/en/">PHP
5</a></p></td>
</tr>
<tr class="row-odd"><td><p>Ports</p></td>
<td><p>80 / 443</p></td>
</tr>
<tr class="row-even"><td><p>Verzeichnis</p></td>
<td><p>/opt/re
gal/var/drupal/sites/all/modules/</p></td>
</tr>
</tbody>
</table></div>
<p>Ein Drupal 7 Modul Ã¼ber das FunktionalitÃ¤ten der
<a class="reference external" href="#_regal_api_2">regal-api</a> angesprochen werden kÃ¶nnen. Das Modul
bietet OberflÃ¤chen zur Konfiguration, zur Suche und zur Verwaltung von
Objekthierarchien.</p>
<section id="die-applikation-6">
<span id="id37"></span><h3>Die Applikation<a class="headerlink" href="#die-applikation-6" title="Permalink to this headline">ï</a></h3>
<div class="table-wrapper"><table class="docutils align-default" id="id118">
<caption><span class="caption-text">Verzeichnisstruktur</span><a class="headerlink" href="#id118" title="Permalink to this table">ï</a></caption>
<colgroup>
<col style="width: 50%"/>
<col style="width: 50%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Verzeichnis</p></th>
<th class="head"><p>Beschreibung</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>edoweb</p></td>
<td><p>Hier ist der Code fÃ¼r die
OberflÃ¤chen.</p></td>
</tr>
<tr class="row-odd"><td><p>edoweb-field</p></td>
<td><p>Hier werden Felder fÃ¼r
unterschiedliche RDF-Properties
in der Drupal-Datenbank
konfiguriert. Der Code ist
grÃ¶Ãtenteils obsolet, da die
Feldlogik nicht mehr benutzt
wird.</p></td>
</tr>
<tr class="row-even"><td><p>edoweb_storage</p></td>
<td><p>Hier sind die Zugriffe auf
<a class="reference external" href="#_regal_api_2">regal-api</a> und
<a class="reference external" href="#_elasticsearch">???</a> zu
finden.</p></td>
</tr>
</tbody>
</table></div>
</section>
</section>
<section id="edoweb-drupal-theme">
<span id="id38"></span><h2>edoweb-drupal-theme<a class="headerlink" href="#edoweb-drupal-theme" title="Permalink to this headline">ï</a></h2>
<div class="table-wrapper"><table class="docutils align-default" id="id119">
<caption><span class="caption-text">Ãberblick</span><a class="headerlink" href="#id119" title="Permalink to this table">ï</a></caption>
<colgroup>
<col style="width: 50%"/>
<col style="width: 50%"/>
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Source</p></td>
<td><p><a class="reference external" href="https://github.com/edoweb/edoweb-drupal-theme">edow
eb-drupal-theme</a></p></td>
</tr>
<tr class="row-even"><td><p>Technik</p></td>
<td><p><a class="reference external" href="https://www.php.net/manual/en/">PHP
5</a></p></td>
</tr>
<tr class="row-odd"><td><p>Ports</p></td>
<td><p>80 / 443</p></td>
</tr>
<tr class="row-even"><td><p>Verzeichnis</p></td>
<td><p>/opt/r
egal/var/drupal/sites/all/themes/</p></td>
</tr>
</tbody>
</table></div>
<p>Eine Reihe von Stylsheets, CSS, Icons zur Gestaltung einer OberflÃ¤che
fÃ¼r den Server <a class="reference external" href="https://edoweb-rlp.de">https://edoweb-rlp.de</a></p>
</section>
<section id="zbmed-drupal-theme">
<span id="id39"></span><h2>zbmed-drupal-theme<a class="headerlink" href="#zbmed-drupal-theme" title="Permalink to this headline">ï</a></h2>
<div class="table-wrapper"><table class="docutils align-default" id="id120">
<caption><span class="caption-text">Ãberblick</span><a class="headerlink" href="#id120" title="Permalink to this table">ï</a></caption>
<colgroup>
<col style="width: 50%"/>
<col style="width: 50%"/>
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Source</p></td>
<td><p><a class="reference external" href="https://github.com/edoweb/zbmed-drupal-theme">zb
med-drupal-theme</a></p></td>
</tr>
<tr class="row-even"><td><p>Technik</p></td>
<td><p><a class="reference external" href="https://www.php.net/manual/en/">PHP
5</a></p></td>
</tr>
<tr class="row-odd"><td><p>Ports</p></td>
<td><p>80 / 443</p></td>
</tr>
<tr class="row-even"><td><p>Verzeichnis</p></td>
<td><p>/opt/r
egal/var/drupal/sites/all/themes/</p></td>
</tr>
</tbody>
</table></div>
<p>Eine Reihe von Stylsheets, CSS, Icons zur Gestaltung einer OberflÃ¤che
fÃ¼r den Server <a class="reference external" href="https://repository.publisso.de">https://repository.publisso.de</a></p>
</section>
<section id="openwayback">
<span id="id40"></span><h2>openwayback<a class="headerlink" href="#openwayback" title="Permalink to this headline">ï</a></h2>
<p>Repo: <a class="reference external" href="https://github.com/iipc/openwayback">https://github.com/iipc/openwayback</a> Servlet 2.5 .Ãberblick</p>
<div class="table-wrapper"><table class="docutils align-default">
<colgroup>
<col style="width: 50%"/>
<col style="width: 50%"/>
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Source</p></td>
<td><p><a class="reference external" href="https://github.com/iipc/openwayback">openwayback</a></p></td>
</tr>
<tr class="row-even"><td><p>Technik</p></td>
<td><p><a class="reference external" href="https://download.oracle.com/otn-pub/jcp/servlet-2.5-mr5-oth-JSpec/servlet-2.5-mr5-spec.pdf">Servlet
2.5</a></p></td>
</tr>
<tr class="row-odd"><td><p>Ports</p></td>
<td><p>8091 / 8191</p></td>
</tr>
<tr class="row-even"><td><p>Verzeichnis</p></td>
<td><p>/o
pt/regal/tomcat-for-openwayback/,
/opr/regal/src/openwayback</p></td>
</tr>
</tbody>
</table></div>
<p><strong>Achtung</strong>: Es gibt einen am hbz entwickelten Branch. Dieser ist nicht
auf Github.</p>
<p>Openwayback ist eine Webapplikation die im ROOT Bereich eines Tomcats
installiert werden will. Sie kann Verzeichnisse mit WARC-Dateien
indexieren und darauf eine OberflÃ¤che zur Recherche und zur Navigation
aufbauen.</p>
</section>
<section id="heritrix">
<span id="id41"></span><h2>heritrix<a class="headerlink" href="#heritrix" title="Permalink to this headline">ï</a></h2>
<p>Heritrix ist ein Werkzeug zur Sammlung von Webseiten. Heritrix startet
standalone als Webapplikation und bietet eine WeboberflÃ¤che zur
Verwaltung von SammelvorgÃ¤ngen an. Eingesammelte Webseiten werden als
WARC-Dateien in einem bestimmten Bereich der Platte abgelegt.</p>
</section>
<section id="wpull">
<span id="id42"></span><h2>wpull<a class="headerlink" href="#wpull" title="Permalink to this headline">ï</a></h2>
<p>Wpull ist ein Kommandozeilen-Wermzeug zur Sammlung von Webseiten. Mit
WPull kÃ¶nnen WARC-Dateien erzeugt werden.</p>
</section>
<section id="fedora-commons-3">
<span id="id43"></span><h2>Fedora Commons 3<a class="headerlink" href="#fedora-commons-3" title="Permalink to this headline">ï</a></h2>
<p>Fedora Commons 3 ist ein Repository-Framework. FÃ¼r Regal wird vorallem
die Speicherschicht von Fedora Commons 3 benutzt. Fedora-Commons legt
alle Daten im Dateisystem (auch) ab. Mit den Daten aus dem Dateisystem
lÃ¤sst sich eine komplette Fedora-Commons 3 Instanz von grundauf neu
aufbauen.</p>
</section>
<section id="mysql">
<span id="id44"></span><h2>MySql<a class="headerlink" href="#mysql" title="Permalink to this headline">ï</a></h2>
<p>MySQL wir von Fedora, regal-api und etikett verwendet.</p>
</section>
<section id="elasticsearch-1-1">
<span id="id45"></span><h2>Elasticsearch 1.1<a class="headerlink" href="#elasticsearch-1-1" title="Permalink to this headline">ï</a></h2>
<p>Elasticsearch ist eine Suchmaschine und wird von
<a class="reference external" href="#_regal_api_2">regal-api</a> verwendet. Auch
<a class="reference external" href="#_regal_drupal">regal-drupal</a> greift auf den Index zu.</p>
</section>
<section id="drupal-7">
<span id="id46"></span><h2>Drupal 7<a class="headerlink" href="#drupal-7" title="Permalink to this headline">ï</a></h2>
<p>Ãber Drupal 7</p>
</section>
<section id="vagrant">
<span id="id47"></span><h2>Vagrant<a class="headerlink" href="#vagrant" title="Permalink to this headline">ï</a></h2>
<p>Zur Veranschaulichung dieser Dokumentation wird ein Vagrant-Skript
angeboten, mit dem eine Regal-Installation innerhalb eines
VirtualBox-Images erzeugt werden kann.</p>
<p>Zur Installation kannst Du folgende Schritte ausfÃ¼hren. Die Kommandos
beziehen sich auf die Installation auf einem Ubuntu-System. FÃ¼r andere
Betriebssyteme ist die Installation Ã¤hnlich.</p>
<p>Die VirtualBox hat folgendes Setup</p>
<ul class="simple">
<li><p>hdd 40GB</p></li>
<li><p>cpu 2core</p></li>
<li><p>ram 4096M</p></li>
</ul>
<section id="virtualbox-installieren">
<span id="id48"></span><h3>VirtualBox installieren<a class="headerlink" href="#virtualbox-installieren" title="Permalink to this headline">ï</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">virtualbox</span>
</pre></div>
</div>
</section>
<section id="vagrant-installieren">
<span id="id49"></span><h3>Vagrant installieren<a class="headerlink" href="#vagrant-installieren" title="Permalink to this headline">ï</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">/</span><span class="n">tmp</span>
<span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">releases</span><span class="o">.</span><span class="n">hashicorp</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">vagrant</span><span class="o">/</span><span class="mf">2.2.3</span><span class="o">/</span><span class="n">vagrant_2</span><span class="mf">.2.3</span><span class="n">_x86_64</span><span class="o">.</span><span class="n">deb</span>
<span class="n">sudo</span> <span class="n">dpkg</span> <span class="o">-</span><span class="n">i</span> <span class="n">vagrant_2</span><span class="mf">.2.3</span><span class="n">_x86_64</span><span class="o">.</span><span class="n">deb</span>
</pre></div>
</div>
</section>
<section id="repository-herunterladen">
<span id="id50"></span><h3>Repository herunterladen<a class="headerlink" href="#repository-herunterladen" title="Permalink to this headline">ï</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">jschnasse</span><span class="o">/</span><span class="n">Regal</span>
<span class="n">cd</span> <span class="n">Regal</span><span class="o">/</span><span class="n">vagrant</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">-</span><span class="mf">14.04</span>
</pre></div>
</div>
</section>
<section id="eine-jdk8-bereitstellen">
<span id="id51"></span><h3>Eine JDK8 bereitstellen<a class="headerlink" href="#eine-jdk8-bereitstellen" title="Permalink to this headline">ï</a></h3>
<p>HierfÃ¼r bitte ein JDK8-Tarball herunterladen und unter dem Namen
<code class="docutils literal notranslate"><span class="pre">java8.tar.gz</span></code> in einem Verzeichnis <code class="docutils literal notranslate"><span class="pre">/bin</span></code> unterhalb des
Vagrant-Directories bereitstellen.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="nb">bin</span>
<span class="n">mv</span> <span class="o">~/</span><span class="n">downloads</span><span class="o">/</span><span class="n">jdk</span><span class="o">....</span> <span class="nb">bin</span><span class="o">/</span><span class="n">java8</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
</pre></div>
</div>
</section>
<section id="geteiltes-entwicklungsverzeichnis">
<span id="id52"></span><h3>Geteiltes Entwicklungsverzeichnis<a class="headerlink" href="#geteiltes-entwicklungsverzeichnis" title="Permalink to this headline">ï</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="o">~/</span><span class="n">regal</span><span class="o">-</span><span class="n">dev</span>
</pre></div>
</div>
</section>
<section id="vagrant-guest-additions-installieren">
<span id="id53"></span><h3>Vagrant Guest Additions installieren<a class="headerlink" href="#vagrant-guest-additions-installieren" title="Permalink to this headline">ï</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vagrant</span> <span class="n">plugin</span> <span class="n">install</span> <span class="n">vagrant</span><span class="o">-</span><span class="n">vbguest</span> <span class="o">&amp;&amp;</span> <span class="n">vagrant</span> <span class="n">reload</span>
</pre></div>
</div>
</section>
<section id="vagrant-host-anlegen">
<span id="id54"></span><h3>Vagrant Host anlegen<a class="headerlink" href="#vagrant-host-anlegen" title="Permalink to this headline">ï</a></h3>
<p>Damit alle Dienste komfortabel erreichbar sind, muss in die lokale HOSTs
Datei ein Eintrag fÃ¼r die Vagrant-Box erfolgen. Im Vagrantfile ist die
IP <code class="docutils literal notranslate"><span class="pre">192.168.50.4</span></code> fÃ¼r die Box konfiguriert. Ãber die <code class="docutils literal notranslate"><span class="pre">FRONTEND</span></code> und
<code class="docutils literal notranslate"><span class="pre">BACKEND</span></code> EintrÃ¤ge in der <code class="docutils literal notranslate"><span class="pre">variables.conf</span></code> ist der Servername als
<code class="docutils literal notranslate"><span class="pre">regal.vagrant</span></code> definiert.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">printf</span> <span class="s2">"192.168.50.4 regal.vagrant api.regal.vagrant"</span> <span class="o">&gt;&gt;</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">hosts</span>
</pre></div>
</div>
</section>
<section id="vagrant-starten">
<span id="id55"></span><h3>Vagrant starten<a class="headerlink" href="#vagrant-starten" title="Permalink to this headline">ï</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vagrant</span> <span class="n">up</span>
</pre></div>
</div>
</section>
<section id="auf-der-maschine-einloggen">
<span id="id56"></span><h3>Auf der Maschine einloggen<a class="headerlink" href="#auf-der-maschine-einloggen" title="Permalink to this headline">ï</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vagrant</span> <span class="n">ssh</span>
</pre></div>
</div>
</section>
</section>
<section id="server">
<span id="id57"></span><h2>Server<a class="headerlink" href="#server" title="Permalink to this headline">ï</a></h2>
<p>Die Installation auf einem Server kann mit Hilfe des mitgelieferten
Skriptes
<a class="reference external" href="https://github.com/jschnasse/Regal/blob/master/vagrant/ubuntu-14.04/regal-install.sh">regal-install.sh</a>
erfolgen. Dazu muss analog zur Vagrant-Installation zunÃ¤chst das <code class="docutils literal notranslate"><span class="pre">bin</span></code>
Verzeichnis mit einem JDK aufgebaut werden. Danach erfolgt die
Installation unter <code class="docutils literal notranslate"><span class="pre">/opt/regal</span></code> und mit einem Benutzer <code class="docutils literal notranslate"><span class="pre">regal</span></code> (vgl.
<code class="docutils literal notranslate"><span class="pre">variables.conf</span></code>)</p>
<section id="hardware-empfehlung">
<span id="id58"></span><h3>Hardware Empfehlung<a class="headerlink" href="#hardware-empfehlung" title="Permalink to this headline">ï</a></h3>
<ul class="simple">
<li><p>hdd &gt;500GB</p></li>
<li><p>cpu 8 core</p></li>
<li><p>ram 32 G</p></li>
</ul>
</section>
<section id="unterschiede-zur-vagrant-installation">
<span id="id59"></span><h3>Unterschiede zur Vagrant Installation<a class="headerlink" href="#unterschiede-zur-vagrant-installation" title="Permalink to this headline">ï</a></h3>
<p>Auf dem Server empfehlen ich den fedora tomcat mit erweiterten
Speichereinstellungen zu betreiben.</p>
<p>Dazu in <code class="docutils literal notranslate"><span class="pre">/opt/regal/bin/fedora/tomcat/bin</span></code> eine <code class="docutils literal notranslate"><span class="pre">setenv.sh</span></code> anlegen
und folgende Zeilen hinein kopieren.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CATALINA_OPTS</span><span class="o">=</span><span class="s2">" </span><span class="se">\</span>
<span class="s2">-Xms1536m </span><span class="se">\</span>
<span class="s2">-Xmx1536m </span><span class="se">\</span>
<span class="s2">-XX:NewSize=256m </span><span class="se">\</span>
<span class="s2">-XX:MaxNewSize=256m </span><span class="se">\</span>
<span class="s2">-XX:PermSize=256m </span><span class="se">\</span>
<span class="s2">-XX:MaxPermSize=256m </span><span class="se">\</span>
<span class="s2">-server </span><span class="se">\</span>
<span class="s2">-Djava.awt.headless=true </span><span class="se">\</span>
<span class="s2">-Dorg.apache.jasper.runtime.BodyContentImpl.LIMIT_BUFFER=true"</span>

<span class="n">export</span> <span class="n">CATALINA_OPTS</span>
</pre></div>
</div>
<section id="entwicklung-java">
<span id="id60"></span><h4>Entwicklung Java<a class="headerlink" href="#entwicklung-java" title="Permalink to this headline">ï</a></h4>
</section>
</section>
</section>
<section id="in-der-virtualbox">
<span id="id61"></span><h2>In der VirtualBox<a class="headerlink" href="#in-der-virtualbox" title="Permalink to this headline">ï</a></h2>
<p>Hat man Ã¼ber <a class="reference external" href="#_vagrant">Vagrant</a> eine neue VirtualBox erzeugt und
alle Konfigurationen wie beschrieben vorgenommen, kann man die
VirtualBox zur Entwicklung nutzen. Da im Installationsprozess bereits
Eclipse-Projekte der unter <code class="docutils literal notranslate"><span class="pre">/opt/regal/src</span></code> befindlichen
Java-Applikationen erzeugt wurden, kÃ¶nnen die Projekte direkt aus dem
âsynced folderâ unter <code class="docutils literal notranslate"><span class="pre">~/regal-dev</span></code> in eine Eclipse-IDE auf dem
Host-System importiert werden.</p>
<p>Damit Ãnderungen am Code in der VirtualBox direkt sichtbar werden,
sollte die Applikation zunÃ¤chst im Develop-Mode neu gestartet werden.
Dazu loggt man sich auf der VirtualBox mit <code class="docutils literal notranslate"><span class="pre">vagrant</span> <span class="pre">ssh</span></code> ein und
stoppt zunÃ¤chst den entsprechenden Service, z.B.
<code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">service</span> <span class="pre">regal-api</span> <span class="pre">stop</span></code>. AnschlieÃend navigiert man in das
Source-Verzeichnis, z.B. <code class="docutils literal notranslate"><span class="pre">cd</span> <span class="pre">/opt/regal/src/regal-api</span></code>. Hier startet
man die Applikation auf dem korrekten Port (im Zweifel unter
<code class="docutils literal notranslate"><span class="pre">/opt/regal/apps/regal-api/conf/application.conf</span></code> nachschauen). Der
Start im Develop-Mode erfolgt aus dem Verzeichnis der Applikation, mit
z.B. <code class="docutils literal notranslate"><span class="pre">/opt/regal/bin/activator/bin/activator</span> <span class="pre">-Dhttp.port=9100</span></code>. Danach
kann in die Kosole <code class="docutils literal notranslate"><span class="pre">run</span></code> eingegegeben werden. Die Applikation sollte
nun unter dem entsprechenden Port (im Beispiel: 9100) antworten.</p>
<p>Leider funktioniert das Reloading zwischen Host-System und
Guest-VirtualBox nicht richtig. D.h. nach Code-Ãnderungen im Host, muss
auf der Virtualbox zunÃ¤chst mit <code class="docutils literal notranslate"><span class="pre">Ctrl+D</span></code> und <code class="docutils literal notranslate"><span class="pre">run</span></code> neu gestartet
werden, damit die Ãnderungen sichtbar werden.</p>
</section>
<section id="auf-dem-eigenen-system">
<span id="id62"></span><h2>Auf dem eigenen System<a class="headerlink" href="#auf-dem-eigenen-system" title="Permalink to this headline">ï</a></h2>
<p>Die Javakomponenten kÃ¶nnen problemlos auch auf einem aktuellen
Ubuntusystem entwickelt werden. Leider lÃ¤uft die
PHP/Drupal-Implementierung nicht unter neueren Ubuntusystemen. FÃ¼r die
lokale installation kÃ¶nnen die entsprechenden Funktionen aus dem
<code class="docutils literal notranslate"><span class="pre">regal-install.sh</span></code> ausgefÃ¼hrt werden. Dazu einfach eine Kopie anlegen,
entsprechend editieren und ausfÃ¼hren.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="n">regal</span><span class="o">-</span><span class="n">install</span>
<span class="n">cp</span> <span class="o">-</span><span class="n">r</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">Regal</span><span class="o">/</span><span class="n">vagrant</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">-</span><span class="n">XX</span><span class="o">/*</span> <span class="n">regal</span><span class="o">-</span><span class="n">install</span>
<span class="n">cd</span> <span class="n">regal</span><span class="o">-</span><span class="n">install</span>
<span class="c1"># Edit system user "vagrant" --&gt; "your user"</span>
<span class="n">editor</span> <span class="n">variables</span><span class="o">.</span><span class="n">conf</span>
<span class="c1"># put drupal stuff in comments</span>
<span class="c1">#</span>
<span class="c1">#  #installDrush</span>
<span class="c1">#  #installDrupal</span>
<span class="c1">#  #installRegalDrupal</span>
<span class="c1">#  #installDrupalThemes</span>
<span class="c1">#  #configureDrupalLanguages</span>
<span class="c1">#  #configureDrupal</span>
<span class="c1">#</span>
<span class="n">editor</span> <span class="n">regal</span><span class="o">-</span><span class="n">install</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
</section>
<section id="aktualisierung">
<span id="id63"></span><h2>Aktualisierung<a class="headerlink" href="#aktualisierung" title="Permalink to this headline">ï</a></h2>
<section id="play-applikationen">
<span id="id64"></span><h3>Play-Applikationen<a class="headerlink" href="#play-applikationen" title="Permalink to this headline">ï</a></h3>
<p>Die Aktualisierung der Regal-Komponenten erfolgt Ã¼ber Skripte. Die
Aktualisierung funktioniert dabei so, dass der Quellcode der zu
aktualisierenden Komponente unter <code class="docutils literal notranslate"><span class="pre">/opt/regal/src</span></code> per <code class="docutils literal notranslate"><span class="pre">git</span></code> auf den
entsprechenden Branch gestellt wird. Danach wird ein neues Kompilat der
Komponente erzeugt. Die aktuelle Konfiguration wird aus
<code class="docutils literal notranslate"><span class="pre">/opt/regal/conf</span></code> genommen und es wird unter <code class="docutils literal notranslate"><span class="pre">/opt/regal/apps</span></code> eine
neue lauffÃ¤hige Version abgelegt.</p>
<p>Neue Versionen werden immer parallel zu alten Versionen gestartet und
Ã¼ber einen Wechsel der Apachekonfiguration aktiviert. Erst danach wird
die alte Version heruntergefahren.</p>
<p>Der komplette Aktualisierungsprozess erfolgt automatisch. Die alte
Version bleibt immer auf dem Server liegen, so dass bei Bedarf wieder
zurÃ¼ck gewechselt werden kann.</p>
</section>
<section id="tomcat-applikation">
<span id="id65"></span><h3>Tomcat-Applikation<a class="headerlink" href="#tomcat-applikation" title="Permalink to this headline">ï</a></h3>
<p>Es wird ein <code class="docutils literal notranslate"><span class="pre">war</span></code>-Container erzeugt und im Tomcat <code class="docutils literal notranslate"><span class="pre">hot</span></code>-deployed.</p>
</section>
<section id="drupal-module">
<span id="id66"></span><h3>Drupal-Module<a class="headerlink" href="#drupal-module" title="Permalink to this headline">ï</a></h3>
<p>Beinhaltet die Aktualisierung ein Datenbankupdate, so wird Drupal erst
in den Wartungszustand versetzt (per drush oder Ã¼ber die OberflÃ¤che).
Danach wird die aktualisierte Version einfach per Git geholt. Bei
Datenbankupdates wird noch ein Drupal-Updateskript ausgefÃ¼hrt.</p>
</section>
<section id="speicherschicht">
<span id="id67"></span><h3>Speicherschicht<a class="headerlink" href="#speicherschicht" title="Permalink to this headline">ï</a></h3>
<p>Aktualisierungen von MySQL, Elasticsearch und Fedora gehen mit einer
Downtime einher.</p>
</section>
</section>
<section id="verzeichnisse">
<span id="id68"></span><h2>Verzeichnisse<a class="headerlink" href="#verzeichnisse" title="Permalink to this headline">ï</a></h2>
<div class="table-wrapper"><table class="docutils align-default" id="id121">
<caption><span class="caption-text">Verzeichnisstruktur</span><a class="headerlink" href="#id121" title="Permalink to this table">ï</a></caption>
<colgroup>
<col style="width: 50%"/>
<col style="width: 50%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Verzeichnis</p></th>
<th class="head"><p>Beschreibung</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>/opt/regal</p></td>
<td><p>AuÃer Apache2, Elasticsearch und
MySQL befinden sich alle
Regal-Komponenten unter diesem
Verzeichnis.</p></td>
</tr>
<tr class="row-odd"><td><p>/opt/regal/apps</p></td>
<td><p>Die auf <code class="docutils literal notranslate"><span class="pre">Play</span></code> beruhenden
Komponenten:
<code class="docutils literal notranslate"><span class="pre">etikett</span>Â  <span class="pre">fedora</span>Â  <span class="pre">regal-a</span>
<span class="pre">pi</span>Â  <span class="pre">skos-lookup</span>Â  <span class="pre">thumby</span>Â  <span class="pre">zettel</span></code></p></td>
</tr>
<tr class="row-even"><td><p>/opt/regal/bin</p></td>
<td><p>Fremdpakete wie activator,
fedora, heritrix, python -
weitere tomcats.</p></td>
</tr>
<tr class="row-odd"><td><p>/opt/regal/conf</p></td>
<td><p>Die variables.conf und die
application.conf wird von
verschiedenen Komponenten
verwendet.</p></td>
</tr>
<tr class="row-even"><td><p>/opt/regal/logs</p></td>
<td><p>Logfiles der Skripte und Cronjobs</p></td>
</tr>
<tr class="row-odd"><td><p>/opt/regal/src</p></td>
<td><p>Alle Eigenentwicklungen oder im
Quellcode modifizierten
Komponenten.</p></td>
</tr>
<tr class="row-even"><td><p>/opt/regal/var</p></td>
<td><p>drupal und Datenverzeichnisse.</p></td>
</tr>
</tbody>
</table></div>
</section>
<section id="ports">
<span id="id69"></span><h2>Ports<a class="headerlink" href="#ports" title="Permalink to this headline">ï</a></h2>
<div class="table-wrapper"><table class="docutils align-default" id="id122">
<caption><span class="caption-text">Ports und Komponenten (typische Belegung)</span><a class="headerlink" href="#id122" title="Permalink to this table">ï</a></caption>
<colgroup>
<col style="width: 50%"/>
<col style="width: 50%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Port</p></th>
<th class="head"><p>Komponente</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>80 /443</p></td>
<td><p>Apache 2</p></td>
</tr>
<tr class="row-odd"><td><p>8080</p></td>
<td><p>fedora tomcat</p></td>
</tr>
<tr class="row-even"><td><p>9090</p></td>
<td><p>openwayback tomcat</p></td>
</tr>
<tr class="row-odd"><td><p>9200</p></td>
<td><p>elasticsearch</p></td>
</tr>
<tr class="row-even"><td><p>9000/9100</p></td>
<td><p>regal-api</p></td>
</tr>
<tr class="row-odd"><td><p>9001/9101</p></td>
<td><p>thumby</p></td>
</tr>
<tr class="row-even"><td><p>9002/9102</p></td>
<td><p>etikett</p></td>
</tr>
<tr class="row-odd"><td><p>9003/9103</p></td>
<td><p>zettel</p></td>
</tr>
<tr class="row-even"><td><p>9004/9104</p></td>
<td><p>skos-lookup</p></td>
</tr>
</tbody>
</table></div>
</section>
<section id="logs">
<span id="id70"></span><h2>Logs<a class="headerlink" href="#logs" title="Permalink to this headline">ï</a></h2>
<div class="table-wrapper"><table class="docutils align-default" id="id123">
<caption><span class="caption-text">Logfiles</span><a class="headerlink" href="#id123" title="Permalink to this table">ï</a></caption>
<colgroup>
<col style="width: 50%"/>
<col style="width: 50%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Komponente</p></th>
<th class="head"><p>Pfad</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Apache</p></td>
<td><p>/var/log/apache2</p></td>
</tr>
<tr class="row-odd"><td><p>Tomcat</p></td>
<td><p>/opt/regal/bin/fedora/tomcat/logs</p></td>
</tr>
<tr class="row-even"><td><p>Fedora</p></td>
<td><p>/opt/regal/bin/fedora/server/logs</p></td>
</tr>
<tr class="row-odd"><td><p>Elasticsearch</p></td>
<td><p>/var/log/elasticsearch</p></td>
</tr>
<tr class="row-even"><td><p>regal-api</p></td>
<td><p>/opt/regal/apps/regal-api/logs</p></td>
</tr>
<tr class="row-odd"><td><p>drupal</p></td>
<td><p>/var/log/apache2 #otherhosts !
und/var/log/apache2/error.log
(hier ist auch die Debugausgabe)</p></td>
</tr>
<tr class="row-even"><td><p>MySql</p></td>
<td><p>/var/log/mysql</p></td>
</tr>
<tr class="row-odd"><td><p>monit</p></td>
<td><p>/var/log/monit.log</p></td>
</tr>
<tr class="row-even"><td><p>regal-scripts</p></td>
<td><p>/opt/regal/logs</p></td>
</tr>
</tbody>
</table></div>
</section>
<section id="configs">
<span id="id71"></span><h2>Configs<a class="headerlink" href="#configs" title="Permalink to this headline">ï</a></h2>
<div class="table-wrapper"><table class="docutils align-default" id="id124">
<caption><span class="caption-text">Configfiles</span><a class="headerlink" href="#id124" title="Permalink to this table">ï</a></caption>
<colgroup>
<col style="width: 50%"/>
<col style="width: 50%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Komponente</p></th>
<th class="head"><p>Pfad</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Apache</p></td>
<td><p>/etc/apache2/sites-enabled</p></td>
</tr>
<tr class="row-odd"><td><p>Tomcat</p></td>
<td><p>/opt/regal/bin/fedora/tomcat/conf</p></td>
</tr>
<tr class="row-even"><td><p>Fedora</p></td>
<td><p>/opt/regal/bin/fedora/server/conf</p></td>
</tr>
<tr class="row-odd"><td><p>Elasticsearch</p></td>
<td><p>/etc/elasticsearch</p></td>
</tr>
<tr class="row-even"><td><p>regal-api</p></td>
<td><p>/opt/regal/conf enthÃ¤lt
KonfigurationsvorschlÃ¤ge des
Installers</p></td>
</tr>
<tr class="row-odd"><td><p>regal-api</p></td>
<td><p>/opt/regal/apps/regal-api/conf</p></td>
</tr>
<tr class="row-even"><td><p>drupal</p></td>
<td><p>Konfig kann gut mit dem Tool
drush Ã¼berwacht werden</p></td>
</tr>
<tr class="row-odd"><td><p>Elasticsearch Plugins</p></td>
<td><p>/etc/elasticsearch</p></td>
</tr>
<tr class="row-even"><td><p>oai-pmh</p></td>
<td><p>/opt/regal/
bin/fedora/tomcat/webapps/dnb-unr
/WEB-INF/classes/proai.properties</p></td>
</tr>
<tr class="row-odd"><td><p>monit</p></td>
<td><p>/etc/monit</p></td>
</tr>
</tbody>
</table></div>
</section>
<section id="apache2">
<span id="id72"></span><h2>Apache2<a class="headerlink" href="#apache2" title="Permalink to this headline">ï</a></h2>
<div class="table-wrapper"><table class="docutils align-default" id="id125">
<caption><span class="caption-text">Frontend Pfade</span><a class="headerlink" href="#id125" title="Permalink to this table">ï</a></caption>
<colgroup>
<col style="width: 33%"/>
<col style="width: 33%"/>
<col style="width: 33%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Komponente</p></th>
<th class="head"><p>HTTP-Pfad</p></th>
<th class="head"><p>Lokaler Pfad/Proxy</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Drupal</p></td>
<td><p>/</p></td>
<td><p>/opt/regal/var/drupal</p></td>
</tr>
<tr class="row-odd"><td><p>Alte Importe von
Webarchiven</p></td>
<td><p>/webharvests</p></td>
<td><p>/data/webharvests</p></td>
</tr>
<tr class="row-even"><td><p>TÃ¤glich generierte
Datei mit Kennziffern</p></td>
<td><p>/crawlreports</p></td>
<td><p>/o
pt/regal/crawlreports</p></td>
</tr>
</tbody>
</table></div>
<div class="table-wrapper"><table class="docutils align-default" id="id126">
<caption><span class="caption-text">API Pfade</span><a class="headerlink" href="#id126" title="Permalink to this table">ï</a></caption>
<colgroup>
<col style="width: 33%"/>
<col style="width: 33%"/>
<col style="width: 33%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Komponente</p></th>
<th class="head"><p>HTTP-Pfad</p></th>
<th class="head"><p>Lokaler Pfad/Proxy</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Ãber wget erstellte
Webarchive</p></td>
<td><p>/wget-data</p></td>
<td><p>/op
t/regal/var/wget-data</p></td>
</tr>
<tr class="row-odd"><td><p>Ãber wpull erstellte
Webarchive</p></td>
<td><p>/wpull-data</p></td>
<td><p>/opt
/regal/var/wpull-data</p></td>
</tr>
<tr class="row-even"><td><p>Ãber heritrix
erstellte Webarchive</p></td>
<td><p>/heritrix-data</p></td>
<td><p>/opt/re
gal/var/heritrix-data</p></td>
</tr>
<tr class="row-odd"><td><p>OAI-Schnittstelle fÃ¼r
die DNB</p></td>
<td><p>/dnb-urn</p></td>
<td><p><a class="reference external" href="http://loc">http://loc</a>
alhost:8080/dnb-urn$1</p></td>
</tr>
<tr class="row-even"><td><p>OAI-Schnittstelle</p></td>
<td><p>/oai-pmh</p></td>
<td><p><a class="reference external" href="http://loc">http://loc</a>
alhost:8080/oai-pmh$1</p></td>
</tr>
<tr class="row-odd"><td><p>Deepzoomer</p></td>
<td><p>/deepzoom</p></td>
<td><p><a class="reference external" href="http://loca">http://loca</a>
lhost:7080/deepzoom$1</p></td>
</tr>
<tr class="row-even"><td><p>Openwayback privat</p></td>
<td><p>/wayback</p></td>
<td><p><a class="reference external" href="http://l">http://l</a>
ocalhost:9080/wayback</p></td>
</tr>
<tr class="row-odd"><td><p>Openwayback
Ã¶ffentlich</p></td>
<td><p>/weltweit</p></td>
<td><p><a class="reference external" href="http://lo">http://lo</a>
calhost:9080/weltweit</p></td>
</tr>
<tr class="row-even"><td><p>Thumby</p></td>
<td><p>/tools/thumby</p></td>
<td><p><a class="reference external" href="http://localh">http://localh</a>
ost:9001/tools/thumby</p></td>
</tr>
<tr class="row-odd"><td><p>Etikett</p></td>
<td><p>/tools/etikett</p></td>
<td><p><a class="reference external" href="http://localho">http://localho</a>
st:9002/tools/etikett</p></td>
</tr>
<tr class="row-even"><td><p>Zettel</p></td>
<td><p>/tools/zettel</p></td>
<td><p><a class="reference external" href="http://localh">http://localh</a>
ost:9004/tools/zettel</p></td>
</tr>
<tr class="row-odd"><td><p>Elasticsearch GET</p></td>
<td><p>/search</p></td>
<td><p><a class="reference external" href="http://localhost:9200">http://localhost:9200</a></p></td>
</tr>
<tr class="row-even"><td><p>Fedora</p></td>
<td><p>/fedora</p></td>
<td><p><a class="reference external" href="http://">http://</a>
localhost:8080/fedora</p></td>
</tr>
<tr class="row-odd"><td><p>JSON-LD Context</p></td>
<td><p>/
public/resources.json</p></td>
<td><p><a class="reference external" href="http:/">http:/</a>
/localhost:9002/tools
/etikett/context.json</p></td>
</tr>
<tr class="row-even"><td><p>regal-api</p></td>
<td><p>/</p></td>
<td><p>h
ttp://localhost:9000/</p></td>
</tr>
<tr class="row-odd"><td><p>heritrix</p></td>
<td><p>/tools/heritrix</p></td>
<td><p><a class="reference external" href="https://localhos">https://localhos</a>
t:8443/tools/heritrix</p></td>
</tr>
</tbody>
</table></div>
</section>
<section id="matomo">
<span id="id73"></span><h2>Matomo<a class="headerlink" href="#matomo" title="Permalink to this headline">ï</a></h2>
<p>Matomo wird einmal tÃ¤glich per Cronjob mit Apache-Logfiles befÃ¼llt.
Dabei erfolgt eine Anonymisierung. Die Logfiles verbleiben noch sieben
Tage auf dem Server und werden dann annoynmisiert.</p>
</section>
<section id="monit">
<span id="id74"></span><h2>Monit<a class="headerlink" href="#monit" title="Permalink to this headline">ï</a></h2>
<p>Das Tool Monit erlaubt es, den Status der Regal-Komponenten zu
Ã¼berwachen und Dienste ggfl. neu zu starten. Folgende EintrÃ¤ge kÃ¶nnen in
/etc/monit/monitrc vorgenommen werden</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">check</span> <span class="n">process</span> <span class="n">apache</span> <span class="k">with</span> <span class="n">pidfile</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">apache2</span><span class="o">/</span><span class="n">apache2</span><span class="o">.</span><span class="n">pid</span>
    <span class="n">start</span> <span class="n">program</span> <span class="o">=</span> <span class="s2">"/etc/init.d/apache2 start"</span> <span class="k">with</span> <span class="n">timeout</span> <span class="mi">60</span> <span class="n">seconds</span>
    <span class="n">stop</span> <span class="n">program</span>  <span class="o">=</span> <span class="s2">"/etc/init.d/apache2 stop"</span>

<span class="n">check</span> <span class="n">process</span> <span class="n">regal</span><span class="o">-</span><span class="n">api</span> <span class="k">with</span> <span class="n">pidfile</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">apps</span><span class="o">/</span><span class="n">regal</span><span class="o">-</span><span class="n">api</span><span class="o">/</span><span class="n">RUNNING_PID</span>
     <span class="n">start</span> <span class="n">program</span> <span class="o">=</span> <span class="s2">"/etc/init.d/regal-api start"</span> <span class="k">with</span> <span class="n">timeout</span> <span class="mi">60</span> <span class="n">seconds</span>
     <span class="n">stop</span> <span class="n">program</span> <span class="o">=</span> <span class="s2">"/etc/init.d/regal-api stop"</span>

<span class="n">check</span> <span class="n">process</span> <span class="n">tomcat6</span> <span class="k">with</span> <span class="n">pidfile</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">tomcat6</span><span class="o">.</span><span class="n">pid</span>
     <span class="n">start</span> <span class="n">program</span> <span class="o">=</span> <span class="s2">"/etc/init.d/tomcat6 start"</span> <span class="k">with</span> <span class="n">timeout</span> <span class="mi">60</span> <span class="n">seconds</span>
     <span class="n">stop</span> <span class="n">program</span> <span class="o">=</span> <span class="s2">"/etc/init.d/regal-api stop"</span>

<span class="n">check</span> <span class="n">process</span> <span class="n">elasticsearch</span> <span class="k">with</span> <span class="n">pidfile</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">elasticsearch</span><span class="o">.</span><span class="n">pid</span>
     <span class="n">start</span> <span class="n">program</span> <span class="o">=</span> <span class="s2">"/etc/init.d/elasticsearch start"</span> <span class="k">with</span> <span class="n">timeout</span> <span class="mi">60</span> <span class="n">seconds</span>
     <span class="n">stop</span> <span class="n">program</span> <span class="o">=</span> <span class="s2">"/etc/init.d/elasticsearch stop"</span>

<span class="n">check</span> <span class="n">process</span> <span class="n">thumby</span> <span class="k">with</span> <span class="n">pidfile</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">apps</span><span class="o">/</span><span class="n">thumby</span><span class="o">/</span><span class="n">RUNNING_PID</span>
     <span class="n">start</span> <span class="n">program</span> <span class="o">=</span> <span class="s2">"/etc/init.d/thumby start"</span> <span class="k">with</span> <span class="n">timeout</span> <span class="mi">60</span> <span class="n">seconds</span>
     <span class="n">stop</span> <span class="n">program</span> <span class="o">=</span> <span class="s2">"/etc/init.d/thumby stop"</span>

<span class="n">check</span> <span class="n">process</span> <span class="n">etikett</span> <span class="k">with</span> <span class="n">pidfile</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">apps</span><span class="o">/</span><span class="n">etikett</span><span class="o">/</span><span class="n">RUNNING_PID</span>
     <span class="n">start</span> <span class="n">program</span> <span class="o">=</span> <span class="s2">"/etc/init.d/etikett start"</span> <span class="k">with</span> <span class="n">timeout</span> <span class="mi">60</span> <span class="n">seconds</span>
     <span class="n">stop</span> <span class="n">program</span> <span class="o">=</span> <span class="s2">"/etc/init.d/etikett stop"</span>

<span class="n">check</span> <span class="n">process</span> <span class="n">zettel</span> <span class="k">with</span> <span class="n">pidfile</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">apps</span><span class="o">/</span><span class="n">zettel</span><span class="o">/</span><span class="n">RUNNING_PID</span>
     <span class="n">start</span> <span class="n">program</span> <span class="o">=</span> <span class="s2">"/etc/init.d/zettel start"</span> <span class="k">with</span> <span class="n">timeout</span> <span class="mi">60</span> <span class="n">seconds</span>
     <span class="n">stop</span> <span class="n">program</span> <span class="o">=</span> <span class="s2">"/etc/init.d/zettel stop"</span>
</pre></div>
</div>
</section>
<section id="scripts-und-cronjobs">
<span id="id75"></span><h2>Scripts und Cronjobs<a class="headerlink" href="#scripts-und-cronjobs" title="Permalink to this headline">ï</a></h2>
<p>FÃ¼r das Funktionieren von Regal sind einige regal-scripts sinnvoll. Die
Skripte sind sÃ¤mtlich unter Github zu finden.</p>
<p><a class="reference external" href="https://github.com/edoweb/regal-scripts">https://github.com/edoweb/regal-scripts</a></p>
<p>Die folgenden Abschnitte zeigen ein typisches Setup.</p>
<section id="oai-providing-2">
<span id="id76"></span><h3>OAI-Providing<a class="headerlink" href="#oai-providing-2" title="Permalink to this headline">ï</a></h3>
<p>Der OAI-Provider lÃ¤uft nicht die ganze Zeit mit, da dies Probleme
gemacht hat. Er wird nur fÃ¼r einen bestimmten Zeitraum angestellt und
dann wieder ausgestellt. Auf diese Weise liefert die OAI-Schnittstelle
tagesaktuelle Daten.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span> <span class="mi">2</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">regal</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">turnOnOaiPmhPolling</span><span class="o">.</span><span class="n">sh</span>
<span class="mi">0</span> <span class="mi">5</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">regal</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">turnOffOaiPmhPolling</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
</section>
<section id="urn-registrierung">
<span id="id77"></span><h3>URN-Registrierung<a class="headerlink" href="#urn-registrierung" title="Permalink to this headline">ï</a></h3>
<p>Die URN-Registrierung erfolgt mit einem gewissen Verzug. Das dafÃ¼r
zustÃ¤ndige Skript Ã¼berprÃ¼ft daher zunÃ¤chst das Anlagedatum der
Ressource.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">05</span> <span class="mi">7</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">regal</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">register_urn</span><span class="o">.</span><span class="n">sh</span> <span class="n">control</span>  <span class="o">&gt;&gt;</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">regal</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">control_urn_vergabe</span><span class="o">.</span><span class="n">log</span>
<span class="mi">1</span> <span class="mi">1</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">regal</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">register_urn</span><span class="o">.</span><span class="n">sh</span> <span class="n">katalog</span> <span class="o">&gt;&gt;</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">regal</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">katalog_update</span><span class="o">.</span><span class="n">log</span>
<span class="mi">1</span> <span class="mi">0</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">regal</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">register_urn</span><span class="o">.</span><span class="n">sh</span> <span class="n">register</span> <span class="o">&gt;&gt;</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">regal</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">register_urn</span><span class="o">.</span><span class="n">log</span>
</pre></div>
</div>
</section>
<section id="katalog-aktualisierung">
<span id="id78"></span><h3>Katalog-Aktualisierung<a class="headerlink" href="#katalog-aktualisierung" title="Permalink to this headline">ï</a></h3>
<p>Das System gleicht einmal am Tag Metadaten mit dem hbz-Verbundkatalog ab
und fÃ¼hrt ggf. Aktualisierungen durch.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span> <span class="mi">5</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">regal</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">updateAll</span><span class="o">.</span><span class="n">sh</span> <span class="o">&gt;</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">null</span>
</pre></div>
</div>
</section>
<section id="matomo-2">
<span id="id79"></span><h3>Matomo<a class="headerlink" href="#matomo-2" title="Permalink to this headline">ï</a></h3>
<p>Matomo wird mit Apache-Logfiles befÃ¼llt. Innerhalb von Matomo werden die
EintrÃ¤ge annonymisiert.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span> <span class="mi">1</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">regal</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">import</span><span class="o">-</span><span class="n">logfiles</span><span class="o">.</span><span class="n">sh</span> <span class="o">&gt;/</span><span class="n">dev</span><span class="o">/</span><span class="n">null</span>
</pre></div>
</div>
</section>
<section id="logfile-annonymisierung">
<span id="id80"></span><h3>Logfile Annonymisierung<a class="headerlink" href="#logfile-annonymisierung" title="Permalink to this headline">ï</a></h3>
<p>Apache-Logfiles werden sieben Tage unverÃ¤ndert aufbewahrt. Danach
erfolgt eine Annonymisierung.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span> <span class="mi">2</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">regal</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">depersonalize</span><span class="o">-</span><span class="n">apache</span><span class="o">-</span><span class="n">logs</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
</section>
<section id="webgatherer">
<span id="id81"></span><h3>Webgatherer<a class="headerlink" href="#webgatherer" title="Permalink to this headline">ï</a></h3>
<p>Der Webgatherer prÃ¼ft Archivierungsintervalle von Webpages und stÃ¶Ãt bei
Bedarf die Erzeugung eines neuen Snapshots/Version an.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span> <span class="mi">20</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">regal</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">runGatherer</span><span class="o">.</span><span class="n">sh</span> <span class="o">&gt;&gt;</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">regal</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">runGatherer</span><span class="o">.</span><span class="n">log</span>
<span class="c1"># Auswertung des letzten Webgatherer-Laufs</span>
<span class="mi">0</span> <span class="mi">21</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">regal</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">evalWebgatherer</span><span class="o">.</span><span class="n">sh</span> <span class="o">&gt;&gt;</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">regal</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">runGatherer</span><span class="o">.</span><span class="n">log</span>
<span class="c1"># Crawl Reports</span>
<span class="mi">0</span> <span class="mi">22</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">regal</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">crawlReport</span><span class="o">.</span><span class="n">sh</span> <span class="o">&gt;&gt;</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">logs</span><span class="o">/</span><span class="n">crawlReport</span><span class="o">.</span><span class="n">log</span>
</pre></div>
</div>
</section>
<section id="backup">
<span id="id82"></span><h3>Backup<a class="headerlink" href="#backup" title="Permalink to this headline">ï</a></h3>
<p>MySQL und Elasticsearch</p>
<p>Der Elasticsearch-Index und die MySQL-Datenbanken werden tÃ¤glich
gesichert. Es werden Backups der letzten 30 Tage aufbewahrt. Ãltere
Backups werden von der Platte gelÃ¶scht.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span> <span class="mi">2</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">regal</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">backup</span><span class="o">-</span><span class="n">es</span><span class="o">.</span><span class="n">sh</span> <span class="o">-</span><span class="n">c</span> <span class="o">&gt;&gt;</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">logs</span><span class="o">/</span><span class="n">backup</span><span class="o">-</span><span class="n">es</span><span class="o">.</span><span class="n">log</span> <span class="mi">2</span><span class="o">&gt;&amp;</span><span class="mi">1</span>
<span class="mi">30</span> <span class="mi">2</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">regal</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">backup</span><span class="o">-</span><span class="n">es</span><span class="o">.</span><span class="n">sh</span> <span class="o">-</span><span class="n">b</span> <span class="o">&gt;&gt;</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">logs</span><span class="o">/</span><span class="n">backup</span><span class="o">-</span><span class="n">es</span><span class="o">.</span><span class="n">log</span> <span class="mi">2</span><span class="o">&gt;&amp;</span><span class="mi">1</span>
<span class="mi">0</span> <span class="mi">2</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">regal</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">backup</span><span class="o">-</span><span class="n">db</span><span class="o">.</span><span class="n">sh</span> <span class="o">-</span><span class="n">c</span> <span class="o">&gt;&gt;</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">logs</span><span class="o">/</span><span class="n">backup</span><span class="o">-</span><span class="n">db</span><span class="o">.</span><span class="n">log</span> <span class="mi">2</span><span class="o">&gt;&amp;</span><span class="mi">1</span>
<span class="mi">30</span> <span class="mi">2</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">regal</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">backup</span><span class="o">-</span><span class="n">db</span><span class="o">.</span><span class="n">sh</span> <span class="o">-</span><span class="n">b</span> <span class="o">&gt;&gt;</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">regal</span><span class="o">/</span><span class="n">logs</span><span class="o">/</span><span class="n">backup</span><span class="o">-</span><span class="n">db</span><span class="o">.</span><span class="n">log</span> <span class="mi">2</span><span class="o">&gt;&amp;</span><span class="mi">1</span>
</pre></div>
</div>
</section>
<section id="entwicklung">
<span id="id83"></span><h3>Entwicklung<a class="headerlink" href="#entwicklung" title="Permalink to this headline">ï</a></h3>
<p>FÃ¼r die Entwicklung an Regal empfiehlt sich folgende Vorgehensweiseâ¦</p>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="api.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">API-documentation</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Home</div>
                
              </div>
            </a>
        </div>

        <div class="related-information">
              Copyright &#169; 2021, Hochschulbibliothekszentrum des Landes Nordrhein-Westfalen (hbz) |
          Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
          <a href="https://github.com/pradyunsg/furo">Furo theme</a>.
            | <a class="muted-link" href="_sources/toscience.rst.txt"
               rel="nofollow">
              Show Source
            </a>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Einleitung</a></li>
<li><a class="reference internal" href="#konzepte">Konzepte</a><ul>
<li><a class="reference internal" href="#objektmodell">Objektmodell</a></li>
<li><a class="reference internal" href="#namespaces-und-identifier">Namespaces und Identifier</a></li>
<li><a class="reference internal" href="#deskriptive-metadaten">Deskriptive Metadaten</a><ul>
<li><a class="reference internal" href="#wie-kommen-bibliografische-metadaten-ins-system">Wie kommen bibliografische Metadaten ins System?</a></li>
</ul>
</li>
<li><a class="reference internal" href="#anzeige-und-darstellung">Anzeige und Darstellung</a></li>
<li><a class="reference internal" href="#der-hbz-verbundkatalog">Der hbz-Verbundkatalog</a></li>
<li><a class="reference internal" href="#metadatenkonvertierung">Metadatenkonvertierung</a></li>
<li><a class="reference internal" href="#oai-providing">OAI-Providing</a></li>
<li><a class="reference internal" href="#suche">Suche</a></li>
<li><a class="reference internal" href="#zugriffsberechtigungen-und-sichtbarkeiten">Zugriffsberechtigungen und Sichtbarkeiten</a><ul>
<li><a class="reference internal" href="#sichtbarkeiten-operationen-rollen">Sichtbarkeiten, Operationen, Rollen</a></li>
</ul>
</li>
<li><a class="reference internal" href="#benutzerverwaltung">Benutzerverwaltung</a><ul>
<li><a class="reference internal" href="#drupal">Drupal</a></li>
<li><a class="reference internal" href="#regal-api">Regal-Api</a></li>
</ul>
</li>
<li><a class="reference internal" href="#ansichten">Ansichten</a></li>
</ul>
</li>
<li><a class="reference internal" href="#software">Software</a><ul>
<li><a class="reference internal" href="#regal-api-2">regal-api</a><ul>
<li><a class="reference internal" href="#konfiguration">Konfiguration</a></li>
<li><a class="reference internal" href="#die-applikation">Die Applikation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#etikett">Etikett</a><ul>
<li><a class="reference internal" href="#konfiguration-2">Konfiguration</a></li>
<li><a class="reference internal" href="#die-applikation-2">Die Applikation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#zettel">Zettel</a><ul>
<li><a class="reference internal" href="#konfiguration-3">Konfiguration</a></li>
<li><a class="reference internal" href="#die-applikation-3">Die Applikation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#skos-lookup">skos-lookup</a><ul>
<li><a class="reference internal" href="#konfiguration-4">Konfiguration</a></li>
<li><a class="reference internal" href="#die-applikation-4">Die Applikation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#thumby">Thumby</a><ul>
<li><a class="reference internal" href="#konfiguration-5">Konfiguration</a></li>
<li><a class="reference internal" href="#die-applikation-5">Die Applikation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#deepzoomer">Deepzoomer</a><ul>
<li><a class="reference internal" href="#konfiguration-6">Konfiguration</a></li>
</ul>
</li>
<li><a class="reference internal" href="#regal-drupal">regal-drupal</a><ul>
<li><a class="reference internal" href="#die-applikation-6">Die Applikation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#edoweb-drupal-theme">edoweb-drupal-theme</a></li>
<li><a class="reference internal" href="#zbmed-drupal-theme">zbmed-drupal-theme</a></li>
<li><a class="reference internal" href="#openwayback">openwayback</a></li>
<li><a class="reference internal" href="#heritrix">heritrix</a></li>
<li><a class="reference internal" href="#wpull">wpull</a></li>
<li><a class="reference internal" href="#fedora-commons-3">Fedora Commons 3</a></li>
<li><a class="reference internal" href="#mysql">MySql</a></li>
<li><a class="reference internal" href="#elasticsearch-1-1">Elasticsearch 1.1</a></li>
<li><a class="reference internal" href="#drupal-7">Drupal 7</a></li>
<li><a class="reference internal" href="#vagrant">Vagrant</a><ul>
<li><a class="reference internal" href="#virtualbox-installieren">VirtualBox installieren</a></li>
<li><a class="reference internal" href="#vagrant-installieren">Vagrant installieren</a></li>
<li><a class="reference internal" href="#repository-herunterladen">Repository herunterladen</a></li>
<li><a class="reference internal" href="#eine-jdk8-bereitstellen">Eine JDK8 bereitstellen</a></li>
<li><a class="reference internal" href="#geteiltes-entwicklungsverzeichnis">Geteiltes Entwicklungsverzeichnis</a></li>
<li><a class="reference internal" href="#vagrant-guest-additions-installieren">Vagrant Guest Additions installieren</a></li>
<li><a class="reference internal" href="#vagrant-host-anlegen">Vagrant Host anlegen</a></li>
<li><a class="reference internal" href="#vagrant-starten">Vagrant starten</a></li>
<li><a class="reference internal" href="#auf-der-maschine-einloggen">Auf der Maschine einloggen</a></li>
</ul>
</li>
<li><a class="reference internal" href="#server">Server</a><ul>
<li><a class="reference internal" href="#hardware-empfehlung">Hardware Empfehlung</a></li>
<li><a class="reference internal" href="#unterschiede-zur-vagrant-installation">Unterschiede zur Vagrant Installation</a><ul>
<li><a class="reference internal" href="#entwicklung-java">Entwicklung Java</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#in-der-virtualbox">In der VirtualBox</a></li>
<li><a class="reference internal" href="#auf-dem-eigenen-system">Auf dem eigenen System</a></li>
<li><a class="reference internal" href="#aktualisierung">Aktualisierung</a><ul>
<li><a class="reference internal" href="#play-applikationen">Play-Applikationen</a></li>
<li><a class="reference internal" href="#tomcat-applikation">Tomcat-Applikation</a></li>
<li><a class="reference internal" href="#drupal-module">Drupal-Module</a></li>
<li><a class="reference internal" href="#speicherschicht">Speicherschicht</a></li>
</ul>
</li>
<li><a class="reference internal" href="#verzeichnisse">Verzeichnisse</a></li>
<li><a class="reference internal" href="#ports">Ports</a></li>
<li><a class="reference internal" href="#logs">Logs</a></li>
<li><a class="reference internal" href="#configs">Configs</a></li>
<li><a class="reference internal" href="#apache2">Apache2</a></li>
<li><a class="reference internal" href="#matomo">Matomo</a></li>
<li><a class="reference internal" href="#monit">Monit</a></li>
<li><a class="reference internal" href="#scripts-und-cronjobs">Scripts und Cronjobs</a><ul>
<li><a class="reference internal" href="#oai-providing-2">OAI-Providing</a></li>
<li><a class="reference internal" href="#urn-registrierung">URN-Registrierung</a></li>
<li><a class="reference internal" href="#katalog-aktualisierung">Katalog-Aktualisierung</a></li>
<li><a class="reference internal" href="#matomo-2">Matomo</a></li>
<li><a class="reference internal" href="#logfile-annonymisierung">Logfile Annonymisierung</a></li>
<li><a class="reference internal" href="#webgatherer">Webgatherer</a></li>
<li><a class="reference internal" href="#backup">Backup</a></li>
<li><a class="reference internal" href="#entwicklung">Entwicklung</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/scripts/furo.js"></script>
    </body>
</html>